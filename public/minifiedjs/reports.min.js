function config(t){t.translations("en",{DASHBOARD:"Dashboard",GRAPHS:"Graphs",MAILBOX:"Mailbox",WIDGETS:"Widgets",METRICS:"Metrics",FORMS:"Forms",APPVIEWS:"App views",OTHERPAGES:"Other pages",UIELEMENTS:"UI elements",MISCELLANEOUS:"Miscellaneous",GRIDOPTIONS:"Grid options",TABLES:"Tables",COMMERCE:"E-commerce",GALLERY:"Gallery",MENULEVELS:"Menu levels",ANIMATIONS:"Animations",LANDING:"Landing page",LAYOUTS:"Layouts",WELCOME:"Welcome Amelia",MESSAGEINFO:"You have 42 messages and 6 notifications.",SEARCH:"Search for something..."}).translations("es",{DASHBOARD:"Salpicadero",GRAPHS:"Gráficos",MAILBOX:"El correo",WIDGETS:"Widgets",METRICS:"Métrica",FORMS:"Formas",APPVIEWS:"Vistas app",OTHERPAGES:"Otras páginas",UIELEMENTS:"UI elements",MISCELLANEOUS:"Misceláneo",GRIDOPTIONS:"Cuadrícula",TABLES:"Tablas",COMMERCE:"E-comercio",GALLERY:"Galería",MENULEVELS:"Niveles de menú",ANIMATIONS:"Animaciones",LANDING:"Página de destino",LAYOUTS:"Esquemas",WELCOME:"Bienvenido Amelia",MESSAGEINFO:"Usted tiene 42 mensajes y 6 notificaciones.",SEARCH:"Busca algo ..."}),t.preferredLanguage("en")}function pageTitle(t,e){return{link:function(a,r){var s=function(t,a,s,i,o){var n="Datapoolt";a.data&&a.data.pageTitle&&(n="Datapoolt | "+a.data.pageTitle),e(function(){r.text(n)})};t.$on("$stateChangeStart",s)}}}function sideNavigation(t){return{restrict:"A",link:function(e,a){t(function(){a.metisMenu()})}}}function hcChart(t){return{restrict:"E",template:"<div></div>",scope:{options:"="},link:function(e,a){function r(){Highcharts.chart(a[0],e.options)}t(r,200)}}}function responsiveVideo(){return{restrict:"A",link:function(t,e){var a=e,r=e.children();r.attr("data-aspectRatio",r.height()/r.width()).removeAttr("height").removeAttr("width"),$(window).resize(function(){var t=a.width();r.width(t).height(t*r.attr("data-aspectRatio"))}).resize()}}}function iboxTools(t){return{restrict:"A",scope:!0,templateUrl:"common/ibox_tools.ejs",controller:["$scope","$element",function(e,a){e.showhide=function(){var e=a.closest("div.ibox"),r=a.find("i:first"),s=e.find("div.ibox-content");s.slideToggle(200),r.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down"),e.toggleClass("").toggleClass("border-bottom"),t(function(){e.resize(),e.find("[id^=map-]").resize()},50)},e.closebox=function(){var t=a.closest("div.ibox");t.remove()}}]}}function iboxToolsFullScreen(t){return{restrict:"A",scope:!0,templateUrl:"common/ibox_tools_full_screen.ejs",controller:["$scope","$element",function(e,a){e.showhide=function(){var e=a.closest("div.ibox"),r=a.find("i:first"),s=e.find("div.ibox-content");s.slideToggle(200),r.toggleClass("fa-chevron-up").toggleClass("fa-chevron-down"),e.toggleClass("").toggleClass("border-bottom"),t(function(){e.resize(),e.find("[id^=map-]").resize()},50)},e.closebox=function(){var t=a.closest("div.ibox");t.remove()},e.fullscreen=function(){var t=a.closest("div.ibox"),e=a.find("i.fa-expand");$("body").toggleClass("fullscreen-ibox-mode"),e.toggleClass("fa-expand").toggleClass("fa-compress"),t.toggleClass("fullscreen"),setTimeout(function(){$(window).trigger("resize")},100)}}]}}function minimalizaSidebar(t){return{restrict:"A",template:'<a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="" ng-click="minimalize()" style="margin-top: 10px;"><i class="fa fa-bars"></i></a>',controller:["$scope","$element",function(t,e){t.minimalize=function(){$("body").toggleClass("mini-navbar");var t=$(window).width();if(768==t&&($("body").hasClass("mini-navbar")?$("#side-menu").css("display","block"):$("#side-menu").css("display","none")),!$("body").hasClass("mini-navbar")||$("body").hasClass("body-small")){$(".tooltip").hide();document.getElementById("CustomTemplate").offsetWidth;$("#side-menu").hide(),setTimeout(function(){$("#side-menu").fadeIn(500),!$("body").hasClass("body-small")},100)}else $("body").hasClass("fixed-sidebar")?($("#side-menu").hide(),setTimeout(function(){$("#side-menu").fadeIn(500)},300)):($(".tooltip").hide(),$("#side-menu").removeAttr("style"),$("body").hasClass("mini-navbar")&&($(".tooltip").show(),$("#dashboardTitleIcons").show()))}}]}}function closeOffCanvas(){return{restrict:"A",template:'<a class="close-canvas-menu" ng-click="closeOffCanvas()"><i class="fa fa-times"></i></a>',controller:["$scope","$element",function(t,e){t.closeOffCanvas=function(){$("body").toggleClass("mini-navbar")}}]}}function vectorMap(){return{restrict:"A",scope:{myMapData:"="},link:function(t,e,a){e.vectorMap({map:"world_mill_en",backgroundColor:"transparent",regionStyle:{initial:{fill:"#e4e4e4","fill-opacity":.9,stroke:"none","stroke-width":0,"stroke-opacity":0}},series:{regions:[{values:t.myMapData,scale:["#1ab394","#22d6b1"],normalizeFunction:"polynomial"}]}})}}}function sparkline(){return{restrict:"A",scope:{sparkData:"=",sparkOptions:"="},link:function(t,e,a){t.$watch(t.sparkData,function(){r()}),t.$watch(t.sparkOptions,function(){r()});var r=function(){$(e).sparkline(t.sparkData,t.sparkOptions)}}}}function icheck(t){return{restrict:"A",require:"ngModel",link:function(e,a,r,s){return t(function(){var t;return t=r.value,e.$watch(r.ngModel,function(t){$(a).iCheck("update")}),$(a).iCheck({checkboxClass:"icheckbox_square-green",radioClass:"iradio_square-green"}).on("ifChanged",function(i){if("checkbox"===$(a).attr("type")&&r.ngModel&&e.$apply(function(){return s.$setViewValue(i.target.checked)}),"radio"===$(a).attr("type")&&r.ngModel)return e.$apply(function(){return s.$setViewValue(t)})})})}}}function ionRangeSlider(){return{restrict:"A",scope:{rangeOptions:"="},link:function(t,e,a){e.ionRangeSlider(t.rangeOptions)}}}function dropZone(){return function(t,e,a){e.dropzone({url:"/upload",maxFilesize:100,paramName:"uploadfile",maxThumbnailFilesize:5,init:function(){t.files.push({file:"added"}),this.on("success",function(t,e){}),this.on("addedfile",function(e){t.$apply(function(){alert(e),t.files.push({file:"added"})})}),this.on("drop",function(t){alert("file")})}})}}function chatSlimScroll(t){return{restrict:"A",link:function(e,a){t(function(){a.slimscroll({height:"234px",railOpacity:.4})})}}}function customValid(){return{require:"ngModel",link:function(t,e,a,r){t.$watch(a.ngModel,function(){var e="Inspinia";t.extras==e?r.$setValidity("cvalid",!0):r.$setValidity("cvalid",!1)})}}}function fullScroll(t){return{restrict:"A",link:function(e,a){t(function(){a.slimscroll({height:"100%",railOpacity:.9})})}}}function slimScroll(t){return{restrict:"A",scope:{boxHeight:"@"},link:function(e,a){t(function(){a.slimscroll({height:e.boxHeight,railOpacity:.9})})}}}function clockPicker(){return{restrict:"A",link:function(t,e){e.clockpicker()}}}function landingScrollspy(){return{restrict:"A",link:function(t,e,a){e.scrollspy({target:".navbar-fixed-top",offset:80})}}}function fitHeight(){return{restrict:"A",link:function(t,e){e.css("height",$(window).height()+"px"),e.css("min-height",$(window).height()+"px")}}}function channelDiv(){return{restrict:"E",scope:{channel:"= "},template:'<div class="col-lg-4"></div>'}}function chartHeight(){return{controller:["$scope","$element",function(t,e){this.chartHeight=e[0].offsetHeight}]}}function sizeWatcher(){return{require:"^chartHeight",scope:{sizeWatcherHeight:"=",sizeWatcherWidth:"="},link:function(t,e,a,r){var s,i=t.sizeWatcherWidth.length;s=i<=2?1:i>2&&i<=4?2:3;var o=Math.ceil(i/s);if(void 0!=r.chartHeight&&0!=r.chartHeight){if(void 0==t.sizeWatcherHeight||0==t.sizeWatcherHeight){var n=r.chartHeight;t.sizeWatcherHeight=Math.ceil(.2*n/o)}}else void 0==t.sizeWatcherHeight&&0==t.sizeWatcherHeight&&(t.sizeWatcherHeight=e.prop("offsetHeight"))}}}function expSizeWatcher(){return{scope:{expSizeWatcherHeight:"="},link:function(t,e,a,r){void 0==t.expSizeWatcherHeight&&0==t.expSizeWatcherHeight&&(t.expSizeWatcherHeight=e.prop("offsetHeight"))}}}function fileModel(t){return{restrict:"A",link:function(e,a,r){var s=t(r.fileModel),i=s.assign;a.bind("change",function(){e.$apply(function(){i(e,a[0].files[0])})})}}}function MainCtrl(t,e,a,r){t.navbarHeight=window.innerHeight,t.IntroOptions={steps:[{element:"#step8",intro:"Blank Dashboard - Click here to create a new blank dashboard. Create dashboards to organize your widgets and monitor them.",position:"right"},{element:"#step9",intro:"Dashboard Templates - Ready made pre-built dashboards comprising of specific curated widgets to address an unique theme or purpose. They provide a great way to quickly get your dashboard created rather than building it one widget at a time.",position:"right"},{element:"#step10",intro:"Reports - Take complete control of your reporting. Easily build reports with custom logos, custom text and export them as professional looking PDFs. White label your reports and use your own logo to send reports.",position:"right"},{element:"#step11",intro:"Get it, use it.",position:"bottom"},{element:"#step12",intro:"Get it, use it.",position:"left"},{element:"#step13",intro:"Get it, use it.",position:"left"},{element:"#step14",intro:"Get it, use it.",position:"left"},{element:"#soonModel",intro:"Get it, use it.",position:"left"},{element:"#step15",intro:"Get it, use it.",position:"left"},{element:"#step17",intro:"Get it, use it.",position:"left"}],showStepNumbers:!0,exitOnOverlayClick:!0,exitOnEsc:!0,nextLabel:"<strong>Next</strong>",prevLabel:"<strong>Previous</strong>",skipLabel:'<span style="color:red">Exit</span>',doneLabel:'<span style="color:green">Thanks</span>'},window.addEventListener("resize",function(e){t.navbarHeight=window.innerHeight}),e.dropDownActive=!1,t.ShouldAutoStart=!1,e.$on("$stateChangeSuccess",function(a,r,s,i,o){e.currentStateForIntro=r.name,"app.reporting.dashboard"==e.currentStateForIntro?t.IntroOptions={steps:[{element:"#step1",intro:"Name all your dashboards here the way you see fit for easy organization",position:"bottom"},{element:"#step2",intro:"Choose the date range for which you want to analyze the data of your dashboard widgets",position:"bottom"},{element:"#step3",intro:"Add new widgets to your dashboards from all our integrated channels. Choose your channels followed by the metrics. Choose the profiles for which your want to see the data for your chosen metrics.",position:"left"},{element:"#step4",intro:"Take relevant metrics from two different channels and fuse them together to spot interesting correlations and trends.",position:"left"},{element:"#step5",intro:"Arrange all the widgets in your dashboard in a presentable manner with a single click.",position:"left"},{element:"#step6",intro:"Export the current dashboard in different available formats. Also share the url of this dashboard to people who require view access for analysis.",position:"left"},{element:"#step7",intro:"Click here to delete your current dashboard.",position:"left"},{element:"#step8",intro:"Blank Dashboard - Click here to create a new blank dashboard. Create dashboards to organize your widgets and monitor them.",position:"right"},{element:"#step9",intro:"Dashboard Templates - Ready made pre-built dashboards comprising of specific curated widgets to address an unique theme or purpose. They provide a great way to quickly get your dashboard created rather than building it one widget at a time.",position:"right"},{element:"#step10",intro:"Reports - Take complete control of your reporting. Easily build reports with custom logos, custom text and export them as professional looking PDFs. White label your reports and use your own logo to send reports.",position:"right"},{element:"#step11",intro:"Quickly navigate back and forth between your recent dashboards in a single click. Get a complete view of all your dashboards by clicking on All dashboards",position:"bottom"},{element:"#step12",intro:"Navigate to handle all your account related features and settings through this menu.",position:"left"},{element:"#step13",intro:"View and manage (create/edit/delete) all the social/digital profiles whose health you want to monitor in your dashboards.",position:"left"},{element:"#step14",intro:"View your account plan and status, invoice history and manage/upgrade your account.",position:"left"},{element:"#soonModel",intro:"View and manage all the users from your team whom you would like to use and benefit from Datapoolt",position:"left"},{element:"#step15",intro:"Have a quick tour and understand the features available in Datapoolt",position:"left"},{element:"#step17",intro:"Click here to logout of Datapoolt till you visit again soon",position:"left"}],showStepNumbers:!0,exitOnOverlayClick:!1,exitOnEsc:!0,nextLabel:"<strong>Next</strong>",prevLabel:"<strong>Previous</strong>",skipLabel:'<span style="color:red">Exit</span>',doneLabel:'<span style="color:green">Thanks</span>'}:t.IntroOptions={steps:[{element:"#step8",intro:"Blank Dashboard - Click here to create a new blank dashboard. Create dashboards to organize your widgets and monitor them.",position:"right"},{element:"#step9",intro:"Dashboard Templates - Ready made pre-built dashboards comprising of specific curated widgets to address an unique theme or purpose. They provide a great way to quickly get your dashboard created rather than building it one widget at a time.",position:"right"},{element:"#step10",intro:"Reports - Take complete control of your reporting. Easily build reports with custom logos, custom text and export them as professional looking PDFs. White label your reports and use your own logo to send reports.",position:"right"},{element:"#step11",intro:"Quickly navigate back and forth between your recent dashboards in a single click. Get a complete view of all your dashboards by clicking on All dashboards",position:"bottom"},{element:"#step12",intro:"Navigate to handle all your account related features and settings through this menu.",position:"left"},{element:"#step13",intro:"View and manage (create/edit/delete) all the social/digital profiles whose health you want to monitor in your dashboards.",position:"left"},{element:"#step14",intro:"View your account plan and status, invoice history and manage/upgrade your account.",position:"left"},{element:"#soonModel",intro:"View and manage all the users from your team whom you would like to use and benefit from Datapoolt",position:"left"},{element:"#step15",intro:"Have a quick tour and understand the features available in Datapoolt",position:"left"},{element:"#step17",intro:"Click here to logout of Datapoolt till you visit again soon",position:"left"}],showStepNumbers:!0,exitOnOverlayClick:!0,exitOnEsc:!0,nextLabel:"<strong>Next</strong>",prevLabel:"<strong>Previous</strong>",skipLabel:'<span style="color:red">Exit</span>',doneLabel:'<span style="color:green">Thanks</span>'}}),t.CompletedEvent=function(t){e.dropDownActive=!1,document.getElementById("myDropdown").classList.remove("show")},t.ExitEvent=function(t){e.dropDownActive=!1,document.getElementById("myDropdown").classList.remove("show")},t.ChangeEvent=function(t,e){},t.BeforeChangeEvent=function(t,a){"step13"==t.id||"step14"==t.id||"step15"==t.id||"step16"==t.id||"step17"==t.id||"soonModel"==t.id?(e.dropDownActive=!0,document.getElementById("myDropdown").classList.contains("show")||document.getElementById("myDropdown").classList.add("show")):e.dropDownActive=!1},t.AfterChangeEvent=function(t,e){},this.daterange={startDate:null,endDate:null},this.slideInterval=5e3,this.states=["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],this.persons=[{id:"1",firstName:"Monica",lastName:"Smith"},{id:"2",firstName:"Sandra",lastName:"Jackson"},{id:"3",firstName:"John",lastName:"Underwood"},{id:"4",firstName:"Chris",lastName:"Johnatan"},{id:"5",firstName:"Kim",lastName:"Rosowski"}],this.checkOne=!0,this.checkTwo=!0,this.checkThree=!0,this.checkFour=!0,this.knobOne=75,this.knobTwo=25,this.knobThree=50,this.bigTotalItems=175,this.bigCurrentPage=1,this.maxSize=5,this.singleModel=1,this.radioModel="Middle",this.checkModel={left:!1,middle:!0,right:!1},this.groups=[{title:"Dynamic Group Header - 1",content:"Dynamic Group Body - 1"},{title:"Dynamic Group Header - 2",content:"Dynamic Group Body - 2"}],this.alerts=[{type:"danger",msg:"Oh snap! Change a few things up and try submitting again."},{type:"success",msg:"Well done! You successfully read this important alert message."},{type:"info",msg:"OK, You are done a great job man."}],this.addAlert=function(){this.alerts.push({msg:"Another alert!"})},this.closeAlert=function(t){this.alerts.splice(t,1)},this.randomStacked=function(){this.stacked=[];for(var t=["success","info","warning","danger"],e=0,a=Math.floor(4*Math.random()+1);e<a;e++){var r=Math.floor(4*Math.random());this.stacked.push({value:Math.floor(30*Math.random()+1),type:t[r]})}},this.randomStacked(),this.summernoteText=["<h3>Hello Jonathan! </h3>","<p>dummy text of the printing and typesetting industry. <strong>Lorem Ipsum has been the dustrys</strong> standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more","recently with</p>"].join(""),this.BarChart={data:[5,3,9,6,5,9,7,3,5,2,4,7,3,2,7,9,6,4,5,7,3,2,1,0,9,5,6,8,3,2,1],options:{fill:["#1ab394","#d7d7d7"],width:100}},this.BarChart2={data:[5,3,9,6,5,9,7,3,5,2],options:{fill:["#1ab394","#d7d7d7"]}},this.BarChart3={data:[5,3,2,-1,-3,-2,2,3,5,2],options:{fill:["#1ab394","#d7d7d7"]}},this.LineChart={data:[5,9,7,3,5,2,5,3,9,6,5,9,4,7,3,2,9,8,7,4,5,1,2,9,5,4,7],options:{fill:"#1ab394",stroke:"#169c81",width:64}},this.LineChart2={data:[3,2,9,8,47,4,5,1,2,9,5,4,7],options:{fill:"#1ab394",stroke:"#169c81",width:64}},this.LineChart3={data:[5,3,2,-1,-3,-2,2,3,5,2],options:{fill:"#1ab394",stroke:"#169c81",width:64}},this.LineChart4={data:[5,3,9,6,5,9,7,3,5,2],options:{fill:"#1ab394",stroke:"#169c81",width:64}},this.PieChart={data:[1,5],options:{fill:["#1ab394","#d7d7d7"]}},this.PieChart2={data:[226,360],options:{fill:["#1ab394","#d7d7d7"]}},this.PieChart3={data:[.52,1.561],options:{fill:["#1ab394","#d7d7d7"]}},this.PieChart4={data:[1,4],options:{fill:["#1ab394","#d7d7d7"]}},this.PieChart5={data:[226,134],options:{fill:["#1ab394","#d7d7d7"]}},this.PieChart6={data:[.52,1.041],options:{fill:["#1ab394","#d7d7d7"]}}}function CustomWidgetController(t,e){t.remove=function(e){t.dashboard.widgets.splice(t.dashboard.widgets.indexOf(e),1)},t.openSettings=function(a){e.open({scope:t,backdrop:!0,templateUrl:"fusion_settings.ejs",controller:"FusionSettingsController",resolve:{widget:function(){return a}}})}}function customReportController(t,e,a,r,s,i,o,n,c){t.customReportId,t.reportId,t.reportType=null,t.loading=!1,t.reportLoading=!1,t.exportReportLoading=!0,t.$window=s,t.autoArrangeGrid=!1,t.currentDate=moment(new Date).format("YYYY-DD-MM"),t.widgetDataLength=0,t.displayDate=moment(new Date).format("MMM Do YY"),t.displayHeader,t.reportNotSupported=!1,t.exportReportPages=[],t.stepActive="step1",t.customReport={widgets:[],widgetData:[]},t.orgLogosList=[],t.cliLogosList=[];var l=c.defer();t.orgLogoSrc="/userFiles/datapoolt.png",t.cliLogoSrc="/userFiles/plain-white.jpg",t.docHeight=window.innerHeight,t.docHeight=t.docHeight-60,t.reportNotSupported=!1,window.innerWidth>=1100?t.docWidth=window.innerWidth-1080:window.innerWidth>=992?t.docWidth=window.innerWidth-990:window.innerWidth>=767?t.docWidth=window.innerWidth-720:t.reportNotSupported=!0,t.sideSpace=Math.floor(t.docWidth/2),t.selectedIconIndicator=function(t,e){if("cli"==t){var a=$(".cliIcon");a.removeClass("selectIcon"),$("#"+e).addClass("selectIcon")}else if("org"==t){var a=$(".orgIcon");a.removeClass("selectIcon"),$("#"+e).addClass("selectIcon")}},t.fetchLogosFromDB=function(e){var a={accType:e};r({method:"post",url:"/api/v1/fetchLogoToPdf/dashboard",data:a}).then(function(a){"org"==e?t.orgLogosList=JSON.parse(JSON.stringify(a.data.logosInDB)):"cli"==e&&(t.cliLogosList=JSON.parse(JSON.stringify(a.data.logosInDB)))},function(e){t.orgLogosList=[],t.cliLogosList=[],swal({title:"",text:'<span style="sweetAlertFont">Something went wrong! Please reload the dashboard</span>',html:!0})})},t.submitUpload=function(e,a){var s={file:e,accType:a},i="/api/v1/createLogoToPdf/createFolder",o=new FormData,n=e.type.split("/");if("png"==n[1]||"bmp"==n[1]||"jpg"==n[1]||"jpeg"==n[1]){for(var c in s)o.append(c,s[c]);r.post(i,o,{transformRequest:angular.indentity,headers:{"Content-Type":void 0}}).then(function(e){document.getElementById("orgUploadButton").disabled=!0,document.getElementById("clientUploadButton").disabled=!0,t.fetchLogosFromDB(a)},function(t){swal({title:"",text:'<span style="sweetAlertFont">Something went wrong! Please try again later</span>',html:!0})})}else swal({title:"",text:'<span style="sweetAlertFont">Please Upload Only Image files(.jpg,.png,.jpeg,.bmp)</span>',html:!0})},t.removeLogo=function(e,a){var s={fileUrl:e.fileUrl,accType:a};r({method:"POST",url:"/api/v1/removeLogoToPdf/dashboard",data:s}).then(function(r){e.fileUrl==t.orgLogoSrc?t.orgLogoSrc="/userFiles/datapoolt.png":e.fileUrl==t.cliLogoSrc&&(t.cliLogoSrc="/userFiles/plain-white.jpg"),t.fetchLogosFromDB(a)},function(t){swal({title:"",text:'<span style="sweetAlertFont">Something went wrong! Please try again later</span>',html:!0})})},t.enableUploadbutton=function(t){"org"==t?document.getElementById("orgUploadButton").disabled=!1:"cli"==t&&(document.getElementById("clientUploadButton").disabled=!1)},t.selectedOrgLogo=function(e){t.orgLogoSrc=e},t.selectedCliLogo=function(e){t.cliLogoSrc=e},t.exportReportGridsterOptions={margins:[10,20],columns:10,rows:11,minRows:11,maxRows:500,defaultSizeX:10,defaultSizeY:2,minSizeX:10,minSizeY:1,swapping:!0,floating:!1,pushing:!0,width:"auto",colWidth:"auto",draggable:{enabled:!1},outerMargin:!0,mobileBreakPoint:768,mobileModeEnabled:!0,resizable:{enabled:!1}},t.printReportInPDF=function(){var e=[];angular.copy(t.customReport.widgets,e);var a=[],r=0,s=0;do{var i=[];t:for(var o in e){if(e[o].pageNumber!=r)break t;if("pageBreakWidget"==e[o].widgetType)e[o]=null;else if("reportParaWidget"==e[o].widgetType||"reportHeadingWidget"==e[o].widgetType)i.push({pageNumber:r,row:s,col:0,sizeY:"reportHeadingWidget"!=typeof e[o].widgetType?e[o].sizeY:1,sizeX:12,widgetType:e[o].widgetType,name:"undefined"!=typeof e[o].name?e[o].name:"",id:e[o].id,textData:e[o].textData||""}),s+=e[o].sizeY,e[o]=null;else{e[o].id;i.push({pageNumber:r,row:s,col:0,sizeY:"undefined"!=typeof e[o].sizeY?e[o].sizeY:4,sizeX:12,name:"undefined"!=typeof e[o].name?e[o].name:"",widgetType:"undefined"!=typeof e[o].widgetType?e[o].widgetType:"",id:e[o].id,visibility:!1,channelName:"undefined"!=typeof e[o].channelName?e[o].channelName:"",dashboardId:"undefined"!=typeof e[o].dashboardId?e[o].dashboardId:""}),s+=e[o].sizeY,e[o]=null}}for(var n=e.length,c=[],l=0;l<n;l++)null!=e[l]&&c.push(e[l]);e=[],e=c,a[r]=i,s=0,++r}while(e.length>0);t.exportReportPages=a,t.reportLoading=!1,t.stepActive="step3";for(var h in t.customReport.widgetData)t.customReport.widgetData[h].visibility=!0},t.exportReportinPDF=function(){$("#reportDownloadButton").disabled=!0,$("#reportDownloadButton").addClass("exportDisabled"),$("#reportEditButton").disabled=!0,$("#reportEditButton").addClass("exportDisabled"),$(".navbar").css("z-index","1"),$(".md-overlay").css("background","rgba(0,0,0,0.5)"),$("#reportPDFModalContent").addClass("md-show"),$(".reportPdfHeadText").hide(),$(".pdfContentText").html("<b>Please wait while the PDF file is being generated</b>"),$(".loadingStatus").show();var e=[],a=[];t.exportPromise=function(t){var e=c.defer();return domtoimage.toPng(t).then(function(t){e.resolve(t)},function(t){e.reject(t),console.log("Dom to image fails",t)}),e.promise};for(var s=0;s<t.exportReportPages.length;s++)e[s]=document.getElementById("gridsterItemsInReport-"+s),a.push(t.exportPromise(e[s]));c.all(a).then(function(e){var a={dashboardLayout:e,dashboardId:i.params.id,dashboardName:t.customReport.reportName};r({method:"POST",url:"/api/v1/createHtml5ToPdf/report",data:a}).then(function(e){$("#exportOptionPDF").prop("checked",!1);var a=(Number(new Date),"");a="localhost"==window.location.hostname?"http://localhost:8080":"";var s=String(a+e.data.Response);$("#reportPDFModalContent").removeClass("md-show"),$(".md-overlay").css("background","rgba(0,0,0,0.5)"),$("#reportPDFModalContent").addClass("md-show"),$(".loadingStatus").hide(),$(".reportPdfHeadText").show().text("PDF has been generated successfully").css({"font-style":"normal",color:"#232c3b"}),$(".pdfContentText").html('<b><br/><a href="'+s+'" download style="color: green;"  id="yourLinkID">Click here to download your PDF</a></b>');var i={reportId:t.reportId,pdfLink:s};r({method:"POST",url:"/api/v1/create/reports",data:i}).then(function(t){"200"==t.status&&($("#reportDownloadButton").disabled=!1),$("#reportDownloadButton").removeClass("exportDisabled"),$("#reportEditButton").disabled=!1,$("#reportEditButton").removeClass("exportDisabled")},function(t){$("#reportDownloadButton").disabled=!1,$("#reportDownloadButton").removeClass("exportDisabled"),$("#reportEditButton").disabled=!1,$("#reportEditButton").removeClass("exportDisabled")})},function(t){$("#reportPDFModalContent").removeClass("md-show"),$(".md-overlay").css("background","rgba(0,0,0,0.5)"),$("#reportPDFModalContent").addClass("md-show"),$(".loadingStatus").hide(),$(".reportPdfHeadText").show().text("Uh-Oh!!").css({"font-style":"normal",color:"red"}),$(".pdfContentText").html("<b>Something went wrong. Please try again</b>"),$("#reportDownloadButton").disabled=!1,$("#reportDownloadButton").removeClass("exportDisabled"),$("#reportEditButton").disabled=!1,$("#reportEditButton").removeClass("exportDisabled")})},function(t){swal({title:"",text:'<span style = "sweetAlertFont"> Sorry..! PDF download failed. </span>',html:!0})})},t.reportPdfPreview=function(a){if("step3"==a){t.summaryAlignLessThanThree=[],t.toDisplayAllSummary=[],t.reportLoading=!0;for(var r in t.customReport.widgetData)t.customReport.widgetData[r].visibility=!1;e(function(){t.printReportInPDF()},1500)}else if("step2"==a)t.reportLoading=!0,t.fetchLogosFromDB("org"),t.fetchLogosFromDB("cli"),t.reportLoading=!1,t.stepActive=a;else{t.stepActive=a;for(var r in t.customReport.widgetData)t.customReport.widgetData[r].visibility=!0}},t.customReportConfiguration=function(){function o(e,a,s){var o={reportId:i.params.id,startDate:e,endDate:a};r({method:"POST",url:"/api/v1/create/reports",data:o}).then(function(e){if(200==e.status)t.startDate=e.config.data.startDate,t.endDate=e.config.data.endDate,s===!0?t.userModifyDate(t.startDate,t.endDate):t.populateReportWidgets();else{this.start_date,this.end_date;t.populateReportWidgets()}},function(e){this.start_date,this.end_date;t.populateReportWidgets()})}t.reportLoading=!0,t.dashboardWidgets=[],t.reportPagesDetails=[],t.reportWidgetsListArray=[],t.customReport.reportName="",t.widgetsPresent=!1,t.loadedWidgetCount=0,t.startDate,t.endDate,t.empWidget={col:0,sizeY:1,sizeX:10,name:"Page Options"},t.setChartSize=function(t,a){function r(){if(null!=document.getElementById("chartOptions"+t)){var e=document.getElementById("chartOptions"+t).offsetWidth,r=document.getElementById("chartOptions"+t).offsetHeight;document.getElementById("chartRepeat"+t+"-"+a).style.height=r+"px",document.getElementById("chartRepeat"+t+"-"+a).style.width=e+"px"}}e(r,100)},t.setChartSizeInReport=function(t,a,r){function s(){if(null!=document.getElementById("reportChartOptions-"+t+"-"+a)){var e=document.getElementById("reportChartOptions-"+t+"-"+a).offsetWidth,s=document.getElementById("reportChartOptions-"+t+"-"+a).offsetHeight;document.getElementById("reportChartRepeat-"+t+"-"+a+"-"+r).style.height=s+"px",document.getElementById("reportChartRepeat-"+t+"-"+a+"-"+r).style.width=e+"px"}}e(s,100)},t.summaryAlignLessThanThree=[],t.toDisplayAllSummary=[],t.summaryAlignLessThanThreePdf=[],t.toDisplayAllSummaryPdf=[],t.checkAllGraphsZero=function(e,a,r){void 0==t.summaryAlignLessThanThree[a]&&(t.summaryAlignLessThanThree[a]=[]),void 0==t.toDisplayAllSummary[a]&&(t.toDisplayAllSummary[a]=[]);for(var s=0,i=0;i<e.data.length;i++)0===e.data[i].summaryDisplay&&(s+=1);t.summaryAlignLessThanThree[a][r]=e.data.length-s,s===e.data.length?t.toDisplayAllSummary[a][r]=!0:t.toDisplayAllSummary[a][r]=!1},t.checkAllGraphsZeroForReportPdf=function(e,a,r,s){void 0==t.summaryAlignLessThanThreePdf[a]?(t.summaryAlignLessThanThreePdf[a]=[],t.summaryAlignLessThanThreePdf[a][r]=[]):void 0==t.summaryAlignLessThanThreePdf[a][r]&&(t.summaryAlignLessThanThreePdf[a][r]=[]),void 0==t.toDisplayAllSummaryPdf[a]?(t.toDisplayAllSummaryPdf[a]=[],t.toDisplayAllSummaryPdf[a][r]=[]):void 0==t.toDisplayAllSummaryPdf[a][r]&&(t.toDisplayAllSummaryPdf[a][r]=[]);for(var i=0,o=0;o<e.data.length;o++)0===e.data[o].summaryDisplay&&(i+=1);t.summaryAlignLessThanThreePdf[a][r][s]=e.data.length-i,i===e.data.length?t.toDisplayAllSummaryPdf[a][r][s]=!0:t.toDisplayAllSummaryPdf[a][r][s]=!1},t.fetchReportDetails=function(){var e,a="undefined";r({method:"GET",url:"/api/v1/getSubscriptionFromDashboard/"+a}).then(function(t){e=200==t.status?t.data.response.limits.dateRange:365}),r({method:"GET",url:"/api/v1/get/report/null",params:{customReportId:i.params.id}}).then(function(a){function r(t,e){var a=new Date(t),r=new Date(e),s=Math.abs(r.getTime()-a.getTime()),i=Math.ceil(s/864e5);return i}if(200==a.status&&1!=a.data.dashboardDeleted){t.customReportId=a.data.customReportId,t.reportId=a.data._id,t.customReport.reportName=a.data.name,t.reportType=a.data.type;for(var s in a.data.widgets)t.reportWidgetsListArray.push(a.data.widgets[s]),"reportParaWidget"==a.data.widgets[s].widgetType&&"reportHeadingWidget"==a.data.widgets[s].widgetType&&"reportParaWidget"==a.data.widgets[s].widgetType&&void 0==a.data.widgets[s].widgetId&&null==a.data.widgets[s].widgetId||t.dashboardWidgets.push(a.data.widgets[s].widgetId);t.reportWidgetsListArray=_.uniq(t.reportWidgetsListArray),t.dashboardWidgets=_.uniq(t.dashboardWidgets);var i=r(a.data.startDate,new Date),n=r(a.data.endDate,new Date),c=!0;i>=365||n>=365?(t.startDate=moment(new Date).subtract(30,"days"),t.endDate=new Date,o(t.startDate,t.endDate,c)):(t.startDate=a.data.startDate,t.endDate=a.data.endDate,t.userModifyDate(t.startDate,t.endDate,e))}else t.reportLoading=!1,t.stepActive="error",isExportOptionSet=0,211==a.status?swal({title:"",text:'<span style = "sweetAlertFont">Dashboard linked with this report is missing</span>',html:!0}):swal({title:"",text:'<span style = "sweetAlertFont">Error in populating Report! Report Doesnot Exist</span>',html:!0})},function(e){t.reportLoading=!1,t.stepActive="error",401==e.status?swal({title:"",text:'<span style = "sweetAlertFont">Authentication required to perform this action</span>',html:!0}):211==e.status?swal({title:"",text:'<span style = "sweetAlertFont">Dashboard linked with this report is missing</span>',html:!0}):swal({title:"",text:'<span style = "sweetAlertFont">Error in populating Report! Report Doesnot Exist</span>',html:!0}),isExportOptionSet=0})},t.fetchReportDetails(),t.userModifyDate=function(e,a,s){t.dashboardCalendar=new Calendar({element:$(".daterange--double"),earliest_date:moment(new Date).subtract(s,"days"),latest_date:new Date,start_date:e,end_date:a,callback:function(){o(this.start_date,this.end_date),r.pendingRequests.forEach(function(t){t.cancel&&t.cancel.resolve()})}}),t.populateReportWidgets()},t.gridsterOptions={margins:[10,20],columns:10,maxRows:500,defaultSizeX:10,defaultSizeY:2,minSizeX:10,minSizeY:1,
swapping:!0,floating:!0,pushing:!0,width:"auto",colWidth:"auto",draggable:{enabled:!1},outerMargin:!0,mobileBreakPoint:768,mobileModeEnabled:!0,resizable:{enabled:!1}},t.$on("gridster-mobile-changed",function(e,a){t.isMobile=a.isMobile}),t.$on("broadCastUpdateCharts",function(t,e){a.$broadcast("updateWidgetDetailsInReport",{})}),t.updateWidgetsInDb=function(){a.$broadcast("updateWidgetDetailsInReport",{})},angular.element(s).on("resize",function(e){t.reportNotSupported=!1,t.docHeight=window.innerHeight,t.docHeight=t.docHeight-60,window.innerWidth>=1100?t.docWidth=window.innerWidth>1080?window.innerWidth-1080:0:window.innerWidth>=992?t.docWidth=window.innerWidth>990?window.innerWidth-990:0:window.innerWidth>=767?t.docWidth=window.innerWidth>720?window.innerWidth-720:0:t.reportNotSupported=!0,t.sideSpace=Math.floor(t.docWidth/2),"step1"==t.stepActive?t.$broadcast("resize"):"step3"==t.stepActive&&t.$broadcast("report-resize")}),t.$on("resize",function(a){function r(t){return function(){if(null!=document.getElementById("chartOptions"+t))for(var e=document.getElementById("chartOptions"+t).offsetWidth,a=document.getElementById("chartOptions"+t).offsetHeight,r=0;r<Highcharts.charts.length;r++)Highcharts.charts[r].container.parentElement.id.includes("chartRepeat"+t)&&(Highcharts.charts[r].setSize(e,a),Highcharts.charts[r].reflow())}}for(var s=0;s<t.customReport.widgets.length;s++)"reportParaWidget"==t.customReport.widgets[s].widgetType&&"reportHeadingWidget"==t.customReport.widgets[s].widgetType||e(r(s),10)}),t.$on("report-resize",function(a){e(function(){function a(t,e){return function(){if(null!=document.getElementById("reportChartOptions-"+t+"-"+e))for(var a=document.getElementById("reportChartOptions-"+t+"-"+e).offsetWidth,r=document.getElementById("reportChartOptions-"+t+"-"+e).offsetHeight,s=0;s<Highcharts.charts.length;s++)Highcharts.charts[s].container.parentElement.id.includes("reportChartRepeat-"+t+"-"+e)&&(Highcharts.charts[s].setSize(a,r),Highcharts.charts[s].reflow())}}for(var r in t.exportReportPages)for(var s in t.exportReportPages[r])"reportParaWidget"==t.exportReportPages[r][s].widgetType&&"reportHeadingWidget"==t.exportReportPages[r][s].widgetType||e(a(r,s),800)},10)}),t.summaryAlignLessThanThree=[],t.toDisplayAllSummary=[],t.checkAllGraphsZero=function(e,a){console.log("chart",e);for(var r=0,s=0;s<e.data.length;s++)0===e.data[s].summaryDisplay&&(r+=1);t.summaryAlignLessThanThree[a]=e.data.length-r,r===e.data.length&&(t.toDisplayAllSummary[a]=!0),console.log(" $scope.summaryAlignLessThanThree[widgetId]",t.summaryAlignLessThanThree[a],t.toDisplayAllSummary[a])},t.calculateRowHeight=function(t,e,a,r){t.showComparision=!1,a<6?e>6?t.showComparision=!1:t.showComparision=!0:e>12?t.showComparision=!1:t.showComparision=!0},t.disableTextEdit=function(t,e){t.textAreaHide=e,1==e&&a.$broadcast("updateWidgetDetailsInReport",{})},t.$on("updateWidgetDetailsInReport",function(e,a){var s=[];if(t.customReport.widgets.length>0){for(var i in t.customReport.widgets)"pageBreakWidget"==t.customReport.widgets[i].widgetType?s[i]={name:t.customReport.widgets[i].name,sizeY:t.customReport.widgets[i].sizeY,widgetType:t.customReport.widgets[i].widgetType,row:t.customReport.widgets[i].row,col:t.customReport.widgets[i].col,pageNumber:t.customReport.widgets[i].pageNumber}:(s[i]={widgetId:t.customReport.widgets[i].id,name:t.customReport.widgets[i].name,sizeY:t.customReport.widgets[i].sizeY,widgetType:t.customReport.widgets[i].widgetType,row:t.customReport.widgets[i].row,col:t.customReport.widgets[i].col,pageNumber:t.customReport.widgets[i].pageNumber},"reportParaWidget"==t.customReport.widgets[i].widgetType||"reportHeadingWidget"==t.customReport.widgets[i].widgetType?s[i].textData=t.customReport.widgets[i].textData||"":s[i].dashboardId=t.customReport.widgets[i].dashboardId),"undefined"!=t.customReport.widgets[i].isLastWidgetInPage&&1==t.customReport.widgets[i].isLastWidgetInPage&&(s[i].isLastWidgetInPage=!0,s[i].sizeFilledInPage=t.customReport.widgets[i].sizeFilledInPage,s[i].sizeLeftInPage=t.customReport.widgets[i].sizeLeftInPage),"undefined"!=t.customReport.widgets[i].isFirstWidgetInPage&&1==t.customReport.widgets[i].isFirstWidgetInPage&&(s[i].isFirstWidgetInPage=!0);var o={reportId:t.reportId,widgets:s};r({method:"POST",url:"/api/v1/create/reports",data:o}).then(function(t){toastr.info("Your changes have been saved successfully..!")},function(t){swal({title:"",text:"<span style='sweetAlertFont'>Something is missing! Please refresh the dashboard</span> .",html:!0})})}}),t.toggleLegends=function(e){for(var a in t.customReport.widgetData)if(t.customReport.widgetData[a].id==e)for(var r in t.customReport.widgetData[a].chart)"undefined"!=typeof t.customReport.widgetData[a].chart[r].options.chart.showLegend&&(1==t.customReport.widgetData[a].chart[r].options.chart.showLegend?t.customReport.widgetData[a].chart[r].options.chart.showLegend=!1:t.customReport.widgetData[a].chart[r].options.chart.showLegend=!0)}},a.populateReportWidgets=function(){t.customReport.widgets=[],t.customReport.widgetData={},t.totalPagesinReport=[],t.widgetDataLength=0;var e={widgets:t.dashboardWidgets};r({method:"POST",url:"/api/v1/get/reportWidgets/",timeout:l.promise,cancel:l,data:e}).then(function(e){if($(".dr-dates").attr("contenteditable","false"),e.data)if(e.data.error)isExportOptionSet=0,swal({title:"",text:'<span style = "sweetAlertFont">The requested Report has no widgets</span>',html:!0}),t.reportLoading=!1,t.stepActive="error";else if("null"==t.reportType)swal({title:"",text:'<span style = "sweetAlertFont">Something went wrong.Please try again later.</span>',html:!0}),t.reportLoading=!1,t.stepActive="error";else if("edited"==t.reportType){var r=[];angular.copy(t.reportWidgetsListArray,r);var s=[],i=[],o=e.data;o.length>0?(t.loadedWidgetCount=0,t.widgetsPresent=!0):t.widgetsPresent=!1;var c=[],l=[];angular.copy(o,s);var h=[],p=1;for(var d in r){if(h.push(r[d].pageNumber),"reportParaWidget"==r[d].widgetType)t.customReport.widgets.push({pageNumber:r[d].pageNumber,row:p,col:0,sizeY:"undefined"!=typeof r[d].sizeY?r[d].sizeY:4,sizeX:10,name:"undefined"!=typeof r[d].name?r[d].name:"Paragraph Widget",widgetType:"undefined"!=typeof r[d].widgetType?r[d].widgetType:"reportParaWidget",id:r[d].widgetId,textData:r[d].textData||"",textAreaHide:!0}),p+=r[d].sizeY;else if("reportHeadingWidget"==r[d].widgetType)t.customReport.widgets.push({pageNumber:r[d].pageNumber,row:p,col:0,sizeY:1,sizeX:10,name:"undefined"!=typeof r[d].name?r[d].name:"Heading Widget",widgetType:"undefined"!=typeof r[d].widgetType?r[d].widgetType:"reportHeadingWidget",id:r[d].widgetId,textData:r[d].textData||"",textAreaHide:!0}),p+=1;else if("pageBreakWidget"==r[d].widgetType)t.customReport.widgets.push({pageNumber:r[d].pageNumber,row:p,col:0,sizeY:1,sizeX:10,widgetType:"pageBreakWidget",name:"undefined"!=typeof r[d].row?r[d].name:"Page break"}),p+=1;else{var u=s.map(function(t){return t._id}).indexOf(r[d].widgetId);if(u!=-1){var g=r[d].widgetId;c[g]=n.widgetHandler(s[u],{startDate:moment(t.dashboardCalendar.start_date).format("YYYY-MM-DD"),endDate:moment(t.dashboardCalendar.end_date).format("YYYY-MM-DD")},"public"),t.customReport.widgets.push({pageNumber:r[d].pageNumber,row:p,col:0,sizeY:"undefined"!=typeof r[d].sizeY?r[d].sizeY:8,sizeX:10,name:"undefined"!=typeof r[d].name?r[d].name:"",widgetType:"undefined"!=typeof r[d].widgetType?r[d].widgetType:"",id:r[d].widgetId,visibility:!1,channelName:"undefined"!=typeof s[u].channelName?s[u].channelName:"",dashboardId:"undefined"!=typeof r[d].dashboardId?r[d].dashboardId:""}),p+=r[d].sizeY,t.customReport.widgetData[g]={pageNumber:r[d].pageNumber,id:r[d].widgetId,chart:[],visibility:!1,name:"undefined"!=typeof r[d].name?r[d].name:"",color:"undefined"!=typeof s[u].color?s[u].color:""},t.widgetDataLength+=1,c[g].then(function(e){for(var a in t.customReport.widgetData)t.customReport.widgetData[a].id==e.id&&(t.customReport.widgetData[a]=e,isExportOptionSet=1,t.loadedWidgetCount++)},function(e){401===e.status?($("#widgetData-"+e.data.id).hide(),1003===e.data.errorstatusCode&&($("#widgetData-"+e.data.id).hide(),$("#errorWidgetData-"+e.data.id).hide(),$("#errorWidgetTokenexpire-"+e.data.id).show(),t.widgetErrorCode=1,t.loadedWidgetCount++,isExportOptionSet=0)):(t.loadedWidgetCount++,"undefined"!=typeof e.data.id&&($("#widgetData-"+e.data.id).hide(),$("#errorWidgetData-"+e.data.id).show(),$("#errorWidgetTokenexpire-"+e.data.id).hide(),isExportOptionSet=0))})}}if("undefined"!=r[d].isFirstWidgetInPage&&1==r[d].isFirstWidgetInPage){var m=t.customReport.widgets.length-1;t.customReport.widgets[m].isFirstWidgetInPage=!0,t.reportPagesDetails[r[d].pageNumber]={firstWidgetIndex:m}}if("undefined"!=r[d].isLastWidgetInPage&&1==r[d].isLastWidgetInPage){var m=t.customReport.widgets.length-1;t.reportPagesDetails[r[d].pageNumber]=t.reportPagesDetails[r[d].pageNumber]||{},t.reportPagesDetails[r[d].pageNumber].sizeFilled=r[d].sizeFilledInPage,t.reportPagesDetails[r[d].pageNumber].sizeLeft=r[d].sizeLeftInPage,t.reportPagesDetails[r[d].pageNumber].lastWidgetIndex=m,t.customReport.widgets[m].isLastWidgetInPage=!0,t.customReport.widgets[m].sizeFilledInPage=r[d].sizeFilledInPage,t.customReport.widgets[m].sizeLeftInPage=r[d].sizeLeftInPage}}t.reportLoading=!1}else{var s=[],i=[],o=e.data;for(d in o)1==o[d].visibility&&i.push(o[d]);i.length>0?(t.loadedWidgetCount=0,t.widgetsPresent=!0):t.widgetsPresent=!1;var c=[],l=[];angular.copy(i,s);var f=0,p=1;do{var y={sizeFilled:0,sizeLeft:5,widgetsCount:0};for(var d in s)if((s[d].size.h<2||"undefined"==typeof s[d].size)&&(s[d].size.h=2),s[d].size.h<=y.sizeLeft){var g=s[d]._id;if(c[g]=n.widgetHandler(s[d],{startDate:moment(t.dashboardCalendar.start_date).format("YYYY-MM-DD"),endDate:moment(t.dashboardCalendar.end_date).format("YYYY-MM-DD")},"public"),t.customReport.widgets.push({pageNumber:f,row:p,col:0,sizeY:"undefined"!=typeof s[d].size?2*s[d].size.h:4,sizeX:10,name:"undefined"!=typeof s[d].name?s[d].name:"",widgetType:"undefined"!=typeof s[d].widgetType?s[d].widgetType:"",id:s[d]._id,visibility:!1,channelName:"undefined"!=typeof s[d].channelName?s[d].channelName:"",dashboardId:"undefined"!=typeof s[d].dashboardId?s[d].dashboardId:""}),t.customReport.widgetData[g]={pageNumber:f,id:s[d]._id,chart:[],visibility:!1,name:"undefined"!=typeof s[d].name?s[d].name:"",color:"undefined"!=typeof s[d].color?s[d].color:""},t.widgetDataLength+=1,c[g].then(function(e){for(var a in t.customReport.widgetData)t.customReport.widgetData[a].id==e.id&&(t.customReport.widgetData[a]=e,isExportOptionSet=1,t.loadedWidgetCount++)},function(e){401===e.status?($("#widgetData-"+e.data.id).hide(),1003===e.data.errorstatusCode&&($("#widgetData-"+e.data.id).hide(),$("#errorWidgetData-"+e.data.id).hide(),$("#errorWidgetTokenexpire-"+e.data.id).show(),t.widgetErrorCode=1,t.loadedWidgetCount++,isExportOptionSet=0)):(t.loadedWidgetCount++,"undefined"!=typeof e.data.id&&($("#widgetData-"+e.data.id).hide(),$("#errorWidgetData-"+e.data.id).show(),$("#errorWidgetTokenexpire-"+e.data.id).hide(),isExportOptionSet=0))}),5==y.sizeLeft){var m=t.customReport.widgets.length-1;t.customReport.widgets[m].isFirstWidgetInPage=!0,t.reportPagesDetails[f]={firstWidgetIndex:m}}p+=2*s[d].size.h,y.sizeLeft-=s[d].size.h,y.sizeFilled+=s[d].size.h,++y.widgetsCount,s[d]=null}if(y.widgetsCount>0){var m=t.customReport.widgets.length-1;t.reportPagesDetails[f]=t.reportPagesDetails[f]||{},t.reportPagesDetails[f].sizeFilled=2*y.sizeFilled,t.reportPagesDetails[f].sizeLeft=2*y.sizeLeft,t.reportPagesDetails[f].lastWidgetIndex=m,t.customReport.widgets[m].isLastWidgetInPage=!0,t.customReport.widgets[m].sizeFilledInPage=2*y.sizeFilled,t.customReport.widgets[m].sizeLeftInPage=2*y.sizeLeft,t.customReport.widgets.push({pageNumber:f,row:p,col:0,sizeY:1,sizeX:10,widgetType:"pageBreakWidget",name:"Page Break"})}++p;for(var v=s.length,D=[],b=0;b<v;b++)null!=s[b]&&D.push(s[b]);s=[],s=D,l[f]=y,++f}while(s.length>0);t.reportLoading=!1,a.$broadcast("updateWidgetDetailsInReport",{})}else isExportOptionSet=0,swal({title:"",text:'<span style = "sweetAlertFont">The requested Report has been deleted</span>',html:!0}),t.reportLoading=!1,t.stepActive="error"},function(e){swal({title:"",text:'<span style = "sweetAlertFont">Error in populating widgets! Please refresh the Report again</span>',html:!0}),isExportOptionSet=0,t.reportLoading=!1,t.stepActive="error"})},t.arrangingWidgetsinReport=function(e,a,r){var s,i=c.defer(),o=r;if(void 0==t.reportPagesDetails[a])t.reportPagesDetails[a]={sizeFilled:1,sizeLeft:9,firstWidgetIndex:t.customReport.widgets.length,lastWidgetIndex:t.customReport.widgets.length},t.customReport.widgets.push({pageNumber:a,row:o+1,col:0,sizeY:1,sizeX:10,widgetType:"pageBreakWidget",name:"Avaliable Options"}),e.isFirstWidgetInPage=!0,e.isLastWidgetInPage=!0,e.sizeLeftInPage=9,e.sizeFilledInPage=1,s=t.customReport.widgets.length-1,i.resolve(s);else if(e.sizeY<=t.reportPagesDetails[a].sizeLeft){s=t.reportPagesDetails[a].firstWidgetIndex;var n=t.reportPagesDetails[a].lastWidgetIndex;t.reportPagesDetails[a].sizeLeft-=e.sizeY,t.reportPagesDetails[a].sizeFilled+=e.sizeY,++t.reportPagesDetails[a].lastWidgetIndex;for(var l=s;l<=n;l++)1==t.customReport.widgets[l].isLastWidgetInPage&&(t.customReport.widgets[n].sizeFilledInPage=t.reportPagesDetails[a].sizeFilled,t.customReport.widgets[n].sizeLeftInPage=t.reportPagesDetails[a].sizeLeft);e.isFirstWidgetInPage=!0,t.customReport.widgets[s].isFirstWidgetInPage=!1;for(var h=a+1;h<t.reportPagesDetails.length;h++)++t.reportPagesDetails[h].firstWidgetIndex,++t.reportPagesDetails[h].lastWidgetIndex;i.resolve(s)}else{s=t.reportPagesDetails[a].firstWidgetIndex;var p=a;e.isFirstWidgetInPage=!0,t.customReport.widgets[s].isFirstWidgetInPage=!1;var d=t.customReport.widgets.slice(s);d[0].row+=e.sizeY;var o=d[0].row,u={sizeFilled:1,sizeLeft:9,widgetsCount:0};t:do{var g;e:for(var m in d)if("pageBreakWidget"==d[m].widgetType){var f=t.customReport.widgets.map(function(t){return t}).indexOf(d[m]);f>-1&&(t.customReport.widgets.splice(f,1),d[m]=null)}else if(g=t.customReport.widgets.map(function(t){return t.id}).indexOf(d[m].id),g!=-1){if(!(d[m].sizeY<=u.sizeLeft)){t.reportPagesDetails[p]=t.reportPagesDetails[p]||{},t.reportPagesDetails[p].sizeFilled=u.sizeFilled,t.reportPagesDetails[p].sizeLeft=u.sizeLeft,t.reportPagesDetails[p].lastWidgetIndex=g,t.customReport.widgets[g-1].isLastWidgetInPage=!0,t.customReport.widgets[g-1].sizeFilledInPage=u.sizeFilled,t.customReport.widgets[g-1].sizeLeftInPage=u.sizeLeft,t.customReport.widgets.splice(g,0,{pageNumber:p,row:o,col:0,sizeY:1,sizeX:10,widgetType:"pageBreakWidget",name:"Avaliable Options"}),o+=1,u.newPage=!0;break e}if(d[m].pageNumber>p){t.reportPagesDetails[p]=t.reportPagesDetails[p]||{},t.reportPagesDetails[p].sizeFilled=u.sizeFilled,t.reportPagesDetails[p].sizeLeft=u.sizeLeft,t.reportPagesDetails[p].lastWidgetIndex=g-1,t.customReport.widgets[g-1].isLastWidgetInPage=!0,t.customReport.widgets[g-1].sizeFilledInPage=u.sizeFilled,t.customReport.widgets[g-1].sizeLeftInPage=u.sizeLeft,t.customReport.widgets.splice(g,0,{pageNumber:p,row:o,col:0,sizeY:1,sizeX:10,widgetType:"pageBreakWidget",name:"Avaliable Options"}),o+=1;for(var h=d[m].pageNumber;h<t.reportPagesDetails.length;h++)++t.reportPagesDetails[h].firstWidgetIndex,++t.reportPagesDetails[h].lastWidgetIndex;break t}t.customReport.widgets[g].row=o,1==t.customReport.widgets[g].isLastWidgetInPage&&(t.customReport.widgets[g].isLastWidgetInPage=!1),1==t.customReport.widgets[g].isFirstWidgetInPage&&(t.customReport.widgets[g].isFirstWidgetInPage=!1),t.customReport.widgets[g].pageNumber=p,10==u.sizeLeft&&(t.customReport.widgets[g].isFirstWidgetInPage=!0,t.reportPagesDetails[p]={firstWidgetIndex:g+1}),o+=d[m].sizeY,u.sizeLeft-=d[m].sizeY,u.sizeFilled+=d[m].sizeY,u.newPage=!1,++u.widgetsCount,d[m]=null}var y=d.length,v=[];"undefined"!=u.newPage&&1!=u.newPage&&(t.reportPagesDetails[p]=t.reportPagesDetails[p]||{},t.reportPagesDetails[p].sizeFilled=u.sizeFilled,t.reportPagesDetails[p].sizeLeft=u.sizeLeft,t.reportPagesDetails[p].lastWidgetIndex=g+1,t.customReport.widgets[g].isLastWidgetInPage=!0,t.customReport.widgets[g].sizeFilledInPage=u.sizeFilled,t.customReport.widgets[g].sizeLeftInPage=u.sizeLeft,t.customReport.widgets.splice(g+1,0,{pageNumber:p,row:o,col:0,sizeY:1,sizeX:10,widgetType:"pageBreakWidget",name:"Avaliable Options"}),o+=1);for(var D=0;D<y;D++)null!=d[D]&&v.push(d[D]);d=[],d=v,++p,u={sizeFilled:0,sizeLeft:10,widgetsCount:0}}while(d.length>0);t.$broadcast("resize"),i.resolve(s)}return i.promise},t.addTextWidget=function(s,i,o,n){var l=[],h=n,p=[];angular.copy(t.customReport.widgets,p),"reportParaWidget"==s?l.push({reportId:t.reportId,row:h,col:0,sizeY:1,sizeX:10,widgetType:s,name:"Paragraph Widget",textData:""}):l.push({reportId:t.reportId,row:h,col:0,sizeY:1,sizeX:10,widgetType:s,name:"Heading Widget",textData:""}),r({method:"POST",url:"/api/v1/create/textWidgets",data:l}).then(function(r){var o,n={id:r.data.widgetsList[0]._id,pageNumber:i,row:h,col:0,sizeY:l[0].sizeY,sizeX:10,widgetType:s,name:l[0].name,textData:"",textAreaHide:!1},d=[];d.push(t.arrangingWidgetsinReport(n,i,h)),c.all(d).then(function(r){function s(){a.$broadcast("updateWidgetDetailsInReport",{widgets:t.customReport.widgets})}o=r[0],t.customReport.widgets.splice(o,0,n),e(s,2e3)},function(r){function s(){a.$broadcast("updateWidgetDetailsInReport",{widgets:t.customReport.widgets})}t.customReport.widgets=p,e(s,2e3),swal({title:"",text:"<span style='sweetAlertFont'>Cannot Insert Widget at this moment! Please refresh the report</span> .",html:!0}),t.populateReportWidgets()})},function(t){swal({title:"",text:"<span style='sweetAlertFont'>Something is missing! Cannot Insert Widget at this moment!</span> .",html:!0})})},t.deleteWidgetFromReport=function(r){var s=r.pageNumber,i=t.customReport.widgets.indexOf(r);t.reportPagesDetails[s].sizeLeft+=r.sizeY,t.reportPagesDetails[s].sizeFilled-=r.sizeY,t.customReport.widgets.splice(i,1),t.reportPagesDetails[s].lastWidgetIndex>0&&--t.reportPagesDetails[s].lastWidgetIndex;var o;o=i;var n=t.reportPagesDetails[s].lastWidgetIndex;if("pageBreakWidget"!=t.customReport.widgets[n].widgetType&&(t.customReport.widgets[n].sizeFilledInPage=t.reportPagesDetails[s].sizeFilled,t.customReport.widgets[n].sizeLeftInPage=t.reportPagesDetails[s].sizeLeft),0==t.reportPagesDetails[s].sizeFilled||10==t.reportPagesDetails[s].sizeLeft){if("pageBreakWidget"==t.customReport.widgets[i].widgetType){t.customReport.widgets.splice(i,1),t.reportPagesDetails.splice(s,1);for(var c=i;c<t.customReport.widgets.length;c++)t.customReport.widgets[c].pageNumber-=1;for(var l=s;l<t.reportPagesDetails.length;l++)t.reportPagesDetails[l].firstWidgetIndex-=2,t.reportPagesDetails[l].lastWidgetIndex-=2}}else{1==r.isLastWidgetInPage&&(t.customReport.widgets[n].isLastWidgetInPage=!0),1==r.isFirstWidgetInPage&&(t.customReport.widgets[o].isFirstWidgetInPage=!0);for(var l=s+1;l<t.reportPagesDetails.length;l++)--t.reportPagesDetails[l].firstWidgetIndex,--t.reportPagesDetails[l].lastWidgetIndex}e(function(){a.$broadcast("updateWidgetDetailsInReport",{})},3e3),"reportHeadingWidget"==r.widgetType||"reportParaWidget"==r.widgetType?t.deleteWidgetInDB(r):(delete t.customReport.widgetData[r.id],t.loadedWidgetCount-=1,t.widgetDataLength-=1)},t.deleteWidgetInDB=function(t){t.widgetType,t.id;r({method:"POST",url:"/api/v1/delete/textWidgets/"+t.id}).then(function(t){},function(t){swal({title:"",text:'<span style = "sweetAlertFont">Error in deleting the widget! Please try again</span>',html:!0})})},t.changeReportName=function(){var e={reportId:t.reportId,name:t.customReport.reportName};r({method:"POST",url:"/api/v1/create/reports",data:e}).then(function(t){},function(t){swal({title:"",text:"<span style='sweetAlertFont'>Error in changing the name! Please try again</span> .",html:!0})})},t.changeFooterText=function(e){t.displayDate=e},t.changeHeaderText=function(e){t.displayHeader=e},t.swapArrayElements=function(e,a){var r=t.customReport.widgets[e];t.customReport.widgets[e]=t.customReport.widgets[a],t.customReport.widgets[a]=r},t.pushUpWidget=function(a,r){var s={};angular.copy(a,s);var i=s.pageNumber,r=r;if(1==s.isFirstWidgetInPage){var o=t.reportPagesDetails[i-1].lastWidgetIndex;if(t.reportPagesDetails[i-1].sizeLeft>=s.sizeY){t.customReport.widgets[r].pageNumber-=1,t.customReport.widgets[r].row=t.customReport.widgets[r-1].row,t.customReport.widgets[r].isFirstWidgetInPage=!1,t.reportPagesDetails[i-1].sizeFilled+=s.sizeY,t.reportPagesDetails[i-1].sizeLeft-=s.sizeY;var n=t.reportPagesDetails[i-1].lastWidgetIndex;if(t.customReport.widgets[n].isLastWidgetInPage=!1,t.reportPagesDetails[i-1].lastWidgetIndex+=1,t.customReport.widgets[r].sizeFilledInPage=t.reportPagesDetails[i-1].sizeFilled,t.customReport.widgets[r].sizeLeftInPage=t.reportPagesDetails[i-1].sizeLeft,t.customReport.widgets[r].isLastWidgetInPage=!0,t.swapArrayElements(r,r-1),1==s.isLastWidgetInPage||t.reportPagesDetails[i].sizeFilled==s.sizeY){if("pageBreakWidget"==t.customReport.widgets[r+1].widgetType){t.customReport.widgets.splice(r+1,1),t.reportPagesDetails.splice(i,1);for(var c=r+1;c<t.customReport.widgets.length;c++)t.customReport.widgets[c].pageNumber-=1;for(var l=i;l<t.reportPagesDetails.length;l++)t.reportPagesDetails[l].firstWidgetIndex-=1,t.reportPagesDetails[l].lastWidgetIndex-=1}}else{var h=t.reportPagesDetails[i].lastWidgetIndex;t.reportPagesDetails[i].firstWidgetIndex+=1;var p=t.reportPagesDetails[i].firstWidgetIndex;t.reportPagesDetails[i].sizeLeft+=s.sizeY,t.reportPagesDetails[i].sizeFilled-=s.sizeY,t.customReport.widgets[p].isFirstWidgetInPage=!0,t.customReport.widgets[h].sizeFilledInPage=t.reportPagesDetails[i].sizeFilled,t.customReport.widgets[h].sizeLeftInPage=t.reportPagesDetails[i].sizeLeft}}else if(t.customReport.widgets[o].sizeY==s.sizeY){void 0!=t.customReport.widgets[o].isFirstWidgetInPage&&1==t.customReport.widgets[o].isFirstWidgetInPage||(t.customReport.widgets[r].isFirstWidgetInPage=!1),t.customReport.widgets[o].isFirstWidgetInPage=!0,t.customReport.widgets[o].isLastWidgetInPage=!1,1==s.isLastWidgetInPage&&(t.customReport.widgets[o].sizeFilledInPage=t.customReport.widgets[r].sizeFilledInPage||t.reportPagesDetails[i].sizeFilled,t.customReport.widgets[o].sizeLeftInPage=t.customReport.widgets[r].sizeLeftInPage||t.reportPagesDetails[i].sizeLeft,t.customReport.widgets[o].isLastWidgetInPage=!0),t.customReport.widgets[r].sizeFilledInPage=t.reportPagesDetails[i].sizeFilled,t.customReport.widgets[r].sizeLeftInPage=t.reportPagesDetails[i].sizeLeft,t.customReport.widgets[r].isLastWidgetInPage=!0,t.customReport.widgets[r].pageNumber-=1,t.customReport.widgets[o].pageNumber+=1;var d=t.customReport.widgets[r].row;t.customReport.widgets[r].row=t.customReport.widgets[o].row,t.swapArrayElements(r,o),e(function(){t.customReport.widgets[r-1].row=d-1,t.customReport.widgets[r].row=d},800)}else toastr.info("Sorry..! This widget can neither be pushed nor swapped at the moment")}else{1==s.isLastWidgetInPage&&(t.customReport.widgets[r-1].isLastWidgetInPage=!0,t.customReport.widgets[r-1].sizeFilledInPage=t.customReport.widgets[r].sizeFilledInPage||t.reportPagesDetails[i].sizeFilled,t.customReport.widgets[r-1].sizeLeftInPage=t.customReport.widgets[r].sizeLeftInPage||t.reportPagesDetails[i].sizeLeft,t.customReport.widgets[r].isLastWidgetInPage=!1),1==t.customReport.widgets[r-1].isFirstWidgetInPage&&(t.customReport.widgets[r].isFirstWidgetInPage=!0,t.customReport.widgets[r-1].isFirstWidgetInPage=!1);var d=t.customReport.widgets[r].row;t.customReport.widgets[r].sizeY==t.customReport.widgets[r-1].sizeY?(t.customReport.widgets[r].row=t.customReport.widgets[r-1].row,t.customReport.widgets[r-1].row=d):t.customReport.widgets[r].row=t.customReport.widgets[r-1].row,t.swapArrayElements(r,r-1)}},t.pullDownWidget=function(a,r){var s={};angular.copy(a,s);var r=r,i=s.pageNumber;if(1==s.isLastWidgetInPage){var o=t.reportPagesDetails[i+1].firstWidgetIndex;if(t.reportPagesDetails[i+1].sizeLeft>=s.sizeY){t.customReport.widgets[r].pageNumber+=1,t.customReport.widgets[r+1].row=t.customReport.widgets[r].row,t.customReport.widgets[r].isLastWidgetInPage=!1,t.customReport.widgets[r].isFirstWidgetInPage=!0,t.customReport.widgets[o].isFirstWidgetInPage=!1,t.reportPagesDetails[i+1].firstWidgetIndex-=1,t.swapArrayElements(r,r+1),t.reportPagesDetails[i+1].sizeLeft-=s.sizeY,t.reportPagesDetails[i+1].sizeFilled+=s.sizeY;var n=t.reportPagesDetails[i+1].lastWidgetIndex;if(t.customReport.widgets[n].sizeFilledInPage=t.reportPagesDetails[i+1].sizeFilled,t.customReport.widgets[n].sizeLeftInPage=t.reportPagesDetails[i+1].sizeLeft,1==s.isFirstWidgetInPage||t.reportPagesDetails[i].sizeFilled==s.sizeY){if("pageBreakWidget"==t.customReport.widgets[r].widgetType){t.customReport.widgets.splice(r,1),t.reportPagesDetails.splice(i,1);for(var c=r;c<t.customReport.widgets.length;c++)t.customReport.widgets[c].pageNumber-=1;for(var l=i;l<t.reportPagesDetails.length;l++)t.reportPagesDetails[l].firstWidgetIndex-=1,t.reportPagesDetails[l].lastWidgetIndex-=1}}else{t.reportPagesDetails[i].lastWidgetIndex-=1;var n=t.reportPagesDetails[i].lastWidgetIndex;t.reportPagesDetails[i].sizeLeft+=s.sizeY,t.reportPagesDetails[i].sizeFilled-=s.sizeY,t.customReport.widgets[n].isLastWidgetInPage=!0,t.customReport.widgets[n].sizeFilledInPage=t.reportPagesDetails[i].sizeFilled,t.customReport.widgets[n].sizeLeftInPage=t.reportPagesDetails[i].sizeLeft}}else if(t.customReport.widgets[o].sizeY==s.sizeY){void 0!=t.customReport.widgets[r].isFirstWidgetInPage&&1==t.customReport.widgets[r].isFirstWidgetInPage||(t.customReport.widgets[o].isFirstWidgetInPage=!1),t.customReport.widgets[r].isFirstWidgetInPage=!0,t.customReport.widgets[r].isLastWidgetInPage=!1,1==t.customReport.widgets[o].isLastWidgetInPage&&(t.customReport.widgets[r].sizeFilledInPage=t.customReport.widgets[o].sizeFilledInPage||t.reportPagesDetails[i+1].sizeFilled,t.customReport.widgets[r].sizeLeftInPage=t.customReport.widgets[o].sizeLeftInPage||t.reportPagesDetails[i+1].sizeLeft,t.customReport.widgets[r].isLastWidgetInPage=!0),t.customReport.widgets[o].sizeFilledInPage=t.reportPagesDetails[i].sizeFilled,t.customReport.widgets[o].sizeLeftInPage=t.reportPagesDetails[i].sizeLeft,t.customReport.widgets[o].isLastWidgetInPage=!0,t.customReport.widgets[r].pageNumber+=1,t.customReport.widgets[o].pageNumber-=1;var h=t.customReport.widgets[r].row;t.customReport.widgets[r].row=t.customReport.widgets[o].row,t.swapArrayElements(r,o),e(function(){t.customReport.widgets[r].row=h},800)}else toastr.info("Sorry..! This widget can neither be pulled nor swapped at the moment")}else{if(1==s.isFirstWidgetInPage&&(t.customReport.widgets[r+1].isFirstWidgetInPage=!0,t.customReport.widgets[r].isFirstWidgetInPage=!1),1==t.customReport.widgets[r+1].isLastWidgetInPage&&(t.customReport.widgets[r].isLastWidgetInPage=!0,t.customReport.widgets[r].sizeFilledInPage=t.customReport.widgets[r+1].sizeFilledInPage||t.reportPagesDetails[i].sizeFilled,t.customReport.widgets[r].sizeLeftInPage=t.customReport.widgets[r+1].sizeLeftInPage||t.reportPagesDetails[i].sizeLeft,t.customReport.widgets[r+1].isLastWidgetInPage=!1),t.customReport.widgets[r].sizeY==t.customReport.widgets[r+1].sizeY){var h=t.customReport.widgets[r+1].row;t.customReport.widgets[r+1].row=t.customReport.widgets[r].row,t.customReport.widgets[r].row=h}else{var h=t.customReport.widgets[r].row;t.customReport.widgets[r+1].row=h,t.customReport.widgets[r].row=h+t.customReport.widgets[r+1].sizeY}t.swapArrayElements(r,r+1)}}}function NavigationController(t,e,a,r,s){s.getReportBuilder=function(){a({method:"POST",url:"/api/v1/updateUserSubscription?buster="+new Date}).then(function(e){t.canAccessReportBuilder=e.data.response.reportBuilder},function(e){t.dashboard.dashboardName=null,swal({title:"",text:'<span style="sweetAlertFont">Something went wrong! Please reload the dashboard</span>',html:!0})})},s.getReportBuilder(),e.includes("app.reporting.dashboard"),t.stateValidation=function(r){switch(r){case"recommendedDashboard":a({method:"GET",url:"/api/v1/subscriptionLimits?requestType=dashboards"}).then(function(t){t.data.isExpired===!1?t.data.availableDashboards>0?e.go("app.reporting."+r):toastr.info("You have reached your Dashboards limit. Please upgrade to create more Dashboards"):toastr.info("Please renew!")},function(t){swal({title:"",text:"<span style='sweetAlertFont'>Something went wrong! Please try again!</span> .",html:!0})});break;case"chooseDashboardType":a({method:"GET",url:"/api/v1/subscriptionLimits?requestType=dashboards"}).then(function(t){t.data.isExpired===!1?t.data.availableDashboards>0?e.go("app.reporting."+r):toastr.info("You have reached your Dashboards limit. Please upgrade to create more Dashboards"):toastr.info("Please renew !")},function(t){swal({title:"",text:"<span style='sweetAlertFont'>Something went wrong! Please try again!</span> .",html:!0})});break;case"buildReports":t.canAccessReportBuilder?e.go("app.reporting."+r):swal({title:"",text:"Sorry! The Report builder feature is only available on the Agency Plan.",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"Upgrade",closeOnConfirm:!0},function(){e.go("app.reporting.upgrade")});break;case"insights":toastr.info("Coming Soon")}},t.addRecommendedDashboard=function(){a({method:"GET",url:"/api/v1/subscriptionLimits?requestType=dashboards"}).then(function(t){t.data.isExpired===!1?t.data.availableDashboards>0?e.go("app.reporting.dashboard.recommendedDashboard"):toastr.info("You have reached your Dashboards limit. Please upgrade to create more Dashboards"):toastr.info("Please renew!")},function(t){swal({title:"",text:"<span style='sweetAlertFont'>Something went wrong! Please try again!</span> .",html:!0})})},$(".insightsModalContent").on("click",function(t){$(".navbar").css("z-index","1"),$(".md-overlay").css("background","rgba(0,0,0,0.5)"),$("#insightsModalContent").addClass("md-show")}),$(".addRemoveModalContent").on("click",function(t){$(".navbar").css("z-index","1"),$(".md-overlay").css("background","rgba(0,0,0,0.5)"),$("#addRemoveModalContent").addClass("md-show")})}config.$inject=["$translateProvider"],pageTitle.$inject=["$rootScope","$timeout"],sideNavigation.$inject=["$timeout"],iboxTools.$inject=["$timeout"],minimalizaSidebar.$inject=["$timeout"],icheck.$inject=["$timeout"],chatSlimScroll.$inject=["$timeout"],fullScroll.$inject=["$timeout"],iboxToolsFullScreen.$inject=["$timeout"],slimScroll.$inject=["$timeout"],hcChart.$inject=["$timeout"],fileModel.$inject=["$parse"],MainCtrl.$inject=["$scope","$rootScope","$http","$timeout"],CustomWidgetController.$inject=["$scope","$uibModal"],customReportController.$inject=["$scope","$timeout","$rootScope","$http","$window","$state","$stateParams","createWidgets","$q"],NavigationController.$inject=["$scope","$state","$http","$stateParams","$rootScope"],function(t){t(["jquery"],function(t){return function(){function e(t,e,a){return g({type:w.error,iconClass:m().iconClasses.error,message:t,optionsOverride:a,title:e})}function a(e,a){return e||(e=m()),y=t("#"+e.containerId),y.length?y:(a&&(y=p(e)),y)}function r(t,e,a){return g({type:w.info,iconClass:m().iconClasses.info,message:t,optionsOverride:a,title:e})}function s(t){v=t}function i(t,e,a){return g({type:w.success,iconClass:m().iconClasses.success,message:t,optionsOverride:a,title:e})}function o(t,e,a){return g({type:w.warning,iconClass:m().iconClasses.warning,message:t,optionsOverride:a,title:e})}function n(t,e){var r=m();y||a(r),h(t,r,e)||l(r)}function c(e){var r=m();return y||a(r),e&&0===t(":focus",e).length?void f(e):void(y.children().length&&y.remove())}function l(e){for(var a=y.children(),r=a.length-1;r>=0;r--)h(t(a[r]),e)}function h(e,a,r){var s=!(!r||!r.force)&&r.force;return!(!e||!s&&0!==t(":focus",e).length)&&(e[a.hideMethod]({duration:a.hideDuration,easing:a.hideEasing,complete:function(){f(e)}}),!0)}function p(e){return y=t("<div/>").attr("id",e.containerId).addClass(e.positionClass),y.appendTo(t(e.target)),y}function d(){return{tapToDismiss:!0,toastClass:"toast",containerId:"toast-container",
debug:!1,showMethod:"fadeIn",showDuration:300,showEasing:"swing",onShown:void 0,hideMethod:"fadeOut",hideDuration:100,hideEasing:"swing",onHidden:void 0,closeMethod:!1,closeDuration:!1,closeEasing:!1,closeOnHover:!0,extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},iconClass:"toast-info",closeButton:!0,positionClass:"toast-top-right",timeOut:5e3,titleClass:"toast-title",messageClass:"toast-message",escapeHtml:!1,target:"body",closeHtml:'<button type="button">&times;</button>',closeClass:"toast-close-button",newestOnTop:!0,preventDuplicates:!1,progressBar:!1,progressClass:"toast-progress",rtl:!1}}function u(t){v&&v(t)}function g(e){function r(t){return null==t&&(t=""),t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function s(){c(),h(),p(),d(),g(),v(),l(),i()}function i(){var t="";switch(e.iconClass){case"toast-success":case"toast-info":t="polite";break;default:t="assertive"}R.attr("aria-live",t)}function o(){F.closeOnHover&&R.hover(C,x),!F.onclick&&F.tapToDismiss&&R.click(T),F.closeButton&&S&&S.click(function(t){t.stopPropagation?t.stopPropagation():void 0!==t.cancelBubble&&t.cancelBubble!==!0&&(t.cancelBubble=!0),F.onCloseClick&&F.onCloseClick(t),T(!0)}),F.onclick&&R.click(function(t){F.onclick(t),T()})}function n(){R.hide(),R[F.showMethod]({duration:F.showDuration,easing:F.showEasing,complete:F.onShown}),F.timeOut>0&&(N=setTimeout(T,F.timeOut),O.maxHideTime=parseFloat(F.timeOut),O.hideEta=(new Date).getTime()+O.maxHideTime,F.progressBar&&(O.intervalId=setInterval(k,10)))}function c(){e.iconClass&&R.addClass(F.toastClass).addClass(P)}function l(){F.newestOnTop?y.prepend(R):y.append(R)}function h(){if(e.title){var t=e.title;F.escapeHtml&&(t=r(e.title)),A.append(t).addClass(F.titleClass),R.append(A)}}function p(){if(e.message){var t=e.message;F.escapeHtml&&(t=r(e.message)),I.append(t).addClass(F.messageClass),R.append(I)}}function d(){F.closeButton&&(S.addClass(F.closeClass).attr("role","button"),R.prepend(S))}function g(){F.progressBar&&(W.addClass(F.progressClass),R.prepend(W))}function v(){F.rtl&&R.addClass("rtl")}function w(t,e){if(t.preventDuplicates){if(e.message===D)return!0;D=e.message}return!1}function T(e){var a=e&&F.closeMethod!==!1?F.closeMethod:F.hideMethod,r=e&&F.closeDuration!==!1?F.closeDuration:F.hideDuration,s=e&&F.closeEasing!==!1?F.closeEasing:F.hideEasing;if(!t(":focus",R).length||e)return clearTimeout(O.intervalId),R[a]({duration:r,easing:s,complete:function(){f(R),clearTimeout(N),F.onHidden&&"hidden"!==E.state&&F.onHidden(),E.state="hidden",E.endTime=new Date,u(E)}})}function x(){(F.timeOut>0||F.extendedTimeOut>0)&&(N=setTimeout(T,F.extendedTimeOut),O.maxHideTime=parseFloat(F.extendedTimeOut),O.hideEta=(new Date).getTime()+O.maxHideTime)}function C(){clearTimeout(N),O.hideEta=0,R.stop(!0,!0)[F.showMethod]({duration:F.showDuration,easing:F.showEasing})}function k(){var t=(O.hideEta-(new Date).getTime())/O.maxHideTime*100;W.width(t+"%")}var F=m(),P=e.iconClass||F.iconClass;if("undefined"!=typeof e.optionsOverride&&(F=t.extend(F,e.optionsOverride),P=e.optionsOverride.iconClass||P),!w(F,e)){b++,y=a(F,!0);var N=null,R=t("<div/>"),A=t("<div/>"),I=t("<div/>"),W=t("<div/>"),S=t(F.closeHtml),O={intervalId:null,hideEta:null,maxHideTime:null},E={toastId:b,state:"visible",startTime:new Date,options:F,map:e};return s(),n(),o(),u(E),F.debug&&console&&console.log(E),R}}function m(){return t.extend({},d(),T.options)}function f(t){y||(y=a()),t.is(":visible")||(t.remove(),t=null,0===y.children().length&&(y.remove(),D=void 0))}var y,v,D,b=0,w={error:"error",info:"info",success:"success",warning:"warning"},T={clear:n,remove:c,error:e,getContainer:a,info:r,options:{},subscribe:s,success:i,version:"2.1.3",warning:o};return T}()})}("function"==typeof define&&define.amd?define:function(t,e){"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):window.toastr=e(window.jQuery)}),function(){angular.module("inspinia",["ui.router","oc.lazyLoad","ui.bootstrap","pascalprecht.translate","ngIdle","ngSanitize","ngAnimate","ui.bootstrap.tpls","gridster","xeditable"])}(),function(t){"use strict";function e(t){return new RegExp("(^|\\s+)"+t+"(\\s+|$)")}function a(t,e){var a=r(t,e)?i:s;a(t,e)}var r,s,i;"classList"in document.documentElement?(r=function(t,e){return t.classList.contains(e)},s=function(t,e){t.classList.add(e)},i=function(t,e){t.classList.remove(e)}):(r=function(t,a){return e(a).test(t.className)},s=function(t,e){r(t,e)||(t.className=t.className+" "+e)},i=function(t,a){t.className=t.className.replace(e(a)," ")});var o={hasClass:r,addClass:s,removeClass:i,toggleClass:a,has:r,add:s,remove:i,toggle:a};"function"==typeof define&&define.amd?define(o):t.classie=o}(window);var ModalEffects=function(){function t(){var t=document.querySelector(".md-overlay");[].slice.call(document.querySelectorAll(".md-trigger")).forEach(function(e,a){function r(t){classie.remove(i,"md-show"),t&&classie.remove(document.documentElement,"md-perspective")}function s(){r(classie.has(e,"md-setperspective"))}var i=document.querySelector("#"+e.getAttribute("data-modal")),o=i.querySelector(".md-close");e.addEventListener("click",function(a){classie.add(i,"md-show"),t.removeEventListener("click",s),t.addEventListener("click",s),classie.has(e,"md-setperspective")&&setTimeout(function(){classie.add(document.documentElement,"md-perspective")},25)}),o.addEventListener("click",function(t){t.stopPropagation(),s()})})}t()}();angular.module("inspinia").config(config),angular.module("inspinia").directive("pageTitle",pageTitle).directive("sideNavigation",sideNavigation).directive("iboxTools",iboxTools).directive("minimalizaSidebar",minimalizaSidebar).directive("vectorMap",vectorMap).directive("sparkline",sparkline).directive("icheck",icheck).directive("ionRangeSlider",ionRangeSlider).directive("dropZone",dropZone).directive("responsiveVideo",responsiveVideo).directive("chatSlimScroll",chatSlimScroll).directive("customValid",customValid).directive("fullScroll",fullScroll).directive("closeOffCanvas",closeOffCanvas).directive("clockPicker",clockPicker).directive("landingScrollspy",landingScrollspy).directive("fitHeight",fitHeight).directive("iboxToolsFullScreen",iboxToolsFullScreen).directive("slimScroll",slimScroll).directive("channelDiv",channelDiv).directive("chartHeight",chartHeight).directive("sizeWatcher",sizeWatcher).directive("expSizeWatcher",expSizeWatcher).directive("hcChart",hcChart).directive("fileModel",fileModel);var showMetricApp=angular.module("inspinia");showMetricApp.service("createWidgets",["$http","$q",function(t,e){this.widgetHandler=function(a,r,s){function i(a,r){function s(a,r){var s=e.defer();if(r)var i={method:"GET",url:"/api/v1/widget/"+a+"?isPublic="+r,timeout:f.promise,cancel:f};else var i={method:"GET",url:"/api/v1/widget/"+a,timeout:f.promise,cancel:f};return t(i).then(function(t){s.resolve(t.data[0])},function(t){s.reject(t)}),s.promise}var i=e.defer(),o=[];for(var n in a.widgets){var c=a.widgets[n].widgetType;"basic"!=c&&"adv"!=c&&"fusion"!=c&&"custom"!=c||o.push(s(a.widgets[n].widgetId,r))}return e.all(o).then(function(t){i.resolve(t)},function(t){i.reject(t)}),i.promise}function o(a,r){var s=e.defer(),i=[],o=0;return t({method:"POST",url:"/api/v1/customWidget/data/"+a._id,data:{startDate:r.startDate,endDate:r.endDate},timeout:f.promise,cancel:f}).then(function(t){o++;for(var e in t.data)t.data[e].widgetId==a._id&&i.push({_id:t.data[e]._id,chartName:"Custom Data "+o,chartType:t.data[e].chartType,widgetId:t.data[e].widgetId,chartData:t.data[e].data,intervalType:t.data[e].intervalType,metricsCount:t.data[e].metricsCount});a.charts=i,s.resolve(a)},function(t){s.reject(t)}),s.promise}function n(t){var a=e.defer(),r=[];for(var s in t.charts){var i=[];if("line"==t.charts[s].chartType||"bar"==t.charts[s].chartType||"column"==t.charts[s].chartType||"area"==t.charts[s].chartType)for(var o in t.charts[s].chartData){var n=0;for(var c in r)if(r[c].key==t.charts[s].chartData[o].name){i=r[c].values;var l={x:moment(t.charts[s].chartData[o].date),y:t.charts[s].chartData[o].values};i.push(l),i.sort(function(t,e){var a=new Date(t.x),r=new Date(e.x);return a-r}),r[c].values=i,n=1}if(1!=n){i=[];var l={x:moment(t.charts[s].chartData[o].date),y:t.charts[s].chartData[o].values};i.push(l),i.sort(function(t,e){var a=new Date(t.x),r=new Date(e.x);return a-r}),r.push({type:t.charts[s].chartType,values:i,key:t.charts[s].chartData[o].name,color:null})}}else if("pie"==t.charts[s].chartType)for(var o in t.charts[s].chartData){var n=0;for(c in r){var h=0;r[c].key==t.charts[s].chartData[o].name&&(h=parseInt(r[c].y),r[c].y=parseInt(h)+parseInt(t.charts[s].chartData[o].values),n=1)}1!=n&&r.push({type:t.charts[s].chartType,y:parseInt(t.charts[s].chartData[o].values),key:t.charts[s].chartData[o].name,color:null})}}return a.resolve(r),a.promise}function c(t,a){var r,i=e.defer();return r=l(t,a,s),r.then(function(e){t.charts=e,i.resolve(t)},function(t){i.reject(t)}),i.promise}function l(a,r,s){var i=e.defer(),o=[];if(s)var n={method:"POST",url:"/api/v1/widgets/data/"+a._id,data:{startDate:r.startDate,endDate:r.endDate,params:"public"}};else var n={method:"POST",url:"/api/v1/widgets/data/"+a._id,data:{startDate:r.startDate,endDate:r.endDate,widId:a._id},timeout:f.promise,cancel:f};return t(n).then(function(t){for(var e in a.charts)for(var r in t.data)String(a.charts[e].metrics[0].metricId)===String(t.data[r].metricId)&&o.push({channelId:a.charts[e].channelId,chartType:"undefined"!=typeof a.charts[e].metrics[0].chartType?a.charts[e].metrics[0].chartType:"",chartSubType:void 0!=a.charts[e].metrics[0].subChartType?a.charts[e].metrics[0].subChartType:"",chartName:a.charts[e].name,chartColour:a.charts[e].metrics[0].color,chartOptions:a.charts[e].metrics[0].chartOptions,chartMetricId:t.data[r].metricId,metricDetails:t.data[r].metricDetails,chartObjectId:t.data[r].objectId,chartObjectTypeId:a.charts[e].metrics[0].objectTypeId,chartObjectName:a.charts[e].objectName,chartData:t.data[r].data});i.resolve(o)},function(t){y.widgets.length>0?(k=y.widgets.map(function(t){return t._id}).indexOf(t._id),k!==-1&&(t.data.id=y._id),i.reject(t)):i.reject(t)}),i.promise}function h(t,a){function r(t,e){return e>t?e-t:t-e}function r(t,e){return e>t?e-t:t-e}function s(t){for(var e=0,a=0;a<t.length;a++)e+=parseFloat(t[a].value);return e}function i(t){for(var e=0,a=0;a<t.length;a++)e+=parseFloat(t[a].value);return e}function o(t){for(var e=0,a=0;a<t.length;a++)e+=parseFloat(t[a].value);return e}function s(t){for(var e=0,a=0;a<t.length;a++)e+=parseFloat(t[a].value);return e}function i(t){for(var e=0,a=0;a<t.length;a++)e+=parseFloat(t[a].value);return e}function o(t){for(var e=0,a=0;a<t.length;a++)e+=parseFloat(t[a].value);return e}function s(t){for(var e=0,a=0;a<t.length;a++)e+=parseFloat(t[a].value);return e}var n=e.defer(),c=[],l={Facebook:"FB",Twitter:"TW","Google Analytics":"GA","Facebook Ads":"FBAds","Google Adwords":"GAds",Instagram:"In",Pinterest:"Pi",Mailchimp:"Mc",Vimeo:"Vi",Linkedin:"Lin",Youtube:"YT",Moz:"Moz","Google Sheets":"GSheet",Aweber:"AW"},h=-1,p=0;if(t.charts.length>0){for(var u in t.charts){var g=t.charts[u].chartType;switch(g){case"bounceRateArea":var m=[];if("object"==typeof t.charts[u].chartData[0].total)for(var f=0;f<t.charts[u].chartData.length;f++){var y=parseFloat(t.charts[u].chartData[f].total[0].bounces),v=parseFloat(t.charts[u].chartData[f].total[0].sessions);if(0===v)var D=y;else var D=(y/v*100).toFixed(2);m.push({x:moment(t.charts[u].chartData[f].date),y:D,bounces:y,sessions:Math.round(100*v)/100})}t.charts[u].chartData=m;break;case"costPerClick":case"costPerThosuandImpressions":case"clickThroughRate":case"ConversionRate":case"costPerConversion":var m=[];if("costPerClick"==g)var b="Cost",w="Clicks";else if("costPerThosuandImpressions"==g)var b="Cost",w="Impressions";else if("clickThroughRate"==g)var b="Clicks",w="Impressions";else if("ConversionRate"==g)var b="Conversions",w="Clicks";else if("costPerConversion"==g)var b="Cost",w="Conversions";for(var f=0;f<t.charts[u].chartData.length;f++){var T=0,x=0;if("object"==typeof t.charts[u].chartData[f].total[0]&&(T="Cost"===b?parseFloat(t.charts[u].chartData[f].total[0][b]/1e6).toFixed(2):parseFloat(t.charts[u].chartData[f].total[0][b]),x=parseFloat(t.charts[u].chartData[f].total[0][w])),0===T)var C=T;else if("costPerThosuandImpressions"==g)var C=(T/x*1e3).toFixed(2);else if("clickThroughRate"==g||"clickThroughRate"==g||"costPerConversion"==g)var C="Infinity"===(T/x*100).toFixed(2)?0:(T/x*100).toFixed(2);else var C=(T/x).toFixed(2);m.push({x:moment(t.charts[u].chartData[f].date),y:C,dividend:T,divisor:x})}t.charts[u].chartData=m;break;case"line":case"area":case"bar":case"column":case"stackcolumn":case"mozoverview":case"negativeBar":if("object"==typeof t.charts[u].chartData[0].total){var k,F=t.charts[u].chartCode;for(at in t.charts[u].metricDetails.objectTypes)t.charts[u].metricDetails.objectTypes[at].objectTypeId==t.charts[u].chartObjectTypeId&&(k=t.charts[u].metricDetails.objectTypes[at].meta.endpoint,t.charts[u].metricDetails.objectTypes[at].meta.endpoint=void 0!=t.charts[u].metricDetails.objectTypes[at].meta.endpointDisplay?t.charts[u].metricDetails.objectTypes[at].meta.endpointDisplay:t.charts[u].metricDetails.objectTypes[at].meta.endpoint);var P=[];if(0!=k.length)for(sr in k){var N=k[sr],R=[];for(U in t.charts[u].chartData){var A,I=0;if(null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length))for(var W in t.charts[u].chartData[U].total)if(W.search("/")>-1){A=W.split("/");for(var S in A)A[S]==N&&(I+=parseFloat(t.charts[u].chartData[U].total[W]))}else W==N&&(I=t.charts[u].chartData[U].total[N]);R.push({x:moment(t.charts[u].chartData[U].date),y:Math.round(100*I)/100})}P.push(R)}else{var R=[];if("fbTopReferringDomain"===t.charts[u].chartSubType){for(var O=[],E=0;E<t.charts[u].chartData.length;E++)if("object"==typeof t.charts[u].chartData[E].total)for(var z in t.charts[u].chartData[E].total)O.push({domain:z,value:t.charts[u].chartData[E].total[z]});var L=_.groupBy(O,"domain");for(var M in L){for(var j=M,H=0,f=0;f<L[M].length;f++)H+=parseFloat(L[M][f].value);R.push({x:j,y:isNaN(H)?0:H})}}else for(U in t.charts[u].chartData){var B,A,I=0,Y=t.charts[u].chartData[U].total;if(null!=t.charts[u].chartData[U].total&&0!=Object.keys(t.charts[u].chartData[U].total).length){for(var W in t.charts[u].chartData[U].total){if(W.search("/")>-1){A=W.split("/");for(var S in A)I+=parseFloat(t.charts[u].chartData[U].total[W]),B=W}else I=t.charts[u].chartData[U].total[N];B=W}R.push({x:B,y:Math.round(100*I)/100})}}P.push(R)}var V=[];if("userinteractions_clicks"==F&&"Facebook"==t.channelName){for(var f=0;f<P.length;f++)for(var q=0;q<P[f].length;q++)V[q]||(V[q]={x:0,y:0}),V[q].x=P[0][q].x,V[q].y+=P[f][q].y;P=V}t.charts[u].chartData=P}else{var R=[];for(var U in t.charts[u].chartData)R.push({x:moment(t.charts[u].chartData[U].date),y:null!=t.charts[u].chartData[U].total?Math.round(100*t.charts[u].chartData[U].total)/100:0});t.charts[u].chartData=R}if("fbTopReferringDomain"===t.charts[u].chartSubType){var G=_.sortBy(R,"y").reverse(),X=[];if(R.length<10)var J=R.length-1;else var J=9;for(var E=0;E<=J;E++)X.push({x:G[E].x,y:G[E].y});t.charts[u].chartData=X}break;case"reachVsImpressions":case"engagedUsersReach":if("Total Impressions"==t.charts[u].chartName||"Engaged Users"==t.charts[u].chartName){for(var K=[],Z=[],f=0;f<t.charts.length;f++)"Total Impressions"!=t.charts[f].chartName&&"Engaged Users"!=t.charts[f].chartName||(K=t.charts[f].chartData),"Total Reach"==t.charts[f].chartName&&(Z=t.charts[f].chartData);var Q=[];for(var tt in K){var et=K[tt].total/Z[tt].total*100;!isNaN(et)&&isFinite(et)||(et=0),Q.push({x:moment(K[tt].date),y:parseFloat(et).toFixed(2),imp:K[tt].total,rea:Z[tt].total})}t.charts[u].chartData=Q}else{var R=[];for(var U in t.charts[u].chartData)R.push({x:moment(t.charts[u].chartData[U].date),y:null!=t.charts[u].chartData[U].total?t.charts[u].chartData[U].total:0});t.charts[u].chartData=R}break;case"trafficSourcesBrkdwnLine":if("object"==typeof t.charts[u].chartData[0].total){var k;for(at in t.charts[u].metricDetails.objectTypes)t.charts[u].metricDetails.objectTypes[at].objectTypeId==t.charts[u].chartObjectTypeId&&(k=t.charts[u].metricDetails.objectTypes[at].meta.endpoint);var P=[];for(U in t.charts[u].chartData){var A,I=0;if(null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length))for(var W in t.charts[u].chartData[U].total)t.charts[u].chartData[U].total["social/Yes"]="undefined"!=typeof t.charts[u].chartData[U].total["social/Yes"]?Number(t.charts[u].chartData[U].total["social/Yes"]):0,W.search("/")>-1&&(A=W.split("/"),"Yes"==A[1]&&(t.charts[u].chartData[U].total["social/Yes"]+=Number(t.charts[u].chartData[U].total[W]),t.charts[u].chartData[U].total[W]=0))}for(sr in k){var N=k[sr],R=[];for(U in t.charts[u].chartData){var A,I=0;if(null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length))for(var W in t.charts[u].chartData[U].total)if(W.search("/")>-1){A=W.split("/");for(var S in A)A[S]==N&&(I+=parseFloat(t.charts[u].chartData[U].total[W]))}else W==N&&(I=t.charts[u].chartData[U].total[N]);R.push({x:moment(t.charts[u].chartData[U].date),y:Math.round(100*I)/100})}P.push(R)}t.charts[u].chartData=P}else{var R=[];for(var U in t.charts[u].chartData)R.push({x:moment(t.charts[u].chartData[U].date),y:null!=t.charts[u].chartData[U].total?Math.round(100*t.charts[u].chartData[U].total)/100:0});t.charts[u].chartData=R}break;case"pie":if("object"==typeof t.charts[u].chartData[0].total){var k=[];for(var at in t.charts[u].metricDetails.objectTypes)t.charts[u].metricDetails.objectTypes[at].objectTypeId==t.charts[u].chartObjectTypeId&&(k=t.charts[u].metricDetails.objectTypes[at].meta.endpoint);var P=[];for(sr in k){var N=k[sr];R=[];var I=0;for(U in t.charts[u].chartData)if(null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length))for(var W in t.charts[u].chartData[U].total)if(W.search("/")>-1){A=W.split("/");for(var S in A)A[S]==N&&(I+=parseFloat(t.charts[u].chartData[U].total[W]))}else W==N&&(I+=parseFloat(t.charts[u].chartData[U].total[N]));R.push({y:parseFloat(I).toFixed(2)%Math.floor(parseFloat(I).toFixed(2))>0?parseFloat(I).toFixed(2):parseFloat(I).toFixed(2)>1?parseInt(I):parseFloat(I)>0?parseFloat(I).toFixed(2):parseInt(I)}),P.push(R)}t.charts[u].chartData=P}else{var I=0;for(U in t.charts[u].chartData)I+=parseFloat(t.charts[u].chartData[U].total);R.push({y:parseFloat(I).toFixed(2)%Math.floor(parseFloat(I).toFixed(2))>0?parseFloat(I).toFixed(2):parseFloat(I).toFixed(2)>1?parseInt(I):parseFloat(I)>0?parseFloat(I).toFixed(2):parseInt(I)}),t.charts[u].chartData=R}break;case"trafficSourcesBrkdwnPie":if("object"==typeof t.charts[u].chartData[0].total){var k=[];for(at in t.charts[u].metricDetails.objectTypes)t.charts[u].metricDetails.objectTypes[at].objectTypeId==t.charts[u].chartObjectTypeId&&(k=t.charts[u].metricDetails.objectTypes[at].meta.endpoint);var P=[];for(U in t.charts[u].chartData){var A,I=0;if(null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length))for(var W in t.charts[u].chartData[U].total)t.charts[u].chartData[U].total["social/Yes"]="undefined"!=typeof t.charts[u].chartData[U].total["social/Yes"]?Number(t.charts[u].chartData[U].total["social/Yes"]):0,W.search("/")>-1&&(A=W.split("/"),"Yes"==A[1]&&(t.charts[u].chartData[U].total["social/Yes"]+=Number(t.charts[u].chartData[U].total[W]),t.charts[u].chartData[U].total[W]=0))}for(sr in k){var N=k[sr];R=[];var I=0;for(U in t.charts[u].chartData)if(null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length))for(var W in t.charts[u].chartData[U].total)if(W.search("/")>-1){A=W.split("/");for(var S in A)A[S]==N&&(I+=parseFloat(t.charts[u].chartData[U].total[W]))}else W==N&&(I+=t.charts[u].chartData[U].total[N]);R.push({y:Math.round(100*I)/100}),P.push(R)}t.charts[u].chartData=P}else{var I=0;for(U in t.charts[u].chartData)I+=parseInt(t.charts[u].chartData[U].total);R.push({y:Math.round(100*I)/100}),t.charts[u].chartData=R}break;case"instagramPosts":if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){var rt="images",st="thumbnail",it="likes",ot="comments",H="count",nt="caption",ct="text",lt="link",ht="url",P=[];for(U in t.charts[u].chartData){var R={date:moment(t.charts[u].chartData[U].date).format("DD-MMM-YYYY"),image:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total[rt]&&null!=t.charts[u].chartData[U].total[rt][st]&&"undefined"!=typeof t.charts[u].chartData[U].total[rt][st][ht]?t.charts[u].chartData[U].total[rt][st][ht]:"",postComment:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total[nt]&&"undefined"!=typeof t.charts[u].chartData[U].total[nt][ct]?t.charts[u].chartData[U].total[nt][ct]:"",likes:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total[it]&&"undefined"!=typeof t.charts[u].chartData[U].total[it][H]?t.charts[u].chartData[U].total[it][H]:0,comments:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total[ot]&&"undefined"!=typeof t.charts[u].chartData[U].total[ot][H]?t.charts[u].chartData[U].total[ot][H]:0,links:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&"undefined"!=typeof t.charts[u].chartData[U].total[lt]?t.charts[u].chartData[U].total[lt]:""};P.push(R)}t.charts[u].chartData=P}break;case"instagramEngagements":var pt=t.charts[u].chartSubType;if("instagramPostFrequency"===pt||"instagramPostTypes"===pt||"instagramPostEngagement"===pt){var dt=0,it="likes",ot="comments",ut=[];if("undefined"!=typeof t.charts[u].chartData[0])for(var f=0;f<t.charts[u].chartData.length;f++){dt++;var gt=t.charts[u].chartData[f].total[it].count,mt=t.charts[u].chartData[f].total[ot].count,ft=gt+mt,M=t.charts[u].chartData[f].total.type;ut.push({type:M,engagement:ft})}for(var yt={},vt={},E=0;E<ut.length;E++){if(yt.hasOwnProperty(ut[E].type)){var M=ut[E].type;yt[M]+=1}else{var M=ut[E].type;yt[M]=1}if(vt.hasOwnProperty(ut[E].type)){var z=ut[E].type;vt[z]+=ut[E].engagement}else{var z=ut[E].type;vt[z]=ut[E].engagement}}}"instagramPostFrequency"===pt?t.charts[u].chartData=dt:"instagramPostEngagement"===pt?t.charts[u].chartData=vt:"instagramPostTypes"===pt&&(t.charts[u].chartData=yt);break;case"highEngagementTweets":if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){var it="favorite_count",Dt="retweet_count",ct="text",lt="expanded_url",P=[];for(U in t.charts[u].chartData){var R={date:moment(new Date(t.charts[u].chartData[U].date)).format("DD-MMM-YYYY"),likes:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&"undefined"!=typeof t.charts[u].chartData[U].total[it]?t.charts[u].chartData[U].total[it]:0,reTweet:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&"undefined"!=typeof t.charts[u].chartData[U].total[Dt]?t.charts[u].chartData[U].total[Dt]:0,postComment:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&"undefined"!=typeof t.charts[u].chartData[U].total[ct]?t.charts[u].chartData[U].total[ct]:0,links:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&"undefined"!=typeof t.charts[u].chartData[U].total.entities?t.charts[u].chartData[U].total.entities:0};P.push(R)}t.charts[u].chartData=P}break;case"highestEngagementLinkedIn":if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){var it="likes",bt="clicks",wt="impressions",Tt="shares",ot="comments",ct="text",ht="url",P=[];for(U in t.charts[u].chartData){var R={date:moment(t.charts[u].chartData[U].date).format("DD-MMM-YYYY"),link:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total[ht]&&"undefined"!=typeof t.charts[u].chartData[U].total[ht]?t.charts[u].chartData[U].total[ht]:"",postComment:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total[ct]&&"undefined"!=typeof t.charts[u].chartData[U].total[ct]?t.charts[u].chartData[U].total[ct]:"",impressions:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total[wt]&&"undefined"!=typeof t.charts[u].chartData[U].total[wt]?t.charts[u].chartData[U].total[wt]:0,shares:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total[Tt]&&"undefined"!=typeof t.charts[u].chartData[U].total[Tt]?t.charts[u].chartData[U].total[Tt]:0,likes:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total[it]&&"undefined"!=typeof t.charts[u].chartData[U].total[it]?t.charts[u].chartData[U].total[it]:0,comments:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total[ot]&&"undefined"!=typeof t.charts[u].chartData[U].total[ot]?t.charts[u].chartData[U].total[ot]:0,clicks:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total[bt]&&"undefined"!=typeof t.charts[u].chartData[U].total[bt]?t.charts[u].chartData[U].total[bt]:0};P.push(R)}t.charts[u].chartData=P}break;case"gaTopPagesByVisit":;if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){for(var xt=[],E=0;E<t.charts[u].chartData.length;E++){var Ct=$.map(t.charts[u].chartData[E].total,function(t,e){return[t]});xt=xt.concat(Ct)}var kt="pageTitle",P=[],L=_.groupBy(xt,"pagePath");for(var M in L){for(var Ft=M,v=0,Pt=0,Nt=0,Rt=0,y=0,f=0;f<L[M].length;f++)v+=parseFloat(L[M][f].sessions),Pt+=parseFloat(L[M][f].pageviews),y+=parseFloat(L[M][f].bounces),Rt+=parseFloat(L[M][f].exits),Nt+=parseFloat(L[M][f].timeOnPage);var At=r(Pt,Rt);if(0===v)var D=y;else var D=(y/v*100).toFixed(2);if(0===At)var It=Nt;else var It=Nt/At;It=Math.ceil(It);var Wt=new Date(null);Wt.setSeconds(It),It=Wt.toISOString().substr(11,8);var Ft={bouncesRate:y,pagePath:Ft,sessions:v,pageTitle:L[M][0][kt],bouncesRate:D,avgTimeOnpage:It,pageviews:Pt};P.push(Ft)}P.sort(function(t,e){return parseFloat(t.pageviews)-parseFloat(e.pageviews)}),P.reverse(),t.charts[u].chartData=P}break;case"gaPageContentEfficiencyTable":;if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){for(var xt=[],E=0;E<t.charts[u].chartData.length;E++){var Ct=$.map(t.charts[u].chartData[E].total,function(t,e){return[t]});xt=xt.concat(Ct)}var kt="pageTitle",P=[],L=_.groupBy(xt,"pagePath");for(var M in L){for(var Ft=M,St=0,Pt=0,Ot=0,Et=0,Nt=0,Rt=0,y=0,v=0,zt=0,Lt=0,f=0;f<L[M].length;f++){St+=parseFloat(L[M][f].uniquePageviews),v+=parseFloat(L[M][f].sessions),Pt+=parseFloat(L[M][f].pageviews),y+=parseFloat(L[M][f].bounces),Rt+=parseFloat(L[M][f].exits),Nt+=parseFloat(L[M][f].timeOnPage),Lt+=L[M][f].pageviews*L[M][f].entranceRate,Ot+=parseFloat(L[M][f].pageValue);var kt=L[M][f].pageTitle}var At=r(Pt,Rt);if(0===v)var D=y;else var D=(y/v*100).toFixed(2);if(0===At)var It=Nt;else var It=Nt/At;zt=Lt/Pt;var Ft={uniquePageviews:St,sessions:v,pageviews:Pt,pagePath:Ft,avgTimeOnPage:It,pageTitle:kt,entranceRate:zt.toFixed(2),pageviews:Pt,pageValue:Ot,bounceRate:D},Wt=new Date(null);Wt.setSeconds(Ft.avgTimeOnPage),Ft.avgTimeOnPage=Wt.toISOString().substr(11,8),P.push(Ft)}P.sort(function(t,e){return parseFloat(t.pageviews)-parseFloat(e.pageviews)}),P.reverse(),t.charts[u].chartData=P}break;case"gaPageTechnicalEfficiencyTable":;if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){for(var xt=[],E=0;E<t.charts[u].chartData.length;E++){var Ct=$.map(t.charts[u].chartData[E].total,function(t,e){return[t]});xt=xt.concat(Ct)}var kt="pageTitle",P=[],L=_.groupBy(xt,"pagePath");for(var M in L){for(var Ft=M,Pt=0,Mt=0,jt=0,Et=0,v=0,y=0,Ht=0,f=0;f<L[M].length;f++){Ht+=parseFloat(L[M][f].pageLoadTime),v+=parseFloat(L[M][f].sessions),y+=parseFloat(L[M][f].bounces),Pt+=parseFloat(L[M][f].pageviews),jt+=parseFloat(L[M][f].pageLoadSample),Et+=parseFloat(L[M][f].bounceRate);var kt=L[M][f].pageTitle}var Mt=(Ht/jt/1e3).toFixed(2);if(isNaN(Mt)&&(Mt=0),0===v)var D=y;else var D=y/v*100;Mt=Math.ceil(Mt);var Ft={pageviews:Pt,sessions:v,pagePath:Ft,pageTitle:kt,avgPageLoadTime:Mt.toFixed(2),pageLoadSample:jt,pageviews:Pt,bounceRate:D.toFixed(2)};P.push(Ft)}P.sort(function(t,e){return parseFloat(t.pageviews)-parseFloat(e.pageviews)}),P.reverse(),t.charts[u].chartData=P}break;case"gaVisitorAcquisitionEfficiencyAnalysisTable":;if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){for(var xt=[],E=0;E<t.charts[u].chartData.length;E++){var Ct=$.map(t.charts[u].chartData[E].total,function(t,e){return[t]});xt=xt.concat(Ct)}var P=[],L=_.groupBy(xt,"sourceMedium");for(var M in L){for(var Bt=M,v=0,Yt=0,$t=0,_t=0,jt=0,Vt=0,f=0;f<L[M].length;f++)v+=parseFloat(L[M][f].sessions),Yt+=parseFloat(L[M][f].users),$t+=parseFloat(L[M][f].newUsers),_t+=parseFloat(L[M][f].goalConversionRateAll),jt+=parseFloat(L[M][f].pageLoadSample),Vt+=parseFloat(L[M][f].goalValuePerSession),Et+=parseFloat(L[M][f].bounceRate);var Ft={sourceMedium:Bt,sessions:v,users:Yt,newUsers:$t,goalValuePerSession:Vt,goalConversionRateAll:_t.toFixed(2)};P.push(Ft)}P.sort(function(t,e){return parseFloat(t.sessions)-parseFloat(e.sessions)}),P.reverse(),t.charts[u].chartData=P}break;case"pageContentEfficiency":;if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){for(var xt=[],E=0;E<t.charts[u].chartData.length;E++){var qt=$.isEmptyObject(t.charts[u].chartData[E].total);if(1!=qt){var Ct=$.map(t.charts[u].chartData[E].total,function(t,e){return[t]});xt=xt.concat(Ct)}}var kt="pageTitle",P=[],L=_.groupBy(xt,"pagePath");for(var M in L){for(var D,St=0,Pt=0,y=0,v=0,zt=0,Lt=0,f=0;f<L[M].length;f++)St+=parseFloat(L[M][f].uniquePageviews),v+=parseFloat(L[M][f].sessions),Pt+=parseFloat(L[M][f].pageviews),y+=parseFloat(L[M][f].bounces),Lt+=L[M][f].pageviews*L[M][f].entranceRate,kt=L[M][f].pageTitle;D=0===v?y:(y/v*100).toFixed(2),zt=Lt/Pt;var Ft={bounceRate:D,pageTitle:kt,uniquePageviews:St.toFixed(2),pageviews:Pt,entranceRate:zt.toFixed(2)};P.push(Ft)}P.sort(function(t,e){return parseFloat(t.uniquePageviews)-parseFloat(e.uniquePageviews)}),P.reverse();var Ut=[];if(P.length>10)for(var f=0;f<10;f++)Ut.push(P[f]);else for(var f=0;f<P.length;f++)Ut.push(P[f]);t.charts[u].chartData=Ut}break;case"gaSocialMediaOverview":;if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){for(var xt=[],E=0;E<t.charts[u].chartData.length;E++){var Ct=$.map(t.charts[u].chartData[E].total,function(t,e){return[t]});xt=xt.concat(Ct)}var P=[];if("Time spent on site from various sources"==String(t.charts[u].chartName)){for(var E=0;E<xt.length;E++)"Yes"===xt[E].hasSocialSourceReferral&&(xt[E].medium="social");var L=_.groupBy(xt,"medium")}else var L=_.groupBy(xt,"socialNetwork");for(var M in L){for(var Gt=M,Pt=0,v=0,Rt=0,Nt=0,f=0;f<L[M].length;f++)v+=parseFloat(L[M][f].sessions),Pt+=parseFloat(L[M][f].pageviews),Rt+=parseFloat(L[M][f].exits),Nt+=parseFloat(L[M][f].timeOnPage);var Xt=Pt/v,Jt=Nt/(Pt-Rt),Ft={sessions:Number(v),pageviewsPersession:isNaN(Xt)?0:Xt.toFixed(2),socialNetwork:Gt,avgtimeOnPage:isNaN(Jt)?0:Jt.toFixed(2)};"Time spent on site from various sources"==String(t.charts[u].chartName)?"(none)"!=String(Ft.socialNetwork)&&"organic"!=String(Ft.socialNetwork)&&"referral"!=String(Ft.socialNetwork)&&"ppc"!=String(Ft.socialNetwork)&&"social"!=String(Ft.socialNetwork)||P.push(Ft):P.push(Ft);
}t.charts[u].chartData=P}break;case"pageTechnicalEfficiency":if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){for(var xt=[],E=0;E<t.charts[u].chartData.length;E++){var qt=$.isEmptyObject(t.charts[u].chartData[E].total);if(1!=qt){var Ct=$.map(t.charts[u].chartData[E].total,function(t,e){return[t]});xt=xt.concat(Ct)}}var kt="pageTitle",P=[],L=_.groupBy(xt,"pagePath");for(var M in L){for(var Pt=0,Mt=0,jt=0,Et=0,v=0,y=0,Ht=0,f=0;f<L[M].length;f++){Ht+=parseFloat(L[M][f].pageLoadTime),v+=parseFloat(L[M][f].sessions),y+=parseFloat(L[M][f].bounces),Pt+=parseFloat(L[M][f].pageviews),jt+=parseFloat(L[M][f].pageLoadSample);var kt=L[M][f].pageTitle}var Mt=(Ht/jt/1e3).toFixed(2);if(isNaN(Mt)&&(Mt=0),0===v)var D=y;else var D=y/v*100;Mt=Math.ceil(Mt);var Ft={bounceRate:D.toFixed(2),pageTitle:kt,PageLoadTime:Mt.toFixed(2),pageviews:Pt};P.push(Ft)}P.sort(function(t,e){return parseFloat(t.pageviews)-parseFloat(e.pageviews)}),P.reverse();var Ut=[];if(P.length>10)for(var f=0;f<10;f++)Ut.push(P[f]);else for(var f=0;f<P.length;f++)Ut.push(P[f]);t.charts[u].chartData=Ut}break;case"visitorAcquisitionEfficiency":;if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){for(var xt=[],E=0;E<t.charts[u].chartData.length;E++){var qt=$.isEmptyObject(t.charts[u].chartData[E].total);if(1!=qt){var Ct=$.map(t.charts[u].chartData[E].total,function(t,e){return[t]});xt=xt.concat(Ct)}}var P=[],L=_.groupBy(xt,"sourceMedium");for(var M in L){for(var Bt=M,v=0,Yt=0,$t=0,_t=0,jt=0,Vt=0,f=0;f<L[M].length;f++)v+=parseFloat(L[M][f].sessions),$t+=parseFloat(L[M][f].newUsers),_t+=parseFloat(L[M][f].goalConversionRateAll),jt+=parseFloat(L[M][f].pageLoadSample),Vt+=parseFloat(L[M][f].goalValuePerSession);var Ft={newUsers:$t.toFixed(2),sourceMedium:Bt,goalValuePerSession:Vt.toFixed(2),goalConversionRateAll:_t.toFixed(2),sessions:v};P.push(Ft)}P.sort(function(t,e){return parseFloat(t.sessions)-parseFloat(e.sessions)}),P.reverse();var Ut=[];if(P.length>10)for(var f=0;f<10;f++)Ut.push(P[f]);else for(var f=0;f<P.length;f++)Ut.push(P[f]);t.charts[u].chartData=Ut}break;case"topReferringSites":if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){for(var xt=[],E=0;E<t.charts[u].chartData.length;E++){var qt=$.isEmptyObject(t.charts[u].chartData[E].total);if(1!=qt){var Ct=$.map(t.charts[u].chartData[E].total,function(t,e){return[t]});xt=xt.concat(Ct)}}var P=[],L=_.groupBy(xt,"source");for(var M in L){for(var Kt=M,v=0,Zt=0,Qt=0,f=0;f<L[M].length;f++)v+=parseFloat(L[M][f].sessions),Qt+=parseFloat(L[M][f].goalCompletionsAll);Zt=v/Qt;var Ft={source:Kt,goalCompletions:Number(Qt.toFixed(2)),goalConversionRate:isNaN(_t)?0:_t,sessions:v};P.push(Ft)}P.sort(function(t,e){return parseFloat(e.sessions)-parseFloat(t.sessions)});var Ut=[];if("Top referring sites(Table)"==String(t.charts[u].chartName))Ut=P;else if(P.length>10)for(var f=0;f<10;f++)Ut.push(P[f]);else for(var f=0;f<P.length;f++)Ut.push(P[f]);t.charts[u].chartData=Ut}break;case"fbReachByAge":var te={"13-17":{Female:0,Male:0,Unspecified:0},"18-24":{Female:0,Male:0,Unspecified:0},"25-34":{Female:0,Male:0,Unspecified:0},"35-44":{Female:0,Male:0,Unspecified:0},"45-54":{Female:0,Male:0,Unspecified:0},"55-64":{Female:0,Male:0,Unspecified:0},"65+":{Female:0,Male:0,Unspecified:0}};if("undefined"!=typeof t.charts[u].chartData[0]){if("object"==typeof t.charts[u].chartData[0].total)for(var U in t.charts[u].chartData)for(var z in t.charts[u].chartData[U].total){var ee=z.split("."),ae=String(ee[0]),re=String(ee[1]);"F"==ae&&(ae="Female"),"M"==ae&&(ae="Male"),"U"==ae&&(ae="Unspecified"),void 0!=te[re]&&(te[re]=te[re]||0,te[re][ae]+=parseInt(t.charts[u].chartData[U].total[z]))}var se=[],ie=[];for(var M in te){se.push(M);te[M].length}var oe=se[0];for(var ne in te[oe]){var ce={};ce.name=ne;var le=0;ce.data=[];for(var et in te)ce.data[le]=te[et][ne],le++;ie.push(ce)}var he=[te,se,ie]}t.charts[u].chartData=he;break;case"fbStoreType":case"engagementDay":if("fbStoreType"==g&&"undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){var pe=[];for(var U in t.charts[u].chartData){var Wt,Y={"page post":0,Other:0};for(var z in t.charts[u].chartData[U].total)"page post"===z?Y[z]=t.charts[u].chartData[U].total[z]:Y.Other+=t.charts[u].chartData[U].total[z];pe.push({date:moment(t.charts[u].chartData[U].date),total:Y})}t.charts[u].chartData=pe}if("engagementDay"==g){var de=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ue={},ge={},me={},fe={},ye={},ve={},De={},be=[ue,ge,me,fe,ye,ve,De];if("undefined"!=typeof t.charts[u].chartData[0]){for(var f=0;f<t.charts[u].chartData.length;f++)if("undefined"!=typeof t.charts[u].chartData[f].date){var we=new Date(t.charts[u].chartData[f].date),Te=we.getDay();if(Te<7)for(var z in t.charts[u].chartData[f].total)"comment"!==z&&"like"!==z&&"link"!==z||(be[Te].hasOwnProperty(z)?be[Te][z]+=t.charts[u].chartData[f].total[z]:(be[Te][z]=0,be[Te][z]+=t.charts[u].chartData[f].total[z]))}for(var xe=[],E=0;E<de.length;E++)xe.push({date:de[E],total:be[E]})}t.charts[u].chartData=xe}if("object"==typeof t.charts[u].chartData[0].total){var k;for(at in t.charts[u].metricDetails.objectTypes)t.charts[u].metricDetails.objectTypes[at].objectTypeId==t.charts[u].chartObjectTypeId&&(k="fbStoreType"==g?["page post","Other"]:t.charts[u].metricDetails.objectTypes[at].meta.endpoint);t.charts[u].metricDetails.objectTypes[at].meta.endpoint=t.charts[u].metricDetails.objectTypes[at].meta.endpointDisplay;var P=[];for(sr in k){var N=k[sr],R=[];for(U in t.charts[u].chartData){var A,I=0;if(null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length))for(var W in t.charts[u].chartData[U].total)if(W.search("/")>-1){A=W.split("/");for(var S in A)A[S]==N&&(I+=parseFloat(t.charts[u].chartData[U].total[W]))}else W==N&&(I=t.charts[u].chartData[U].total[N]);(g="engagementDay")?R.push({x:t.charts[u].chartData[U].date,y:I}):R.push({x:moment(t.charts[u].chartData[U].date),y:I})}P.push(R)}t.charts[u].chartData=P}t.charts[u].chartType="line";break;case"fbReachByCountry":if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){for(var xt=[],E=0;E<t.charts[u].chartData.length;E++)xt.push(t.charts[u].chartData[E].total);for(var Ce={},f=0;f<xt.length;f++)for(var M in xt[f])Ce.hasOwnProperty(M)?Ce[M]+=xt[f][M]:(Ce[M]=0,Ce[M]+=xt[f][M]);var ke=[];for(var Fe in Ce)ke.push([Fe,Ce[Fe]]);ke.sort(function(t,e){return e[1]-t[1]}),Ce={Others:0};for(var E=0;E<ke.length;E++)E<5?Ce.hasOwnProperty(ke[E][0])?Ce[ke[E][0]]=ke[E][1]:(Ce[ke[E][0]]=0,Ce[ke[E][0]]=ke[E][1]):Ce.Others+=ke[E][1]}t.charts[u].chartData=Ce;break;case"fbReachByCity":if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){for(var xt=[],E=0;E<t.charts[u].chartData.length;E++)xt.push(t.charts[u].chartData[E].total);for(var Ce={},f=0;f<xt.length;f++)for(var M in xt[f]){var Pe=M.split(","),Ne=Pe[0];Ce.hasOwnProperty(M)?Ce[Ne]+=xt[f][M]:(Ce[Ne]=0,Ce[Ne]+=xt[f][M])}var ke=[];for(var Fe in Ce)ke.push([Fe,Ce[Fe]]);ke.sort(function(t,e){return e[1]-t[1]}),Ce={Others:0};for(var E=0;E<ke.length;E++)E<5?Ce.hasOwnProperty(ke[E][0])?Ce[ke[E][0]]=ke[E][1]:(Ce[ke[E][0]]=0,Ce[ke[E][0]]=ke[E][1]):Ce.Others+=ke[E][1]}t.charts[u].chartData=Ce;break;case"fanSource":if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){var Re={Others:0,page_profile:0,like_story:0,mobile:0,mobile_ads:0,external_connect:0,recommended_pages:0};for(var U in t.charts[u].chartData)for(var z in t.charts[u].chartData[U].total)"undefined"!=t.charts[u].chartData[U].total[z]&&("page_profile"===z||"like_story"===z||"mobile"===z||"mobile_ads"===z||"external_connect"===z||"recommended_pages"===z?Re[z]+=t.charts[u].chartData[U].total[z]:Re.Others+=t.charts[u].chartData[U].total[z]);var Ae={"Page Profile":Re.page_profile,"Like story ads":Re.like_story,Mobile:Re.mobile,"Mobile ads":Re.mobile_ads,External:Re.external_connect,"Recommended pages":Re.recommended_pages," Others":Re.Others};t.charts[u].chartData=Ae}t.charts[u].chartType="fbReachByCity";break;case"pinterestEngagementRate":if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){var it="likes",ot="comments",Ie="repins",ct="name",ht="url",P=[];for(U in t.charts[u].chartData){var R={date:moment(t.charts[u].chartData[U].date).format("DD-MMM-YYYY"),postComment:null!=t.charts[u].chartData[U]&&Object.keys(0!=t.charts[u].chartData[U].length)&&null!=t.charts[u].chartData[U][ct]&&"undefined"!=typeof t.charts[u].chartData[U][ct]?t.charts[u].chartData[U][ct]:"",likes:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total[it]&&"undefined"!=typeof t.charts[u].chartData[U].total[it]?t.charts[u].chartData[U].total[it]:0,repins:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total[Ie]&&"undefined"!=typeof t.charts[u].chartData[U].total[Ie]?t.charts[u].chartData[U].total[Ie]:0,comments:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total[ot]&&"undefined"!=typeof t.charts[u].chartData[U].total[ot]?t.charts[u].chartData[U].total[ot]:0,links:null!=t.charts[u].chartData[U]&&Object.keys(0!=t.charts[u].chartData[U].length)&&"undefined"!=typeof t.charts[u].chartData[U][ht]?t.charts[u].chartData[U][ht]:""};P.push(R)}t.charts[u].chartData=P}break;case"pinterestLeaderboard":if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){var We="collaborators",Se="followers",Oe="pins",ct="name",ht="url",P=[];for(U in t.charts[u].chartData){var R={date:moment(t.charts[u].chartData[U].date).format("DD-MMM-YYYY"),postComment:null!=t.charts[u].chartData[U]&&Object.keys(0!=t.charts[u].chartData[U].length)&&null!=t.charts[u].chartData[U][ct]&&"undefined"!=typeof t.charts[u].chartData[U][ct]?t.charts[u].chartData[U][ct]:"",collaborators:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total[We]&&"undefined"!=typeof t.charts[u].chartData[U].total[We]?t.charts[u].chartData[U].total[We]:0,pins:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total[Oe]&&"undefined"!=typeof t.charts[u].chartData[U].total[Oe]?t.charts[u].chartData[U].total[Oe]:0,followers:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total[Se]&&"undefined"!=typeof t.charts[u].chartData[U].total[Se]?t.charts[u].chartData[U].total[Se]:0,links:null!=t.charts[u].chartData[U]&&Object.keys(0!=t.charts[u].chartData[U].length)&&"undefined"!=typeof t.charts[u].chartData[U][ht]?t.charts[u].chartData[U][ht]:""};P.push(R)}t.charts[u].chartData=P}break;case"vimeoTopVideos":if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){var it="likes",ot="comments",P=[];for(U in t.charts[u].chartData){var R={date:moment(t.charts[u].chartData[U].date).format("DD-MMM-YYYY"),link:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total.link&&"undefined"!=typeof t.charts[u].chartData[U].total.link?t.charts[u].chartData[U].total.link:"",Comment:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total.metadata.connections.comments.total&&"undefined"!=typeof t.charts[u].chartData[U].total.metadata.connections.comments.total?t.charts[u].chartData[U].total.metadata.connections.comments.total:"",likes:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total.metadata.connections.likes.total&&"undefined"!=typeof t.charts[u].chartData[U].total.metadata.connections.likes.total?t.charts[u].chartData[U].total.metadata.connections.likes.total:0,views:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total.stats.plays&&"undefined"!=typeof t.charts[u].chartData[U].total.stats.plays?t.charts[u].chartData[U].total.stats.plays:0,picture:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total.pictures.sizes[0].link&&"undefined"!=typeof t.charts[u].chartData[U].total.pictures.sizes[0].link?t.charts[u].chartData[U].total.pictures.sizes[0].link:0,title:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&null!=t.charts[u].chartData[U].total.name&&"undefined"!=typeof t.charts[u].chartData[U].total.name?t.charts[u].chartData[U].total.name:0};P.push(R)}t.charts[u].chartData=P}break;case"costPerActionType":var Ee=!1,ze=[];if(t.meta){var R=[];for(var U in t.charts[u].chartData){var f,H=0;for(f in t.charts[u].chartData[U].total)t.charts[u].chartData[U].total.hasOwnProperty(f)&&H++;if(H){var Le=0;for(var z in t.charts[u].chartData[U].total)t.meta==t.charts[u].chartData[U].total[z].action_type&&(Le=1,R.push({x:moment(t.charts[u].chartData[U].date),y:null!=t.charts[u].chartData[U].total[z]?t.charts[u].chartData[U].total[z].value:0}));Le||R.push({x:moment(t.charts[u].chartData[U].date),y:0})}else R.push({x:moment(t.charts[u].chartData[U].date),y:0})}t.charts[u].chartData=R}else{var R={};Ee=!0;for(var f=0;f<t.charts[u].chartData.length;f++)for(var z in t.charts[u].chartData[f].total)ze.push(t.charts[u].chartData[f].total[z].action_type);var Me=_.uniqBy(ze);R.flag=Ee,R.action=Me,t.charts[u].chartData=R}break;case"instagramHashtagLeaderBoard":if(null!=t.charts[u].chartData[0]){if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){var je="tag",ot="comments",it="likes",P=[];for(U in t.charts[u].chartData){var R={tagLink:null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length)&&"undefined"!=typeof t.charts[u].chartData[U].total[je]?"https://www.instagram.com/explore/tags/"+t.charts[u].chartData[U].total[je]:"",tag:null!=t.charts[u].chartData[U].total&&null!=t.charts[u].chartData[U].total[je]&&"undefined"!=typeof t.charts[u].chartData[U].total[je]?t.charts[u].chartData[U].total[je]:0,likes:null!=t.charts[u].chartData[U].total&&null!=t.charts[u].chartData[U].total[it]&&"undefined"!=typeof t.charts[u].chartData[U].total[it]?t.charts[u].chartData[U].total[it]:0,comments:null!=t.charts[u].chartData[U].total&&null!=t.charts[u].chartData[U].total[ot]&&"undefined"!=typeof t.charts[u].chartData[U].total[ot]?t.charts[u].chartData[U].total[ot]:0};P.push(R)}t.charts[u].chartData=P}}else t.charts[u].chartData=[];break;case"gaTopCountriesToSocialVisits":case"gaTopCitiesToSocialVisits":if("undefined"!=typeof t.charts[u].chartData[0]&&"object"==typeof t.charts[u].chartData[0].total){var xt=[],P=[],He={},Be=0;t.charts[u].chartData.forEach(function(e){for(var a in e.total)a.indexOf(t.charts[u].metricDetails.objectTypes[0].meta.endpoint[0]+"/")!=-1&&xt.push({country:a.split(t.charts[u].metricDetails.objectTypes[0].meta.endpoint[0]+"/").join(""),value:e.total[a]})});var L=_.groupBy(xt,"country");for(var M in L){for(var Ce=M,v=0,f=0;f<L[M].length;f++)v+=parseFloat(L[M][f].value);var Ft={country:Ce,sessions:v};P.push(Ft)}var Ye=_.sortBy(P,"sessions").reverse();if(Ye.length){for(var $e=Ye.length<5?Ye.length:5,E=0;E<$e;E++)He[Ye[E].country]=Ye[E].sessions;if(Ye.length>5){for(var q=5;q<Ye.length;q++)Be+=Ye[q].sessions;He.Others=Be}else He.Others=0}}t.charts[u].chartData=He;break;case"audienceBehaviourbyDay":var de=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],ue={},ge={},me={},fe={},ye={},ve={},De={},be=[ue,ge,me,fe,ye,ve,De];if("undefined"!=typeof t.charts[u].chartData[0])for(var f=0;f<t.charts[u].chartData.length;f++)if("undefined"!=typeof t.charts[u].chartData[f].date){var we=new Date(t.charts[u].chartData[f].date),Te=we.getDay();if(Te<7){for(var z in t.charts[u].chartData[f].total[0])"date"!=z&&"dayOfWeek"!=z&&"total"!=z&&(be[Te].hasOwnProperty(z)?be[Te][z]+=parseFloat(t.charts[u].chartData[f].total[0][z]):(be[Te][z]=0,be[Te][z]+=parseFloat(t.charts[u].chartData[f].total[0][z])));be[Te].bounceRate=0,0===be[Te].sessions?be[Te].bounceRate=be[Te].bounces:be[Te].bounceRate=be[Te].sessions/be[Te].bounces}}for(var xe=[],E=0;E<de.length;E++)xe.push({date:de[E],total:be[E]});t.charts[u].chartData=xe;break;case"audienceBehaviourByTimeofday":if("object"==typeof t.charts[u].chartData[0].total){for(var xt=[],E=0;E<t.charts[u].chartData.length;E++){var Ct=$.map(t.charts[u].chartData[E].total,function(t,e){return[t]});xt=xt.concat(Ct)}var Wt=[],P=[],L=_.groupBy(xt,"hour");for(var M in L){for(var _e=M,Pt=0,y=0,v=0,Ve=0,qe=0,f=0;f<L[M].length;f++)v+=parseFloat(L[M][f].sessions),Pt+=parseFloat(L[M][f].pageviews),y+=parseFloat(L[M][f].bounces),Ve+=parseFloat(L[M][f].pageviewsPerSession),qe+=parseFloat(L[M][f].percentNewSessions);if(0===v)var Et=y;else var Et=(y/v*100).toFixed(2);var _e={hour:_e,sessions:v,bounceRate:Et,pageviews:Pt,pageviewsPerSession:Ve,percentNewSessions:qe};P.push(_e)}var Ue=[];P.sort(function(t,e){return parseFloat(t.hour)-parseFloat(e.hour)});for(var E=0;E<P.length;E++)Ue.push({date:P[E].hour,total:P[E]});t.charts[u].chartType="audienceBehaviourbyDay",t.charts[u].chartData=Ue}break;case"socialContributionToSiteTraffic":if("object"==typeof t.charts[u].chartData[0].total){var k;for(at in t.charts[u].metricDetails.objectTypes)t.charts[u].metricDetails.objectTypes[at].objectTypeId==t.charts[u].chartObjectTypeId&&(k=t.charts[u].metricDetails.objectTypes[at].meta.endpoint,t.charts[u].metricDetails.objectTypes[at].meta.endpoint=void 0!=t.charts[u].metricDetails.objectTypes[at].meta.endpointDisplay?t.charts[u].metricDetails.objectTypes[at].meta.endpointDisplay:t.charts[u].metricDetails.objectTypes[at].meta.endpoint);var P=[];if(0!=k.length)for(sr in k){var N=k[sr],R=[];for(U in t.charts[u].chartData){var A,I=0;if(null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length))for(var W in t.charts[u].chartData[U].total)if(W.search("/")>-1){A=W.split("/");for(var S in A)A[S]==N&&(I+=parseFloat(t.charts[u].chartData[U].total[W]))}else W==N&&(I=t.charts[u].chartData[U].total[N]);R.push({x:moment(t.charts[u].chartData[U].date),y:I})}P.push(R)}else{var R=[];for(U in t.charts[u].chartData){var B,A,I=0,Y=t.charts[u].chartData[U].total;if(null!=t.charts[u].chartData[U].total&&0!=Object.keys(t.charts[u].chartData[U].total).length){for(var W in t.charts[u].chartData[U].total){if(W.search("/")>-1){A=W.split("/");for(var S in A)I+=parseFloat(t.charts[u].chartData[U].total[W]),B=W}else I=t.charts[u].chartData[U].total[N];B=W}R.push({x:B,y:I})}}P.push(R)}t.charts[u].chartData=R,t.charts[u].metricCode=t.charts[u].metricDetails.code,t.charts[u].metricName=t.charts[u].metricDetails.name}else{var R=[];for(var U in t.charts[u].chartData)R.push({x:moment(t.charts[u].chartData[U].date),y:null!=t.charts[u].chartData[U].total?t.charts[u].chartData[U].total:0});t.charts[u].chartData=R,t.charts[u].metricCode=t.charts[u].metricDetails.code,t.charts[u].metricName=t.charts[u].metricDetails.name}break;case"percentageArea":for(var f=0;f<t.charts[u].chartData.length;f++)if("object"==typeof t.charts[u].chartData[f].total){var k;for(at in t.charts[u].metricDetails.objectTypes)t.charts[u].metricDetails.objectTypes[at].objectTypeId==t.charts[u].chartObjectTypeId&&(k=t.charts[u].metricDetails.objectTypes[at].meta.endpoint,t.charts[u].metricDetails.objectTypes[at].meta.endpoint=void 0!=t.charts[u].metricDetails.objectTypes[at].meta.endpointDisplay?t.charts[u].metricDetails.objectTypes[at].meta.endpointDisplay:t.charts[u].metricDetails.objectTypes[at].meta.endpoint);var P=[];if(0!=k.length)for(sr in k){var N=k[sr],R=[];for(U in t.charts[u].chartData){var A,I=0;if(null!=t.charts[u].chartData[U].total&&Object.keys(0!=t.charts[u].chartData[U].total.length))for(var W in t.charts[u].chartData[U].total)if(W.search("/")>-1){A=W.split("/");for(var S in A)A[S]==N&&(I+=parseFloat(t.charts[u].chartData[U].total[W]))}else W==N&&(I=t.charts[u].chartData[U].total[W]);R.push({x:moment(t.charts[u].chartData[U].date),y:I})}P.push(R)}else{var R=[];for(U in t.charts[u].chartData){var B,A,I=[],Y=t.charts[u].chartData[U].total;if(null!=t.charts[u].chartData[U].total&&0!=t.charts[u].chartData[U].total&&0!=Object.keys(t.charts[u].chartData[U].total).length){for(var W in t.charts[u].chartData[U].total){if(W.search("/")>-1){A=W.split("/");for(var S in A)I=t.charts[u].chartData[U].total[W],B=W}else I=t.charts[u].chartData[U].total[W];B=moment(t.charts[u].chartData[U].date)}R.push({x:B,y:I})}}P.push(R)}t.charts[u].chartData=R,t.charts[u].metricCode=t.charts[u].metricDetails.code,t.charts[u].metricName=t.charts[u].metricDetails.name}break;case"stackbar":if("object"==typeof t.charts[u].chartData[0].total){for(var tt=[{"(none)":0,organic:0,paid:0,others:0,social:0,ppc:0,referral:0}],E=0;E<t.charts[u].chartData.length;E++)for(z in t.charts[u].chartData[E].total){var Ge=z.split("/");"(none)"!=Ge[0]&&"organic"!=Ge[0]&&"ppc"!=Ge[0]&&"social"!=Ge[0]&&"referral"!=Ge[0]?tt[0].others+=parseFloat(t.charts[u].chartData[E].total[z]):"referral"===Ge[0]&&"undefined"!=Ge[1]&&"Yes"===Ge[1]?tt[0].social+=parseFloat(t.charts[u].chartData[E].total[z]):tt[0][Ge[0]]+=parseFloat(t.charts[u].chartData[E].total[z])}var ie=[];ie.push({date:t.charts[u].chartName,total:tt})}t.charts[u].chartData=ie;break;case"gaUsers":if("undefined"!=typeof t.charts[u].chartData[0]){var Xe={};if("string"!=typeof t.charts[u].chartData)for(var f=0;f<t.charts[u].chartData.length;f++){var M=t.charts[u].chartData[f][0];Xe[M]=t.charts[u].chartData[f][1]}t.charts[u].chartData=Xe}break;case"youtubeVideosOverview":for(var Je=[],M=0;M<t.charts[u].chartData.length;M++)if("undefined"!=typeof t.charts[u].chartData[M]&&"object"==typeof t.charts[u].chartData[M]){var oe=0,ot=0,it=0,Tt=0,Ke={name:t.charts[u].chartData[M].title,views:t.charts[u].chartData[M].viewCount,comments:t.charts[u].chartData[M].commentCount,likes:t.charts[u].chartData[M].likeCount,dislikes:t.charts[u].chartData[M].dislikeCount,shares:t.charts[u].chartData[M].favoriteCount};Je.push(Ke)}t.charts[u].chartData=Je;break;case"twitterEngagements":switch(String(t.charts[u].chartSubType)){case"activityByDayOfTheWeek":if("undefined"!=typeof t.charts[u].chartData[0]){for(var O=[],E=0;E<t.charts[u].chartData.length;E++)"object"==typeof t.charts[u].chartData[E].total&&(t.charts[u].chartData[E].total.created_at=new Date(t.charts[u].chartData[E].total.created_at).getDay(),O.push(t.charts[u].chartData[E].total));var L=_.groupBy(O,"created_at"),P=[];for(var M in L){for(var it=0,Ze=0,ft=0,Qe=M,f=0;f<L[M].length;f++)it+=parseFloat(L[M][f].favorite_count),Ze+=parseFloat(L[M][f].retweet_count);ft=it+Ze;var ta=f,Ft={day:Qe,tweets:ta,engagement:ft};P.push(Ft)}P.sort(function(t,e){return parseFloat(t.day)-parseFloat(e.day)});for(var M in P)"0"===P[M].day&&(P[M].day="Sunday"),"1"===P[M].day&&(P[M].day="Monday"),"2"===P[M].day&&(P[M].day="Tuesday"),"3"===P[M].day&&(P[M].day="Wednesday"),"4"===P[M].day&&(P[M].day="Thursday"),"5"===P[M].day&&(P[M].day="Friday"),"6"===P[M].day&&(P[M].day="Saturday");t.charts[u].chartData=P}break;case"activityByTimeOfTheDay":var ea=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];if("undefined"!=typeof t.charts[u].chartData[0]){for(var O=[],E=0;E<t.charts[u].chartData.length;E++)if("object"==typeof t.charts[u].chartData[E].total){var Wt=t.charts[u].chartData[E].total.created_at;t.charts[u].chartData[E].total.day=ea[new Date(Wt).getDay()],O.push(t.charts[u].chartData[E].total)}var L=_.groupBy(O,"day"),P=[];for(var M in L){for(var Qe=M,aa=[],f=0;f<L[M].length;f++)aa.push({time:new Date(L[M][f].created_at).getHours(),likes:L[M][f].favorite_count,reTweets:L[M][f].retweet_count});var ra=_.groupBy(aa,"time");for(var tt in ra){for(var it=0,Ze=0,ft=0,sa=tt,q=0;q<ra[tt].length;q++)it+=parseFloat(ra[tt][q].likes),Ze+=parseFloat(ra[tt][q].reTweets);ft=it+Ze;var Ft={day:Qe,time:sa,engagement:ft};P.push(Ft)}}t.charts[u].chartData=P}break;case"engagementByUsersTalkedAbout":for(var P=[],ia=[],M=0;M<t.charts[u].chartData.length;M++)if("undefined"!=typeof t.charts[u].chartData[M]&&"object"==typeof t.charts[u].chartData[M].total){var it=0,Ze=0,ft=0,oa=[],Qe=M;it=parseFloat(t.charts[u].chartData[M].total.favorite_count),Ze=parseFloat(t.charts[u].chartData[M].total.retweet_count),ft=it+Ze;for(var na=void 0!=t.charts[u].chartData[M].total.entities&&void 0!=t.charts[u].chartData[M].total.entities?t.charts[u].chartData[M].total.entities.user_mentions.length:0,ca=void 0!=t.charts[u].chartData[M].total.entities&&void 0!=t.charts[u].chartData[M].total.entities?t.charts[u].chartData[M].total.entities.user_mentions:0,la=0;la<na;la++){var Ke={tweet:t.charts[u].chartData[M].total.text,engagement:ft,userMentionedScreenName:ca[la].screen_name,userMentionedName:ca[la].name,url:void 0!=t.charts[u].chartData[M].total.media?t.charts[u].chartData[M].total.media[0].expanded_url:"https://twitter.com/"+ca[la].screen_name};oa.push(Ke)}for(var E=0;E<oa.length;E++)ia.push(oa[E])}var xt=[],Ue=_.groupBy(ia,"userMentionedScreenName");for(var z in Ue){for(var ft=0,ha=0;ha<Ue[z].length;ha++)ft+=Ue[z][ha].engagement;xt.push({userMentionedScreenName:z,engagement:ft})}xt.sort(function(t,e){return parseFloat(e.engagement)-parseFloat(t.engagement)}),t.charts[u].chartData=xt;break;case"topLinks":if("undefined"!=typeof t.charts[u].chartData[0]){var it="favorite_count",Dt="retweet_count",pa=[];if("object"==typeof t.charts[u].chartData[0].total)for(var f=0;f<t.charts[u].chartData.length;f++)if("undefined"!=typeof t.charts[u].chartData[f].total.entities)for(var E=0;E<t.charts[u].chartData[f].total.entities.urls.length;E++){var gt=t.charts[u].chartData[f].total[it],Ze=t.charts[u].chartData[f].total[Dt],ft=gt+Ze,ht={url:t.charts[u].chartData[f].total.entities.urls[E].url,displayurl:t.charts[u].chartData[f].total.entities.urls[E].expanded_url,engagement:ft};pa.push(ht)}var L=_.groupBy(pa,"displayurl"),xt=[];for(var z in L){for(var ft=0,ha=0;ha<L[z].length;ha++)ft+=L[z][ha].engagement;xt.push({url:z,engagement:ft})}xt.sort(function(t,e){return parseFloat(e.engagement)-parseFloat(t.engagement)}),t.charts[u].chartData=xt}break;case"instagramActivityByDayOfTheWeek":if("undefined"!=typeof t.charts[u].chartData[0]){for(var O=[],E=0;E<t.charts[u].chartData.length;E++)"object"==typeof t.charts[u].chartData[E].total&&(t.charts[u].chartData[E].total.created_time=moment.unix(t.charts[u].chartData[E].total.created_time).format("YYYY/MMM/DD"),t.charts[u].chartData[E].total.created_time=new Date(t.charts[u].chartData[E].total.created_time).getDay(),O.push(t.charts[u].chartData[E].total));var L=_.groupBy(O,"created_time"),P=[];for(var M in L){for(var it=0,ot=0,ft=0,Qe=M,f=0;f<L[M].length;f++)it+=parseFloat(L[M][f].likes.count),ot+=parseFloat(L[M][f].comments.count);ft=it+ot;var da=f,Ft={day:Qe,tweets:da,engagement:ft};P.push(Ft)}P.sort(function(t,e){return parseFloat(t.day)-parseFloat(e.day)});for(var M in P)"0"===P[M].day&&(P[M].day="Sunday"),"1"===P[M].day&&(P[M].day="Monday"),"2"===P[M].day&&(P[M].day="Tuesday"),"3"===P[M].day&&(P[M].day="Wednesday"),"4"===P[M].day&&(P[M].day="Thursday"),"5"===P[M].day&&(P[M].day="Friday"),"6"===P[M].day&&(P[M].day="Saturday");t.charts[u].chartData=P}break;case"instagramActivityByTimeOfTheDay":if("undefined"!=typeof t.charts[u].chartData[0]){for(var O=[],E=0;E<t.charts[u].chartData.length;E++)if("object"==typeof t.charts[u].chartData[E].total){var Wt=t.charts[u].chartData[E].total.created_time;t.charts[u].chartData[E].total.day=moment.unix(Wt).format("dddd"),O.push(t.charts[u].chartData[E].total)}var L=_.groupBy(O,"day"),P=[];for(var M in L){for(var Qe=M,aa=[],f=0;f<L[M].length;f++){var V=moment.unix(L[M][f].created_time);aa.push({time:new Date(V).getHours(),likes:L[M][f].likes.count,comments:L[M][f].comments.count})}var ra=_.groupBy(aa,"time");for(var tt in ra){for(var it=0,ot=0,ft=0,sa=tt,q=0;q<ra[tt].length;q++)it+=parseFloat(ra[tt][q].likes),ot+=parseFloat(ra[tt][q].comments);ft=it+ot;var Ft={day:Qe,time:sa,engagement:ft};P.push(Ft)}}t.charts[u].chartData=P}break;case"commentsAndLikes":if("undefined"!=typeof t.charts[u].chartData[0]){for(var P=[],E=0;E<t.charts[u].chartData.length;E++)"object"==typeof t.charts[u].chartData[E].total&&P.push({x:moment(t.charts[u].chartData[E].date).format("DD-MMM-YYYY"),y:parseFloat(t.charts[u].chartData[E].total.likes.count)+parseFloat(t.charts[u].chartData[E].total.comments.count),link:t.charts[u].chartData[E].total.link});t.charts[u].chartData=P}break;case"hashTag":if("undefined"!=typeof t.charts[u].chartData[0]){var it="favorite_count",Dt="retweet_count",pa=[];if("object"==typeof t.charts[u].chartData[0].total)for(var f=0;f<t.charts[u].chartData.length;f++)if("undefined"!=typeof t.charts[u].chartData[f].total.entities)for(var E=0;E<t.charts[u].chartData[f].total.entities.hashtags.length;E++){var gt=t.charts[u].chartData[f].total[it],Ze=t.charts[u].chartData[f].total[Dt],ft=gt+Ze,ht={hashTag:t.charts[u].chartData[f].total.entities.hashtags[E].text,engagement:ft};pa.push(ht)}var L=_.groupBy(pa,"hashTag"),xt=[];for(var z in L){for(var ft=0,ha=0;ha<L[z].length;ha++)ft+=L[z][ha].engagement;xt.push({text:z,engagement:ft})}xt.sort(function(t,e){return parseFloat(e.engagement)-parseFloat(t.engagement)}),t.charts[u].chartData=xt}}break;case"campaignOverview":if("undefined"!=t.charts[u].chartData[0]){P=[];for(var ua=[],E=0;E<t.charts[u].chartData.length;E++)for(var z in t.charts[u].chartData[E].total)ua.push(t.charts[u].chartData[E].total[z]);var ga=_.groupBy(ua,"Campaign ID");for(var M in ga){for(var ma,fa=M,ya="Campaign",va="Campaign state",Da=0,ba=0,wa=0,Ta="Currency",xa="Start date",Ca="End date",ka=0,Fa="Budget",f=0;f<ga[M].length;f++)wa+=parseFloat(ga[M][f].Cost),Ta=ga[M][f][Ta],ka+=parseFloat(ga[M][f].Impressions),ma=ga[M][f]["Unique cookies"],Da+=parseFloat(ga[M][f].Clicks),ba+=parseFloat(ga[M][f].Conversions);if(0===wa)var wa=wa;else var wa=(wa/1e6).toFixed(2);if(0===wa)var Pa=wa;else var Pa=(wa/ka*1e3).toFixed(2);if(0===Da)var Na=Da;else var Na=(Da/ka*100).toFixed(2);if(0===wa)var Ra=wa;else var Ra=(wa/Da).toFixed(2);if(0===wa)var Aa=wa;else var Aa=(wa/ba*100).toFixed(2);var Ia={Id:fa,Name:ga[M][0][ya],status:ga[M][0][va],Currency:ga[M][0].Currency,startDate:ga[M][0][xa],endDate:ga[M][0][Ca],Budget:ga[M][0][Fa]/1e6,Impressions:ka,CPM:"Infinity"===Pa?0:Pa,CTR:"Infinity"===Na?0:Na,CPC:"Infinity"===Ra?0:Ra,CostPerConv:"Infinity"===Aa?0:Aa,Spent:wa,Conversions:ba,Clicks:Da,ImpressionReachValue:ma};P.push(Ia)}}t.charts[u].chartData=P;break;case"adgroupOverview":if("undefined"!=t.charts[u].chartData[0]){P=[];for(var Wa=[],E=0;E<t.charts[u].chartData.length;E++)for(var z in t.charts[u].chartData[E].total)Wa.push(t.charts[u].chartData[E].total[z]);var ga=_.groupBy(Wa,"Ad group ID");for(var M in ga){for(var Sa=M,Oa="Ad group",va="Ad group state",Da=0,ba=0,wa=0,Ta="Currency",Ea=0,ka=0,f=0;f<ga[M].length;f++)wa+=parseFloat(ga[M][f].Cost),Ta=ga[M][f][Ta],ka+=parseFloat(ga[M][f].Impressions),Ea+=parseFloat(ga[M][f].Totalconvvalue),Da+=parseFloat(ga[M][f].Clicks),ba+=parseFloat(ga[M][f].Conversions);if(0===wa)var wa=wa;else var wa=(wa/1e6).toFixed(2);if(0===wa)var Pa=wa;else var Pa=(wa/ka*1e3).toFixed(2);if(0===Da)var Na=Da;else var Na=(Da/ka*100).toFixed(2);if(0===wa)var Ra=wa;else var Ra=(wa/Da).toFixed(2);if(0===wa)var Aa=wa;else var Aa=(wa/ba*100).toFixed(2);var Ia={Id:Sa,Name:ga[M][0][Oa],status:ga[M][0][va],Currency:ga[M][0].Currency,Impressions:ka,CPM:"Infinity"===Pa?0:Pa,CTR:"Infinity"===Na?0:Na,CPC:"Infinity"===Ra?0:Ra,CostPerConv:"Infinity"===Aa?0:Aa,Spent:wa,Conversions:ba,Totalconvvalue:Ea,Clicks:Da,CPMCBid:" --"===ga[M][0].MaxCPM?0:parseFloat(ga[M][0].MaxCPM)/1e6,CPCBid:" --"===ga[M][0].MaxCPC?0:parseFloat(ga[M][0].MaxCPC)/1e6,
CPVBid:" --"===ga[M][0].MaxCPV?0:parseFloat(ga[M][0].MaxCPV)/1e6};P.push(Ia)}}t.charts[u].chartData=P;break;case"fbAdsAdgroupOverview":if("undefined"!=t.charts[u].chartData[0]){P=[];for(var Wa=[],E=0;E<t.charts[u].chartData.length;E++)for(var z in t.charts[u].chartData[E].total)Wa.push(t.charts[u].chartData[E].total[z]);var ga=_.groupBy(Wa,"adset_id");for(var M in ga){for(var Sa=M,Oa="adset_name",va="status",za="start_time",La="stop_time",Da=0,wa=0,Ma="objective",Z=0,ka=0,ba=0,f=0;f<ga[M].length;f++)wa+=parseFloat(ga[M][f].spend),Z+=parseFloat(ga[M][f].reach),ka+=parseFloat(ga[M][f].impressions),Da+=parseFloat(ga[M][f].clicks),ba+=s(ga[M][f].actions);if(0===wa)var Pa=wa;else var Pa=(wa/ka*1e3).toFixed(2);if(0===Da)var Na=Da;else var Na=(Da/ka*100).toFixed(2);if(0===wa)var Ra=wa;else var Ra=(wa/Da).toFixed(2);if(0===wa)var Aa=wa;else var Aa=(wa/ba*100).toFixed(2);var Ia={Id:Sa,Name:ga[M][0][Oa],Objective:ga[M][0][Ma],status:ga[M][0][va],reach:Z,Impressions:ka,CPM:"Infinity"===Pa?0:Pa,CTR:"Infinity"===Na?0:Na,CPC:"Infinity"===Ra?0:Ra,CostPerConv:"Infinity"===Aa?0:Aa,Spent:wa,Conversions:ba,Clicks:Da,StartDate:ga[M][0][za],EndDate:ga[M][0][La]};P.push(Ia)}}t.charts[u].chartData=P;break;case"adOverview":if("undefined"!=t.charts[u].chartData[0]){P=[];for(var Wa=[],E=0;E<t.charts[u].chartData.length;E++)for(var z in t.charts[u].chartData[E].total)Wa.push(t.charts[u].chartData[E].total[z]);var ja=_.groupBy(Wa,"Ad ID");for(var M in ja){for(var Ha=M,Ba="Business Name",Ya="Ad type",Da=0,ba=0,wa=0,Ea=0,Ta="Currency",ka=0,f=0;f<ja[M].length;f++)wa+=parseFloat(ja[M][f].Cost),Ta=ja[M][f][Ta],ka+=parseFloat(ja[M][f].Impressions),Ea+=parseFloat(ja[M][f].Totalconvvalue),Da+=parseFloat(ja[M][f].Clicks),ba+=parseFloat(ja[M][f].Conversions);if(0===wa)var wa=wa;else var wa=(wa/1e6).toFixed(2);if(0===wa)var Pa=wa;else var Pa=(wa/ka*1e3).toFixed(2);if(0===Da)var Na=Da;else var Na=(Da/ka*100).toFixed(2);if(0===wa)var Ra=wa;else var Ra=(wa/Da).toFixed(2);if(0===ba)var $a=ba;else var $a=(ba/Da*100).toFixed(2);var Ia={Id:Ha,Name:ja[M][0][Ba],type:ja[M][0][Ya],Currency:ja[M][0].Currency,clickType:ja[M][0]["Click type"],Impressions:ka,CPM:"Infinity"===Pa?0:Pa,CTR:"Infinity"===Na?0:Na,CPC:"Infinity"===Ra?0:Ra,Totalconvvalue:Ea,Spent:wa,Conversions:ba,ConversionRate:"Infinity"===$a?0:$a,Clicks:Da};P.push(Ia)}}t.charts[u].chartData=P;break;case"adwordsDemography":var pt=t.charts[u].chartSubType;if("undefined"!=t.charts[u].chartData[0]){P=[];for(var ua=[],E=0;E<t.charts[u].chartData.length;E++)for(var z in t.charts[u].chartData[E].total)ua.push(t.charts[u].chartData[E].total[z]);if("pieAge"===pt||"tableAge"===pt)var ga=_.groupBy(ua,"Age Range");else if("pieGender"===pt||"tableGender"===pt)var ga=_.groupBy(ua,"Gender");else if("pieDevice"===pt||"tableDevice"===pt)var ga=_.groupBy(ua,"Device");for(var M in ga){for(var re=M,Da=0,ba=0,wa=0,Ta="Currency",ka=0,Ea=0,f=0;f<ga[M].length;f++)wa+=parseFloat(ga[M][f].Cost),ka+=parseFloat(ga[M][f].Impressions),Da+=parseFloat(ga[M][f].Clicks),ba+=parseFloat(ga[M][f].Conversions),Ea+=parseFloat(ga[M][f].Totalconvvalue);if(0===wa)var wa=wa;else var wa=(wa/1e6).toFixed(2);if(0===wa)var Pa=wa;else var Pa=(wa/ka*1e3).toFixed(2);if(0===Da)var Na=Da;else var Na=(Da/ka*100).toFixed(2);if(0===wa)var Ra=wa;else var Ra=(wa/Da).toFixed(2);if(0===ba)var _a=ba;else var _a=(ba/Da*100).toFixed(2);var Ia={Currency:ga[M][0].Currency,age:re,Impressions:ka,CPM:"Infinity"===Pa?0:Pa,CTR:"Infinity"===Na?0:Na,CPC:"Infinity"===Ra?0:Ra,conversionRate:"Infinity"===_a?0:_a,Spent:wa,Conversions:ba,Clicks:Da,Totalconvvalue:Ea};P.push(Ia)}}if("pieAge"===pt||"pieGender"===pt||"pieDevice"===pt){for(var Va={},f=0;f<P.length;f++){var qa=P[f].age;Va[qa]=P[f].Impressions}P=Va}t.charts[u].chartData=P;break;case"fbAdsCampaignOverview":if("undefined"!=t.charts[u].chartData[0]){P=[];for(var ua=[],E=0;E<t.charts[u].chartData.length;E++)for(var z in t.charts[u].chartData[E].total)ua.push(t.charts[u].chartData[E].total[z]);var ga=_.groupBy(ua,"campaign_id");for(var M in ga){for(var ma,fa=M,Ua="campaign_name",va="status",bt=0,Ga=0,Xa=0,Ja=0,Ka=0,Za=0,Qa=0,Z=0,tr=0,xa="start_time",Ca="stop_time",wt=0,f=0;f<ga[M].length;f++)wt+=parseFloat(ga[M][f].impressions),bt+=parseFloat(ga[M][f].clicks),Ga+=s(ga[M][f].actions),Ja+=o(ga[M][f].cost_per_action_type),Xa+=i(ga[M][f].cost_per_unique_action_type),Ka+=parseFloat(ga[M][f].spend),Za+=parseFloat(ga[M][0].app_store_clicks),Qa+=parseFloat(ga[M][0].frequency),tr+=parseFloat(ga[M][0].video_avg_percent_watched_actions),Z+=parseFloat(ga[M][0].reach);if(0===Ja)var Pa=Ja;else var Pa=(Ja/wt*1e3).toFixed(2);if(0===bt)var Na=bt;else var Na=(bt/wt*100).toFixed(2);if(0===Ja)var Ra=Ja;else var Ra=(Ja/bt).toFixed(2);if(0===Ja);else{(Ja/Ga*100).toFixed(2)}var Kt={Id:fa,Name:ga[M][0][Ua],Objective:ga[M][0].objective,status:ga[M][0][va],reach:Z,Impressions:wt,cost:Ja.toFixed(2),CPM:"Infinity"===Pa?0:Pa,CTR:"Infinity"===Na?0:Na,CPC:"Infinity"===Ra?0:Ra,Actions:"Infinity"===Ga?0:Ga,Spent:Ka,Conversions:Ga,Clicks:bt,StartDate:ga[M][0][xa],EndDate:ga[M][0][Ca],AppStoreClicks:Za,CostPerUniqueActionByType:Xa.toFixed(2),Frequency:Qa.toFixed(2),VideoAvgViewTime:isNaN(tr)?0:tr};P.push(Kt)}}t.charts[u].chartData=P;break;case"fbAdsAdOverview":if("undefined"!=t.charts[u].chartData[0]){P=[];for(var er=[],E=0;E<t.charts[u].chartData.length;E++)for(var z in t.charts[u].chartData[E].total)er.push(t.charts[u].chartData[E].total[z]);var ar=_.groupBy(er,"ad_id");for(var M in ar){for(var bt=0,rr=0,Xa=0,Ja=0,Ka=0,Za=0,Qa=0,Z=0,tr=0,wt=0,f=0;f<ar[M].length;f++)bt+=parseFloat(ar[M][f].clicks),wt+=parseFloat(ar[M][f].impressions),rr+=s(ar[M][f].actions),Xa+=i(ar[M][f].cost_per_unique_action_type),Ka+=parseFloat(ar[M][f].spend),Za+=parseFloat(ar[M][0].app_store_clicks),Qa+=parseFloat(ar[M][0].frequency),Z+=parseFloat(ar[M][0].reach);if(0===Ja)var Ja=Ja;else var Ja=(Ja/1e6).toFixed(2);if(0===Ja)var Pa=Ja;else var Pa=(Ja/wt*1e3).toFixed(2);if(0===bt)var Na=bt;else var Na=(bt/wt*100).toFixed(2);if(0===Ja)var Ra=Ja;else var Ra=(Ja/bt).toFixed(2);var Kt={Id:M,AdName:ar[M][0].ad_name,AdSetName:ar[M][0].adset_name,CampaignName:ar[M][0].campaign_name,Objective:ar[M][0].objective,Status:ar[M][0].status,Reach:Z,Impressions:wt,CPM:"Infinity"===Pa?0:Pa,CTR:"Infinity"===Na?0:Na,Actions:"Infinity"===rr?0:rr,Spend:Ja,StartDate:ar[M][0].start_time,EndDate:ar[M][0].end_time,AppStoreClicks:Za,CostPerUniqueActionByType:Xa.toFixed(2),Frequency:Qa.toFixed(2)};P.push(Kt)}}t.charts[u].chartData=P}}for(var u in t.charts)if("undefined"!=typeof t.charts[u].chartData[0])if(t.charts[u].chartData[0].x)for(var U in t.charts[u].chartData)p+=parseFloat(t.charts[u].chartData[U].y),parseFloat(p)>0&&0!=parseFloat(p)&&++h;else for(var sr in t.charts[u].chartData)for(var U in t.charts[u].chartData[sr])"undefined"!=typeof t.charts[u].chartData[sr][U]&&(p+=parseFloat(t.charts[u].chartData[sr][U].y),Number(p)>0&&0!=Number(p)&&++h);for(var u in t.charts){var g=t.charts[u].chartType,pt=t.charts[u].chartSubType;if("line"==g||"bar"==g||"column"==g||"stackcolumn"==g||"area"==g||"pie"==g||"reachVsImpressions"==g||"engagedUsersReach"==g||"mozoverview"==g||"trafficSourcesBrkdwnLine"==g||"bounceRateArea"==g||"negativeBar"==g||"trafficSourcesBrkdwnPie"==g||"costPerThosuandImpressions"==g||"clickThroughRate"==g||"costPerConversion"==g||"ConversionRate"==g||"costPerClick"==g||"costPerActionType"==g&&void 0!=t.meta){if("undefined"!=typeof t.charts[u].chartData[0])if(t.charts[u].chartData[0].x){var ir,or=0,nr=!1,cr=0,lr=0,hr=t.charts[u].chartData.length,pr=0,dr=0,ur=0,gr=0,mr=0,fr=0;if(t.charts[u].chartData.length>=14){for(var H=0,f=hr-1;f>=0;f--)0===H||H<7?("reachVsImpressions"==g||"engagedUsersReach"==g)&&t.charts[u].chartData[f].imp&&t.charts[u].chartData[f].rea?(ur+=parseFloat(t.charts[u].chartData[f].imp),gr+=parseFloat(t.charts[u].chartData[f].rea)):pr+=parseFloat(t.charts[u].chartData[f].y):H>=7&&H<14&&(("reachVsImpressions"==g||"engagedUsersReach"==g)&&t.charts[u].chartData[f].imp&&t.charts[u].chartData[f].rea?(mr+=parseFloat(t.charts[u].chartData[f].imp),fr+=parseFloat(t.charts[u].chartData[f].rea)):dr+=parseFloat(t.charts[u].chartData[f].y)),H++;"Total Impressions"!=t.charts[u].chartName&&"Engaged Users"!=t.charts[u].chartName||"reachVsImpressions"!=g&&"engagedUsersReach"!=g||(pr=isNaN(ur/gr)?0:ur/gr,dr=isNaN(mr/fr)?0:mr/fr),ir="WK"}else if("object"!=typeof t.charts[u].chartData[0].x){var yr=d(t.charts[u].chartData[0].x);if(yr){var vr=_.last(t.charts[u].chartData),Dr=moment(vr.x).subtract(1,"days").format("YYYY-DD-MM");pr="Total Impressions"!=t.charts[u].chartName&&"Engaged Users"!=t.charts[u].chartName||"reachVsImpressions"!=g&&"engagedUsersReach"!=g?parseFloat(vr.y):isNaN(parseFloat(vr.imp)/parseFloat(vr.rea))?0:parseFloat(vr.imp)/parseFloat(vr.rea);for(var f=hr-1;f>=0;f--){var br=moment(t.charts[u].chartData[f].x).format("YYYY-DD-MM");Dr===br&&(dr="Total Impressions"!=t.charts[u].chartName&&"Engaged Users"!=t.charts[u].chartName||"reachVsImpressions"!=g&&"engagedUsersReach"!=g?parseFloat(t.charts[u].chartData[f].y):isNaN(parseFloat(t.charts[u].chartData[f].imp)/parseFloat(t.charts[u].chartData[f].rea))?0:parseFloat(t.charts[u].chartData[f].imp)/parseFloat(t.charts[u].chartData[f].rea))}ir="Day"}}else{var vr=_.last(t.charts[u].chartData),Dr=moment(vr.x).subtract(1,"days").format("YYYY-DD-MM");pr=parseFloat(vr.y);for(var f=hr-1;f>=0;f--){var br=moment(t.charts[u].chartData[f].x).format("YYYY-DD-MM");Dr===br&&(dr=parseFloat(t.charts[u].chartData[f].y))}ir="Day"}var wr,Q,Tr;pr>dr?(wr="up",Tr=pr-dr,Q=dr>0?parseFloat(Tr/dr*100).toFixed(2):pr):pr<dr?(wr="down",Tr=dr-pr,Q=dr>0?parseFloat(Tr/dr*100).toFixed(2):0):(Tr=dr-pr,Q=0);var xr=0,Cr=0;for(var U in t.charts[u].chartData)("reachVsImpressions"==g||"engagedUsersReach"==g)&&t.charts[u].chartData[U].imp&&t.charts[u].chartData[U].rea?(xr+=parseFloat(t.charts[u].chartData[U].imp),Cr+=parseFloat(t.charts[u].chartData[U].rea)):(isNaN(t.charts[u].chartData[U].y)&&(t.charts[u].chartData[U].y=0),or+=parseFloat(t.charts[u].chartData[U].y)),parseFloat(t.charts[u].chartData[U].y)>0&&lr++;if("Total Impressions"!=t.charts[u].chartName&&"Engaged Users"!=t.charts[u].chartName||"reachVsImpressions"!=g&&"engagedUsersReach"!=g||(or=isNaN(xr/Cr)?0:xr/Cr*100),"undefined"!=typeof t.charts[u].metricDetails.objectTypes[0].meta.summaryType)if("avg"==t.charts[u].metricDetails.objectTypes[0].meta.summaryType)or=0==lr&&0==or?0:parseFloat(or/lr).toFixed(2);else if("snapshot"==t.charts[u].metricDetails.objectTypes[0].meta.summaryType){var kr="";for(var tt in t.charts[u].chartData)kr<moment(t.charts[u].chartData[tt].x)&&(kr=moment(t.charts[u].chartData[tt].x),or=t.charts[u].chartData[tt].y,0!=or&&(cr+=1));nr=cr>=1}if("bounceRateArea"==g){var Fr=0,v=0;for(var U in t.charts[u].chartData)Fr+=parseFloat(t.charts[u].chartData[U].bounces),v+=parseFloat(t.charts[u].chartData[U].sessions);or=Fr/v*100}if("costPerClick"==g||"costPerThosuandImpressions"==g||"clickThroughRate"==g||"ConversionRate"==g||"costPerConversion"==g){var T=0,x=0;for(var U in t.charts[u].chartData)T+=parseFloat(t.charts[u].chartData[U].dividend),x+=parseFloat(t.charts[u].chartData[U].divisor);or=0===T?T:"costPerThosuandImpressions"==g?T/x*1e3:"clickThroughRate"==g||"ConversionRate"==g||"costPerConversion"==g?"Infinity"===(T/x*100).toFixed(2)?0:(T/x*100).toFixed(2):T/x}if("line"==g||"bar"==g||"column"==g||"mozoverview"==g)"FacebookAds"==t.channelName&&"Cost Per Unique Action Type"==t.charts[u].metricDetails.name?c.push({channelName:l[t.channelName],type:t.charts[u].chartType,values:t.charts[u].chartData,key:t.charts[u].chartName,unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[0]:"",color:t.charts[u].chartColour[0],summaryDisplay:parseFloat(or).toFixed(2)%Math.floor(parseFloat(or).toFixed(2))>0?parseFloat(or).toFixed(2):parseFloat(or).toFixed(2)>1?parseInt(or):parseFloat(or)>0?parseFloat(or).toFixed(2):parseInt(or),hasSnapshotData:nr}):("bar"==g||"column"==g)&&h<0&&0==or?c.push({type:"line",channelName:l[t.channelName],values:t.charts[u].chartData,key:t.charts[u].metricDetails.name,unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[0]:"",color:t.charts[u].chartColour[0],arrow:wr,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,hasSnapshotData:nr}):c.push({subChartType:t.charts[u].subChartType,channelName:l[t.channelName],type:t.charts[u].chartType,values:t.charts[u].chartData,key:"fbTopReferringDomain"===t.charts[u].chartSubType?void 0:t.charts[u].metricDetails.name,unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[0]:"",color:t.charts[u].chartColour[0],arrow:wr,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,chartSubType:t.charts[u].chartSubType,hasSnapshotData:nr});else if("area"==g||"Reach Vs Impressions"==g||"EngagedUsersReach"==g||"negativeBar"==g)if("negativeBar"==g){var Pr=[];for(var Nr in t.charts[u].chartData)Pr.push({x:t.charts[u].chartData[Nr].x,y:-Math.abs(t.charts[u].chartData[Nr].y)});t.charts[u].chartType="area",c.push({channelName:l[t.channelName],type:"area",values:Pr,key:t.charts[u].metricDetails.name,unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[0]:"",color:t.charts[u].chartColour[0],arrow:wr,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,area:!0,hasSnapshotData:nr})}else c.push({channelName:l[t.channelName],type:t.charts[u].chartType,values:t.charts[u].chartData,key:t.charts[u].metricDetails.name,unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[0]:"",color:t.charts[u].chartColour[0],arrow:wr,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,hasSnapshotData:nr});else if("area"==g||"reachVsImpressions"==g||"engagedUsersReach"==g){var Rr=Math.round(100*or)/100;c.push({channelName:l[t.channelName],type:t.charts[u].chartType,values:t.charts[u].chartData,key:"Total Impressions"==t.charts[u].metricDetails.name?"Impressions/Reach (%)":t.charts[u].metricDetails.name,unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[0]:"",color:t.charts[u].chartColour[0],arrow:wr,variance:Q,period:ir,summaryDisplay:"Total Impressions"==t.charts[u].metricDetails.name||"Engaged users/Reach (%)"==t.charts[u].metricDetails.name?Rr+"%":Rr,area:!0,hasSnapshotData:nr})}else"bounceRateArea"==g?(t.charts[u].chartType="area",c.push({channelName:l[t.channelName],type:t.charts[u].chartType,values:t.charts[u].chartData,key:t.charts[u].metricDetails.name,unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[0]:"",color:t.charts[u].chartColour[0],arrow:wr,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,hasSnapshotData:nr})):"costPerClick"==g||"costPerThosuandImpressions"==g||"clickThroughRate"==g||"ConversionRate"==g||"costPerConversion"==g?(t.charts[u].chartType="area",c.push({channelName:l[t.channelName],type:t.charts[u].chartType,values:t.charts[u].chartData,key:t.charts[u].metricDetails.name,unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[0]:"",color:t.charts[u].chartColour[0],arrow:wr,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,hasSnapshotData:nr})):"costPerActionType"==g?c.push({channelName:l[t.channelName],type:"line",values:t.charts[u].chartData,key:t.meta.replace("_"," "),color:t.charts[u].chartColour[0],arrow:wr,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,hasSnapshotData:nr}):"trafficSourcesBrkdwnLine"==g?c.push({type:"line",channelName:l[t.channelName],values:t.charts[u].chartData,key:t.charts[u].metricDetails.name,unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[0]:"",color:t.charts[u].chartColour[0],arrow:wr,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,hasSnapshotData:nr}):"trafficSourcesBrkdwnPie"==g?c.push({channelName:l[t.channelName],name:t.charts[u].chartName,type:"pie",values:t.charts[u].chartData,key:t.charts[u].metricDetails.name,unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[0]:"",color:t.charts[u].chartColour[0],arrow:wr,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,hasSnapshotData:nr}):"percentageArea"==g?c.push({channelName:l[t.channelName],type:t.charts[u].chartType,metricCode:t.charts[u].metricCode,metricName:t.charts[u].metricName,key:t.charts[u].metricName,unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[0]:"",values:t.charts[u].chartData,color:t.charts[u].chartColour,arrow:wr,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,hasSnapshotData:nr}):c.push({channelName:l[t.channelName],name:t.charts[u].chartName,type:t.charts[u].chartType,y:parseFloat(or),key:t.charts[u].metricDetails.name,unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[0]:"",color:t.charts[u].chartColour[0],arrow:wr,period:ir,variance:Q,summaryDisplay:Math.round(100*or)/100,hasSnapshotData:nr})}else for(var sr in t.charts[u].chartData){var ir,or=0,lr=0,hr=t.charts[u].chartData[sr].length,pr=0,dr=0;if(t.charts[u].chartData[sr].length>=14){for(var H=0,f=hr-1;f>=0;f--)0===H||H<7?pr+=parseFloat(t.charts[u].chartData[sr][f].y):H>=7&&H<14&&(dr+=parseFloat(t.charts[u].chartData[sr][f].y)),H++;ir="WK"}else if(t.charts[u].chartData[sr].length>0){var Ar=t.charts[u].chartData[sr].length,vr=_.last(t.charts[u].chartData[sr]);if("string"!=typeof vr.x){var Dr=moment(vr.x).subtract(1,"days").format("YYYY-DD-MM");pr=parseFloat(vr.y)}else pr=parseFloat(t.charts[u].chartData[sr][Ar-1].y);for(var f=hr-1;f>=0;f--)if("string"!=typeof vr.x){var br=moment(t.charts[u].chartData[sr][f].x).format("YYYY-DD-MM");Dr===br&&(dr=parseFloat(t.charts[u].chartData[sr][f].y))}else dr=parseFloat(t.charts[u].chartData[sr][Ar-2].y);ir="Day"}var wr,Tr,Q;if(pr>dr)wr="up",Tr=pr-dr,Q=dr>0?parseFloat(Tr/dr*100).toFixed(2):pr;else if(pr<dr)wr="down",Tr=dr-pr,Q=dr>0?parseFloat(Tr/dr*100).toFixed(2):0;else var Tr=dr-pr,Q=0;for(var U in t.charts[u].chartData[sr])if(or+=parseFloat(t.charts[u].chartData[sr][U].y),parseFloat(0!=t.charts[u].chartData[sr][U].y)&&lr++,"undefined"!=typeof t.charts[u].metricDetails.objectTypes[0].meta.summaryType)if("avg"==t.charts[u].metricDetails.objectTypes[0].meta.summaryType)or=0==lr&&0==or?0:parseFloat(or/lr).toFixed(2);else if("snapshot"==t.charts[u].metricDetails.objectTypes[0].meta.summaryType){var kr="";_.findIndex(t.charts[u].chartData[sr].y,function(t){return 0!==t.date});for(var tt in t.charts[u].chartData[sr])kr<moment(t.charts[u].chartData[sr][tt].x)&&(kr=moment(t.charts[u].chartData[sr][tt].x),or=t.charts[u].chartData[sr][tt].y)}"line"==g||"bar"==g||"column"==g||"mozoverview"==g||"stackcolumn"==g?("bar"==g||"column"==g)&&h<0&&0==or?c.push({channelName:l[t.channelName],type:"line",values:t.charts[u].chartData[sr],key:t.charts[u].metricDetails.objectTypes[0].meta.endpoint,unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[0]:"",color:t.charts[u].chartColour[0],arrow:wr,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,hasSnapshotData:nr}):c.push({channelName:l[t.channelName],type:t.charts[u].chartType,values:t.charts[u].chartData[sr],key:"undefined"!=typeof t.charts[u].metricDetails.objectTypes[0].meta.endpointDisplayName&&"undefined"!=typeof t.charts[u].metricDetails.objectTypes[0].meta.endpointDisplayName[endpointDisplayCode]?t.charts[u].metricDetails.objectTypes[0].meta.endpointDisplayName[endpointDisplayCode]:t.charts[u].metricDetails.objectTypes[0].meta.endpoint[sr],unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[sr]:"",color:"undefined"!=typeof t.charts[u].chartColour&&"undefined"!=typeof t.charts[u].chartColour[sr]?t.charts[u].chartColour[sr]:"",arrow:wr,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,hasSnapshotData:nr}):"trafficSourcesBrkdwnLine"==g?c.push({channelName:l[t.channelName],type:"line",values:t.charts[u].chartData[sr],key:"undefined"!=typeof t.charts[u].metricDetails.objectTypes[0].meta.endpointDisplayName&&"undefined"!=typeof t.charts[u].metricDetails.objectTypes[0].meta.endpointDisplayName[endpointDisplayCode]?t.charts[u].metricDetails.objectTypes[0].meta.endpointDisplayName[endpointDisplayCode]:t.charts[u].metricDetails.objectTypes[0].meta.endpoint[sr],unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[sr]:"",color:"undefined"!=typeof t.charts[u].chartColour&&"undefined"!=typeof t.charts[u].chartColour[sr]?t.charts[u].chartColour[sr]:"",arrow:wr,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,hasSnapshotData:nr}):"trafficSourcesBrkdwnPie"==g?c.push({channelName:l[t.channelName],name:t.charts[u].chartName,type:"pie",y:parseFloat(or),key:"undefined"!=typeof t.charts[u].metricDetails.objectTypes[0].meta.endpointDisplayName&&"undefined"!=typeof t.charts[u].metricDetails.objectTypes[0].meta.endpointDisplayName[endpointDisplayCode]?t.charts[u].metricDetails.objectTypes[0].meta.endpointDisplayName[endpointDisplayCode]:t.charts[u].metricDetails.objectTypes[0].meta.endpoint[sr],unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[sr]:"",color:"undefined"!=typeof t.charts[u].chartColour&&"undefined"!=typeof t.charts[u].chartColour[sr]?t.charts[u].chartColour[sr]:"",arrow:wr,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,hasSnapshotData:nr}):"area"==g||"negativebar"==g?c.push({channelName:l[t.channelName],type:t.charts[u].chartType,values:t.charts[u].chartData[sr],key:"undefined"!=typeof t.charts[u].metricDetails.objectTypes[0].meta.endpointDisplayName&&"undefined"!=typeof t.charts[u].metricDetails.objectTypes[0].meta.endpointDisplayName[endpointDisplayCode]?t.charts[u].metricDetails.objectTypes[0].meta.endpointDisplayName[endpointDisplayCode]:t.charts[u].metricDetails.objectTypes[0].meta.endpoint[sr],unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[sr]:"",color:"undefined"!=typeof t.charts[u].chartColour&&"undefined"!=typeof t.charts[u].chartColour[sr]?t.charts[u].chartColour[sr]:"",arrow:wr,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,area:!0,hasSnapshotData:nr}):"costPerActionType"==g?c.push({channelName:l[t.channelName],type:"line",values:t.charts[u].chartData,key:t.meta,color:t.charts[u].chartColour[0],arrow:wr,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,hasSnapshotData:nr}):c.push({channelName:l[t.channelName],name:t.charts[u].chartName,type:t.charts[u].chartType,y:parseFloat(or),key:"undefined"!=typeof t.charts[u].metricDetails.objectTypes[0].meta.endpointDisplayName&&"undefined"!=typeof t.charts[u].metricDetails.objectTypes[0].meta.endpointDisplayName[endpointDisplayCode]?t.charts[u].metricDetails.objectTypes[0].meta.endpointDisplayName[endpointDisplayCode]:t.charts[u].metricDetails.objectTypes[0].meta.endpoint[sr].replace(/\_/g," "),unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[sr]:"",color:"undefined"!=typeof t.charts[u].chartColour&&"undefined"!=typeof t.charts[u].chartColour[sr]?t.charts[u].chartColour[sr]:"",arrow:wr,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,hasSnapshotData:nr})}}else if("tableAge"==pt||"tableGender"==pt||"tableDevice"==pt)c.push({type:"campaignOverViewbyAge",values:t.charts[u].chartData});else if("fbReachByCity"==g||"gaUsers"===g||"pieAge"==pt||"pieGender"==pt||"pieDevice"==pt){var Ir=0;for(var Wr in t.charts[u].chartData)c.push({channelName:l[t.channelName],name:t.charts[u].chartName,type:"fbReachByCity",y:parseFloat(t.charts[u].chartData[Wr]),key:Wr,unit:void 0!=t.charts[u].metricDetails.objectTypes[0].meta.unit?t.charts[u].metricDetails.objectTypes[0].meta.unit[0]:"",color:"undefined"!=typeof t.charts[u].chartColour&&"undefined"!=typeof t.charts[u].chartColour[Ir]?t.charts[u].chartColour[Ir]:"",summaryDisplay:Math.round(100*t.charts[u].chartData[Wr])/100,hasSnapshotData:nr}),++Ir}else if("costPerActionType"==g&&void 0==t.meta)c.push({type:"costPerActionType",values:t.charts[u].chartData});else switch(g){case"instagramPosts":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"stackbar":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"highEngagementTweets":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"highestEngagementLinkedIn":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"vimeoTopVideos":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"gaTopPagesByVisit":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"campaignOverview":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"adgroupOverview":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"fbAdsAdgroupOverview":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"adOverview":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"gaPageContentEfficiencyTable":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"gaPageTechnicalEfficiencyTable":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"gaVisitorAcquisitionEfficiencyAnalysisTable":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"audienceBehaviourbyDay":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData,color:t.charts[u].chartColour});break;case"socialContributionToSiteTraffic":c.push({type:t.charts[u].chartType,metricCode:t.charts[u].metricCode,metricName:t.charts[u].metricName,values:t.charts[u].chartData,color:t.charts[u].chartColour});break;case"pageTechnicalEfficiency":for(var Fr=0,Sr=0,f=0;f<t.charts[u].chartData.length;f++)Fr+=Number(t.charts[u].chartData[f].bounceRate),Sr+=Number(t.charts[u].chartData[f].PageLoadTime);var Or=[{key:"Page LoadTime",value:Sr,unit:"s"},{key:"Bounce Rate",value:Fr,unit:"%"}];c.push({channelName:l[t.channelName],type:t.charts[u].chartType,values:t.charts[u].chartData,summary:Or,key:t.charts[u].chartName,color:t.charts[u].chartColour});break;case"pageContentEfficiency":for(var Fr=0,zt=0,St=0,Pt=0,f=0;f<t.charts[u].chartData.length;f++)Fr+=Number(t.charts[u].chartData[f].bounceRate),zt+=Number(t.charts[u].chartData[f].entranceRate),St+=Number(t.charts[u].chartData[f].uniquePageviews),Pt+=Number(t.charts[u].chartData[f].pageviews);var Or=[{key:"Unique Page views",value:St},{key:"Page views",value:Pt,unit:""},{key:"Bounce Rate",value:Fr,unit:"%"},{key:"Entrance rate",value:zt,unit:"%"}];c.push({channelName:l[t.channelName],type:t.charts[u].chartType,values:t.charts[u].chartData,summary:Or,key:t.charts[u].chartName,color:t.charts[u].chartColour});break;case"visitorAcquisitionEfficiency":for(var $t=0,Vt=0,_t=0,f=0;f<t.charts[u].chartData.length;f++)_t+=Number(t.charts[u].chartData[f].goalConversionRateAll),Vt+=Number(t.charts[u].chartData[f].goalValuePerSession),$t+=Number(t.charts[u].chartData[f].newUsers);var Or=[{key:"New users",value:$t},{key:"Per session goal value",value:Vt,unit:""},{key:"Goal conversion rate",value:_t,unit:"%"}];c.push({channelName:l[t.channelName],type:t.charts[u].chartType,values:t.charts[u].chartData,summary:Or,key:t.charts[u].chartName,color:t.charts[u].chartColour});break;case"gaSocialMediaOverview":c.push({channelName:l[t.channelName],type:t.charts[u].chartType,values:t.charts[u].chartData,key:t.charts[u].chartName,color:t.charts[u].chartColour});break;case"topReferringSites":if("Top referring sites(Table)"==String(t.charts[u].chartName))c.push({type:"topReferringSitesTable",values:t.charts[u].chartData});else{for(var Zt=0,Qt=0,f=0;f<t.charts[u].chartData.length;f++)Zt+=Number(t.charts[u].chartData[f].goalConversionRate),v+=Number(t.charts[u].chartData[f].sessions),Qt+=Number(t.charts[u].chartData[f].goalCompletions);var Or=[{key:"Sessions",value:v},{key:"Goal Completions",value:Qt,unit:""},{key:"Goal conversion rate",value:Zt,unit:"%"}];c.push({channelName:l[t.channelName],type:t.charts[u].chartType,values:t.charts[u].chartData,summary:Or,key:t.charts[u].chartName,color:t.charts[u].chartColour})}break;case"fbReachByAge":c.push({type:"fbReachByAge",values:t.charts[u].chartData,channelName:l[t.channelName]});break;case"instagramEngagements":if("instagramPostTypes"===t.charts[u].chartSubType){var Ir=0;for(var Wr in t.charts[u].chartData)c.push({channelName:l[t.channelName],name:t.charts[u].chartName,type:"pie",key:Wr,displaySummary:!1,y:parseFloat(t.charts[u].chartData[Wr]),color:"undefined"!=typeof t.charts[u].chartColour&&"undefined"!=typeof t.charts[u].chartColour[Ir]?t.charts[u].chartColour[Ir]:""}),++Ir}else if("instagramPostEngagement"===t.charts[u].chartSubType){var Ir=0;for(var Wr in t.charts[u].chartData)c.push({channelName:l[t.channelName],name:t.charts[u].chartName,type:"fbReachByCity",y:parseFloat(t.charts[u].chartData[Wr]),key:Wr,displaySummary:!1,color:"undefined"!=typeof t.charts[u].chartColour&&"undefined"!=typeof t.charts[u].chartColour[Ir]?t.charts[u].chartColour[Ir]:"",summaryDisplay:Math.round(100*t.charts[u].chartData[Wr])/100,hasSnapshotData:nr}),++Ir}else if("instagramPostFrequency"===t.charts[u].chartSubType){var Er=new Date(a.startDate),zr=new Date(a.endDate),Lr=Math.abs(zr.getTime()-Er.getTime()),Mr=Math.ceil(Lr/864e5);c.push({channelName:l[t.channelName],key:"Post per day",type:"angularGauge",y:Math.round(t.charts[u].chartData/Mr*100)/100,displaySummary:!1,color:"undefined"!=typeof t.charts[u].chartColour&&"undefined"!=typeof t.charts[u].chartColour[Ir]?t.charts[u].chartColour[Ir]:"",summaryDisplay:Math.round(t.charts[u].chartData/Mr*100)/100,hasSnapshotData:nr})}break;case"fbReachByCountry":var Ir=0;for(var Wr in t.charts[u].chartData)c.push({channelName:l[t.channelName],name:t.charts[u].chartName,type:"pie",y:parseFloat(t.charts[u].chartData[Wr]),key:Wr,color:"undefined"!=typeof t.charts[u].chartColour&&"undefined"!=typeof t.charts[u].chartColour[Ir]?t.charts[u].chartColour[Ir]:"",summaryDisplay:Math.round(100*t.charts[u].chartData[Wr])/100,hasSnapshotData:nr}),++Ir;break;case"gaTopCountriesToSocialVisits":case"gaTopCitiesToSocialVisits":var Ir=0;for(var Wr in t.charts[u].chartData)c.push({channelName:l[t.channelName],name:t.charts[u].chartName,type:"pie",y:parseFloat(t.charts[u].chartData[Wr]),key:Wr,color:"undefined"!=typeof t.charts[u].chartColour&&"undefined"!=typeof t.charts[u].chartColour[Ir]?t.charts[u].chartColour[Ir]:"",summaryDisplay:parseFloat(t.charts[u].chartData[Wr]).toFixed(2)%Math.floor(t.charts[u].chartData[Wr])>0?parseFloat(t.charts[u].chartData[Wr]).toFixed(2):parseInt(t.charts[u].chartData[Wr]),hasSnapshotData:nr}),++Ir;break;case"pinterestEngagementRate":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"pinterestLeaderboard":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"instagramHashtagLeaderBoard":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"percentageArea":if("undefined"!=typeof t.charts[u].chartData[0].y){var jr=_.groupBy(t.charts[u].chartData,"y.socialNetwork"),Hr=0;for(var M in jr){var ir,or=0,cr=0,nr=!1,lr=0,hr=jr[M].length,pr=0,dr=0;if(t.charts[u].chartData.length>=14){for(var H=0,f=hr-1;f>=0;f--)(0===H||H<7)&&"undefined"!=typeof jr[M][f].y?pr+=parseFloat(jr[M][f].y.total):H>=7&&H<14&&"undefined"!=typeof jr[M][f].y&&(dr+=parseFloat(jr[M][f].y.total)),H++;ir="WK"}else if(t.charts[u].chartData.length>0){var Ar=jr[M].length,vr=_.last(jr[M]);if("string"!=typeof vr.x){
var Dr=moment(vr.x).subtract(1,"days").format("YYYY-DD-MM");pr=parseFloat(vr.y)}else pr=parseFloat(jr[M][Ar-1].y.total);for(var f=hr-1;f>=0;f--)if("string"!=typeof vr.x){var br=moment(jr[M][f].x).format("YYYY-DD-MM");Dr===br&&(dr=parseFloat(jr[M][f].y))}else dr=parseFloat(jr[M][Ar-2].y.total);ir="Day"}var wr,Tr,Q;if(pr>dr)wr="up",Tr=pr-dr,Q=dr>0?parseFloat(Tr/dr*100).toFixed(2):pr;else if(pr<dr)wr="down",Tr=dr-pr,Q=dr>0?parseFloat(Tr/dr*100).toFixed(2):0;else var Tr=dr-pr,Q=0;for(var U in jr[M])if("undefined"!=typeof jr[M][U].y&&(or+=parseFloat(jr[M][U].y.total)),"undefined"!=typeof jr[M][U].y&&parseFloat(0!=jr[M][U].y.total)&&lr++,"undefined"!=typeof t.charts[u].metricDetails.objectTypes[0].meta.summaryType)if("avg"==t.charts[u].metricDetails.objectTypes[0].meta.summaryType)or=0==lr&&0==or?0:parseFloat(or/lr).toFixed(2);else if("snapshot"==t.charts[u].metricDetails.objectTypes[0].meta.summaryType){var kr="";for(var tt in jr[sr])kr<moment(jr[M][tt].x)&&(kr=moment(jr[M][tt].x),or=jr[M][tt].y.total,0!=or&&(cr+=1));nr=cr>=1}c.push({channelName:l[t.channelName],type:t.charts[u].chartType,metricCode:t.charts[u].metricCode,metricName:t.charts[u].metricName,key:M,values:jr[M],color:"undefined"!=typeof t.charts[u].chartColour&&"undefined"!=typeof t.charts[u].chartColour[Hr]?t.charts[u].chartColour[Hr]:"",arrow:wr,totalChartLength:t.charts[u].chartData,variance:Q,period:ir,summaryDisplay:Math.round(100*or)/100,hasSnapshotData:nr}),Hr++}}break;case"youtubeVideosOverview":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"twitterEngagements":"engagementByUsersTalkedAbout"===t.charts[u].chartSubType||"topLinks"===t.charts[u].chartSubType||"hashTag"===t.charts[u].chartSubType?c.push({type:t.charts[u].chartType,chartSubType:t.charts[u].chartSubType,values:t.charts[u].chartData}):c.push({channelName:l[t.channelName],type:t.charts[u].chartType,chartSubType:t.charts[u].chartSubType,values:t.charts[u].chartData,key:t.charts[u].chartName,color:t.charts[u].chartColour});break;case"fbAdsCampaignOverview":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData});break;case"fbAdsAdOverview":c.push({type:t.charts[u].chartType,values:t.charts[u].chartData})}}}return n.resolve(c),n.promise}function p(t,a,r){function s(t,e){var a;for(var r in F){a=!1;for(var s in e)F[r]==e[s]&&(a=!0);if(0==a)return F[r]}}function i(t,e){return t+e}function i(t,e){return t+e}function i(t,e){return t+e}var o=e.defer(),n=[];n.twitterEngagements=[],n.youtubeVideosOverview=[],n.lineCharts=[],n.barCharts=[],n.pieCharts=[],n.percentageAreaOptions=[],n.instagramPosts=[],n.highEngagementTweets=[],n.highestEngagementLinkedIn=[],n.pinterestEngagementRate=[],n.pinterestLeaderboard=[],n.gaTopPagesByVisit=[],n.angularGauge=[],n.multicharts=[],n.campaignOverViewbyAge=[],n.campaignOverview=[],n.adOverview=[],n.adgroupOverview=[],n.fbAdsAdgroupOverview=[],n.fbReachByAge=[],n.mozoverview=[],n.fbReachByCity=[],n.vimeoTopVideos=[],n.costPerActionType=[],n.topReferringSites=[],n.instagramHashtagLeaderBoard=[],n.gaPageContentEfficiencyTable=[],n.gaPageTechnicalEfficiencyTable=[],n.gaVisitorAcquisitionEfficiencyAnalysisTable=[],n.pageTechnicalEfficiency=[],n.pageContentEfficiency=[],n.visitorAcquisitionEfficiency=[],n.percentageArea=[],n.topReferringSites=[],n.topReferringSitesTable=[],n.gaSocialMediaOverview=[],n.stackbar=[],n.fbAdsCampaignOverview=[],n.fbAdsAdOverview=[];var c,l,h,p,m,f={lineDataOptions:{chart:{type:"lineChart",noData:"No data for chosen date range",margin:{top:20,right:25,bottom:30,left:35},x:function(t){return t.x},y:function(t){return parseFloat(t.y)},useInteractiveGuideline:!0,xAxis:{tickFormat:function(t){return d3.time.format("%d/%m/%y")(new Date(t))},showMaxMin:!1},yAxis:{tickFormat:function(t){return d3.format("r")(t)},showMaxMin:!1},interpolate:"monotone",axisLabelDistance:-10,showLegend:!1,clipEdge:!1,legend:{rightAlign:!1,margin:{bottom:25}}}},barDataOptions:{chart:{type:"multiBarChart",noData:"No data for chosen date range",margin:{top:20,right:25,bottom:30,left:35},x:function(t){return t.x},y:function(t){return parseFloat(t.y)},useInteractiveGuideline:!0,xAxis:{tickFormat:function(t){return d3.time.format("%d/%m/%y")(new Date(t))},showMaxMin:!1},yAxis:{tickFormat:function(t){return d3.format("r")(t)},showMaxMin:!1},tooltip:{enabled:!1,headerEnabled:!0,headerFormatter:function(t){return d3.time.format("%d/%m/%y")(new Date(t))}},axisLabelDistance:-10,showLegend:!1,stacked:!0,showControls:!1,legend:{rightAlign:!1,margin:{bottom:25}}}},pieDataOptions:{chart:{type:"pieChart",noData:"No data for chosen date range",margin:{top:0,right:15,bottom:15,left:15},x:function(t){return t.key},y:function(t){return t.y},showLabels:!1,showLegend:!1,labelsOutside:!1,tooltips:!0,labelThreshold:.01,labelSunbeamLayout:!0,legend:{rightAlign:!1,margin:{bottom:25}}}},percentageAreaOptions:{chart:{type:"area",noData:"No data for chosen date range",margin:{top:20,right:25,bottom:30,left:35},x:function(t){return t.x},y:function(t){return parseFloat(t.y)},useInteractiveGuideline:!0,xAxis:{tickFormat:function(t){return d3.time.format("%d/%m/%y")(new Date(t))},showMaxMin:!1},yAxis:{tickFormat:function(t){return d3.format("r")(t)},showMaxMin:!1},interpolate:"monotone",axisLabelDistance:-10,showLegend:!1,clipEdge:!1,legend:{rightAlign:!1,margin:{bottom:25}}}},instagramPosts:{chart:{type:"instagramPosts"}},campaignOverview:{chart:{type:"campaignOverview"}},adOverview:{chart:{type:"adOverview"}},adgroupOverview:{chart:{type:"adgroupOverview"}},fbAdsAdgroupOverview:{chart:{type:"fbAdsAdgroupOverview"}},highEngagementTweets:{chart:{type:"highEngagementTweets"}},mozoverview:{chart:{type:"mozoverview"}},highestEngagementLinkedIn:{chart:{type:"highestEngagementLinkedIn"}},vimeoTopVideos:{chart:{type:"vimeoTopVideos"}},campaignOverViewbyAge:{chart:{type:"campaignOverViewbyAge"}},gaTopPagesByVisit:{chart:{type:"gaTopPagesByVisit"}},gaPageContentEfficiencyTable:{chart:{type:"gaPageContentEfficiencyTable"}},gaPageTechnicalEfficiencyTable:{chart:{type:"gaPageTechnicalEfficiencyTable"}},gaVisitorAcquisitionEfficiencyAnalysisTable:{chart:{type:"gaVisitorAcquisitionEfficiencyAnalysisTable"}},topReferringSitesTable:{chart:{type:"topReferringSitesTable"}},visitorAcquisitionEfficiency:{chart:{type:"visitorAcquisitionEfficiency",margin:{top:20,right:30,bottom:30,left:35}}},engagementByUsersTalkedAbout:{chart:{type:"engagementByUsersTalkedAbout"}},youtubeVideosOverview:{chart:{type:"youtubeVideosOverview"}},pinterestEngagementRate:{chart:{type:"pinterestEngagementRate"}},pinterestLeaderboard:{chart:{type:"pinterestLeaderboard"}},costPerActionType:{chart:{type:"costPerActionType"}},fbAdsCampaignOverview:{chart:{type:"fbAdsCampaignOverview"}},fbAdsAdOverview:{chart:{type:"fbAdsAdOverview"}},emptyCharts:{chart:{type:"emptyCharts"}},multiDataOptions:{chart:{type:"multiChart",noData:"No data for chosen date range",margin:{top:20,right:30,bottom:30,left:35},x:function(t){return t.x},y:function(t){return parseFloat(t.y)},useInteractiveGuideline:!0,xAxis:{tickFormat:function(t){return d3.time.format("%d/%m/%y")(new Date(t))},showMaxMin:!1},yAxis1:{tickFormat:function(t){return d3.format("r")(t)},showMaxMin:!1},yAxis2:{tickFormat:function(t){return d3.format("r")(t)},showMaxMin:!1},interpolate:"monotone",axisLabelDistance:-10,showLegend:!1,legend:{rightAlign:!1,margin:{bottom:25}}}},instagramHashtagLeaderBoard:{chart:{type:"instagramHashtagLeaderBoard"}}},y=0,v=[],D=[{W:1,H:1,N:0,r:1,c:1},{W:1,H:1,N:1,r:1,c:1},{W:1,H:1,N:2,r:2,c:1},{W:1,H:1,N:3,r:3,c:1},{W:1,H:1,N:4,r:4,c:1},{W:1,H:1,N:5,r:5,c:1},{W:1,H:1,N:6,r:6,c:1},{W:1,H:1,N:7,r:7,c:1},{W:1,H:1,N:8,r:8,c:1},{W:2,H:1,N:0,r:1,c:1},{W:2,H:1,N:1,r:1,c:1},{W:2,H:1,N:2,r:1,c:2},{W:2,H:1,N:3,r:2,c:1},{W:2,H:1,N:4,r:2,c:2},{W:2,H:1,N:5,r:2,c:3},{W:2,H:1,N:6,r:2,c:3},{W:2,H:1,N:7,r:3,c:3},{W:2,H:1,N:8,r:3,c:3},{W:3,H:1,N:0,r:1,c:1},{W:3,H:1,N:1,r:1,c:1},{W:3,H:1,N:2,r:1,c:2},{W:3,H:1,N:3,r:1,c:3},{W:3,H:1,N:4,r:2,c:2},{W:3,H:1,N:5,r:2,c:3},{W:3,H:1,N:6,r:2,c:3},{W:3,H:1,N:7,r:3,c:3},{W:3,H:1,N:8,r:3,c:3},{W:4,H:1,N:0,r:1,c:1},{W:4,H:1,N:1,r:1,c:1},{W:4,H:1,N:2,r:1,c:2},{W:4,H:1,N:3,r:1,c:3},{W:4,H:1,N:4,r:1,c:4},{W:4,H:1,N:5,r:2,c:3},{W:4,H:1,N:6,r:2,c:3},{W:4,H:1,N:7,r:3,c:3},{W:4,H:1,N:8,r:3,c:3},{W:5,H:1,N:0,r:1,c:1},{W:5,H:1,N:1,r:1,c:1},{W:5,H:1,N:2,r:1,c:2},{W:5,H:1,N:3,r:1,c:3},{W:5,H:1,N:4,r:1,c:4},{W:5,H:1,N:5,r:1,c:5},{W:5,H:1,N:6,r:2,c:3},{W:5,H:1,N:7,r:2,c:4},{W:5,H:1,N:8,r:2,c:4},{W:6,H:1,N:0,r:1,c:1},{W:6,H:1,N:1,r:1,c:1},{W:6,H:1,N:2,r:1,c:2},{W:6,H:1,N:3,r:1,c:3},{W:6,H:1,N:4,r:1,c:4},{W:6,H:1,N:5,r:1,c:5},{W:6,H:1,N:6,r:2,c:3},{W:6,H:1,N:7,r:2,c:4},{W:6,H:1,N:8,r:2,c:4},{W:1,H:2,N:0,r:1,c:1},{W:1,H:2,N:1,r:1,c:1},{W:1,H:2,N:2,r:2,c:1},{W:1,H:2,N:3,r:3,c:1},{W:1,H:2,N:4,r:4,c:1},{W:1,H:2,N:5,r:5,c:1},{W:1,H:2,N:6,r:6,c:1},{W:1,H:2,N:7,r:7,c:1},{W:1,H:2,N:8,r:8,c:1},{W:2,H:2,N:0,r:1,c:1},{W:2,H:2,N:1,r:1,c:1},{W:2,H:2,N:2,r:1,c:2},{W:2,H:2,N:3,r:2,c:2},{W:2,H:2,N:4,r:2,c:2},{W:2,H:2,N:5,r:3,c:2},{W:2,H:2,N:6,r:3,c:2},{W:2,H:2,N:7,r:4,c:2},{W:2,H:2,N:8,r:4,c:2},{W:3,H:2,N:0,r:1,c:1},{W:3,H:2,N:1,r:1,c:1},{W:3,H:2,N:2,r:1,c:2},{W:3,H:2,N:3,r:2,c:2},{W:3,H:2,N:4,r:2,c:2},{W:3,H:2,N:5,r:2,c:3},{W:3,H:2,N:6,r:2,c:3},{W:3,H:2,N:7,r:2,c:4},{W:3,H:2,N:8,r:2,c:4},{W:4,H:2,N:0,r:1,c:1},{W:4,H:2,N:1,r:1,c:1},{W:4,H:2,N:2,r:1,c:2},{W:4,H:2,N:3,r:1,c:3},{W:4,H:2,N:4,r:2,c:2},{W:4,H:2,N:5,r:2,c:3},{W:4,H:2,N:6,r:2,c:3},{W:4,H:2,N:7,r:2,c:4},{W:4,H:2,N:8,r:2,c:4},{W:5,H:2,N:0,r:1,c:1},{W:5,H:2,N:1,r:1,c:1},{W:5,H:2,N:2,r:1,c:2},{W:5,H:2,N:3,r:1,c:3},{W:5,H:2,N:4,r:2,c:2},{W:5,H:2,N:5,r:2,c:3},{W:5,H:2,N:6,r:2,c:3},{W:5,H:2,N:7,r:2,c:4},{W:5,H:2,N:8,r:2,c:4},{W:6,H:2,N:0,r:1,c:1},{W:6,H:2,N:1,r:1,c:1},{W:6,H:2,N:2,r:1,c:2},{W:6,H:2,N:3,r:1,c:3},{W:6,H:2,N:4,r:2,c:2},{W:6,H:2,N:5,r:2,c:3},{W:6,H:2,N:6,r:2,c:3},{W:6,H:2,N:7,r:2,c:4},{W:6,H:2,N:8,r:2,c:4},{W:1,H:3,N:0,r:1,c:1},{W:1,H:3,N:1,r:1,c:1},{W:1,H:3,N:2,r:2,c:1},{W:1,H:3,N:3,r:3,c:1},{W:1,H:3,N:4,r:4,c:1},{W:1,H:3,N:5,r:5,c:1},{W:1,H:3,N:6,r:6,c:1},{W:1,H:3,N:7,r:7,c:1},{W:1,H:3,N:8,r:8,c:1},{W:2,H:3,N:0,r:1,c:1},{W:2,H:3,N:1,r:1,c:1},{W:2,H:3,N:2,r:2,c:1},{W:2,H:3,N:3,r:3,c:1},{W:2,H:3,N:4,r:2,c:2},{W:2,H:3,N:5,r:3,c:2},{W:2,H:3,N:6,r:3,c:2},{W:2,H:3,N:7,r:4,c:2},{W:2,H:3,N:8,r:4,c:2},{W:3,H:3,N:0,r:1,c:1},{W:3,H:3,N:1,r:1,c:1},{W:3,H:3,N:2,r:1,c:2},{W:3,H:3,N:3,r:2,c:2},{W:3,H:3,N:4,r:2,c:2},{W:3,H:3,N:5,r:2,c:3},{W:3,H:3,N:6,r:2,c:3},{W:3,H:3,N:7,r:2,c:4},{W:3,H:3,N:8,r:2,c:4},{W:4,H:3,N:0,r:1,c:1},{W:4,H:3,N:1,r:1,c:1},{W:4,H:3,N:2,r:1,c:2},{W:4,H:3,N:3,r:1,c:3},{W:4,H:3,N:4,r:2,c:2},{W:4,H:3,N:5,r:2,c:3},{W:4,H:3,N:6,r:2,c:3},{W:4,H:3,N:7,r:2,c:4},{W:4,H:3,N:8,r:2,c:4},{W:5,H:3,N:0,r:1,c:1},{W:5,H:3,N:1,r:1,c:1},{W:5,H:3,N:2,r:1,c:2},{W:5,H:3,N:3,r:1,c:3},{W:5,H:3,N:4,r:2,c:2},{W:5,H:3,N:5,r:2,c:3},{W:5,H:3,N:6,r:2,c:3},{W:5,H:3,N:7,r:2,c:4},{W:5,H:3,N:8,r:2,c:4},{W:6,H:3,N:0,r:1,c:1},{W:6,H:3,N:1,r:1,c:1},{W:6,H:3,N:2,r:1,c:2},{W:6,H:3,N:3,r:1,c:3},{W:6,H:3,N:4,r:2,c:2},{W:6,H:3,N:5,r:2,c:3},{W:6,H:3,N:6,r:2,c:3},{W:6,H:3,N:7,r:2,c:4},{W:6,H:3,N:8,r:2,c:4}];if("customFusion"==t.widgetType)for(var b in a)if("costPerActionType"!=a[b].type||t.meta)switch(a[b].type){case"line":case"area":case"bar":case"column":case"reachVsImpressions":case"engagedUsersReach":n.lineCharts.push(a[b]);break;case"stackcolumn":n.barCharts.push(a[b]);break;case"pie":n.pieCharts.push(a[b]);break;case"instagramPosts":n.instagramPosts.push(a[b]);break;case"highEngagementTweets":n.highEngagementTweets.push(a[b]);break;case"highestEngagementLinkedIn":n.highestEngagementLinkedIn.push(a[b]);break;case"gaTopPagesByVisit":n.gaTopPagesByVisit.push(a[b]);break;case"campaignOverViewbyAge":n.campaignOverViewbyAge.push(a[b]);break;case"pageContentEfficiency":n.pageContentEfficiency.push(a[b]);break;case"pageTechnicalEfficiency":n.pageTechnicalEfficiency.push(a[b]);break;case"visitorAcquisitionEfficiency":n.visitorAcquisitionEfficiency.push(a[b]);break;case"gaPageContentEfficiencyTable":n.gaPageContentEfficiencyTable.push(a[b]);break;case"gaPageTechnicalEfficiencyTable":n.gaPageTechnicalEfficiencyTable.push(a[b]);break;case"topReferringSites":n.topReferringSites.push(a[b]);break;case"topReferringSitesTable":n.topReferringSitesTable.push(a[b]);break;case"gaSocialMediaOverview":n.gaSocialMediaOverview.push(a[b]);break;case"gaVisitorAcquisitionEfficiencyAnalysisTable":n.gaVisitorAcquisitionEfficiencyAnalysisTable.push(a[b]);break;case"fbReachByCity":n.fbReachByCity.push(a[b]);break;case"fbReachByAge":n.fbReachByAge.push(a[b]);break;case"pinterestEngagementRate":n.pinterestEngagementRate.push(a[b]);break;case"pinterestLeaderboard":n.pinterestLeaderboard.push(a[b]);break;case"audienceBehaviourbyDay":case"socialContributionToSiteTraffic":n.multicharts.push(a[b]);break;case"vimeoTopVideos":n.vimeoTopVideos.push(a[b]);break;case"campaignOverview":n.campaignOverview.push(a[b]);break;case"adgroupOverview":n.adgroupOverview.push(a[b]);break;case"fbAdsAdgroupOverview":n.fbAdsAdgroupOverview.push(a[b]);break;case"adOverview":n.adOverview.push(a[b]);break;case"percentageArea":n.percentageArea.push(a[b]);break;case"mozoverview":for(var w=0;w<a[b].values.length;w++)a[b].values[w].x=moment(a[b].values[w].x).format("YYYY-DD-MM");n.mozoverview.push(a[b]);break;case"angularGauge":n.angularGauge.push(a[b]);break;case"stackbar":n.stackbar.push(a[b]);break;case"instagramHashtagLeaderBoard":n.instagramHashtagLeaderBoard.push(a[b]);break;case"twitterEngagements":n.twitterEngagements.push(a[b]);break;case"youtubeVideosOverview":n.youtubeVideosOverview.push(a[b]);break;case"fbAdsCampaignOverview":n.fbAdsCampaignOverview.push(a[b]);break;case"fbAdsAdOverview":n.fbAdsAdOverview.push(a[b])}else n.costPerActionType.push(a[b]);else for(var b in a)if("line"==a[b].type||"area"==a[b].type||"reachVsImpressions"==a[b].type||"engagedUsersReach"==a[b].type||"costPerActionType"==a[b].type&&void 0!=t.meta)n.lineCharts.push(a[b]);else if("costPerActionType"!=a[b].type||t.meta)switch(a[b].type){case"bar":case"column":case"stackcolumn":n.barCharts.push(a[b]);break;case"pie":n.pieCharts.push(a[b]);break;case"instagramPosts":n.instagramPosts.push(a[b]);break;case"highEngagementTweets":n.highEngagementTweets.push(a[b]);break;case"highestEngagementLinkedIn":n.highestEngagementLinkedIn.push(a[b]);break;case"gaTopPagesByVisit":n.gaTopPagesByVisit.push(a[b]);break;case"campaignOverViewbyAge":n.campaignOverViewbyAge.push(a[b]);break;case"pageContentEfficiency":n.pageContentEfficiency.push(a[b]);break;case"pageTechnicalEfficiency":n.pageTechnicalEfficiency.push(a[b]);break;case"visitorAcquisitionEfficiency":n.visitorAcquisitionEfficiency.push(a[b]);break;case"gaPageContentEfficiencyTable":n.gaPageContentEfficiencyTable.push(a[b]);break;case"gaPageTechnicalEfficiencyTable":n.gaPageTechnicalEfficiencyTable.push(a[b]);break;case"topReferringSites":n.topReferringSites.push(a[b]);break;case"topReferringSitesTable":n.topReferringSitesTable.push(a[b]);break;case"gaSocialMediaOverview":n.gaSocialMediaOverview.push(a[b]);break;case"gaVisitorAcquisitionEfficiencyAnalysisTable":n.gaVisitorAcquisitionEfficiencyAnalysisTable.push(a[b]);break;case"fbReachByCity":n.fbReachByCity.push(a[b]);break;case"fbReachByAge":n.fbReachByAge.push(a[b]);break;case"pinterestEngagementRate":n.pinterestEngagementRate.push(a[b]);break;case"pinterestLeaderboard":n.pinterestLeaderboard.push(a[b]);break;case"audienceBehaviourbyDay":case"socialContributionToSiteTraffic":n.multicharts.push(a[b]);break;case"vimeoTopVideos":n.vimeoTopVideos.push(a[b]);break;case"campaignOverview":n.campaignOverview.push(a[b]);break;case"adgroupOverview":n.adgroupOverview.push(a[b]);break;case"fbAdsAdgroupOverview":n.fbAdsAdgroupOverview.push(a[b]);break;case"adOverview":n.adOverview.push(a[b]);break;case"percentageArea":n.percentageArea.push(a[b]);break;case"mozoverview":for(var w=0;w<a[b].values.length;w++)a[b].values[w].x=moment(a[b].values[w].x).format("YYYY-DD-MM");n.mozoverview.push(a[b]);break;case"angularGauge":n.angularGauge.push(a[b]);break;case"stackbar":n.stackbar.push(a[b]);break;case"instagramHashtagLeaderBoard":n.instagramHashtagLeaderBoard.push(a[b]);break;case"twitterEngagements":n.twitterEngagements.push(a[b]);break;case"youtubeVideosOverview":n.youtubeVideosOverview.push(a[b]);break;case"fbAdsCampaignOverview":n.fbAdsCampaignOverview.push(a[b]);break;case"fbAdsAdOverview":n.fbAdsAdOverview.push(a[b])}else n.costPerActionType.push(a[b]);var T=[],x={},C={},k={},F=["#EF5350","#EC407A","#9C27B0","#42A5F5","#26A69A","#FFCA28","#FF7043","#8D6E63"];if(1==n.lineCharts.length){for(var P=[],N=[],w=0;w<n.lineCharts.length;w++){for(var R=[],A=[],I=0;I<n.lineCharts[w].values.length;I++){R.push("string"==typeof n.lineCharts[w].values[I].x?n.lineCharts[w].values[I].x:n.lineCharts[w].values[I].x.format("DD-MMM-YYYY"));var W=String(n.lineCharts[w].values[I].y).indexOf(".")?parseFloat(n.lineCharts[w].values[I].y):parseInt(n.lineCharts[w].values[I].y);A.push(W)}N.push({name:"(none)"===n.lineCharts[w].key?"Direct":"fbTopReferringDomain"===n.lineCharts[0].chartSubType?"Top Referring Domain":n.lineCharts[w].key,data:A,tooltip:{valueSuffix:n.lineCharts[w].unit},color:n.lineCharts[w].color})}x={chart:{type:n.lineCharts[0].type,reflow:!0,zoomType:"x"},exporting:{enabled:!1},tooltip:{shared:!0},credits:{enabled:!1},xAxis:{type:"datetime",categories:R,labels:{formatter:function(){if("object"==typeof this.value||"number"==typeof this.value){var t=new Date(this.value);return u[t.getMonth()]+" "+t.getDate()}if("string"!=typeof this.value||d(this.value)){var t=this.value.split("-");return t[1]+" "+t[0]}return this.value}},tickInterval:"fbTopReferringDomain"===n.lineCharts[0].chartSubType?0:7,min:0},yAxis:[{title:{text:null}}],title:{text:"",style:{display:"none"}},series:N},P.push(x),y++,v.push({options:f.lineDataOptions,data:n.lineCharts,api:{},chartOptions:x});var S=0;for(var b in n.lineCharts)for(Y in n.lineCharts[b].values)S+=parseFloat(n.lineCharts[b].values[Y].y);0==S&&(v[v.length-1].options.chart.yDomain=[0,10])}if(n.lineCharts.length>1){var O,P=[],N=[];for(var b in n.lineCharts){var R=[],A=[];O=n.lineCharts[b].type;for(var E in T)if(n.lineCharts[b].color==T[E]){var z=s(n.lineCharts[b].color,T);n.lineCharts[b].color=z}for(var I=0;I<n.lineCharts[b].values.length;I++)if("object"!=typeof n.lineCharts[b].values[I].x){var L=d(n.lineCharts[b].values[I].x);if(L){R.push(n.lineCharts[b].values[I].x.format("DD-MMM-YYYY"));var W=String(n.lineCharts[b].values[I].y).indexOf(".")?parseFloat(n.lineCharts[b].values[I].y):parseInt(n.lineCharts[b].values[I].y);A.push(W)}else{R.push(n.lineCharts[b].values[I].x);var W=String(n.lineCharts[b].values[I].y).indexOf(".")?parseFloat(n.lineCharts[b].values[I].y):parseInt(n.lineCharts[b].values[I].y);A.push(W)}}else{R.push(n.lineCharts[b].values[I].x.format("DD-MMM-YYYY"));var W=String(n.lineCharts[b].values[I].y).indexOf(".")?parseFloat(n.lineCharts[b].values[I].y):parseInt(n.lineCharts[b].values[I].y);A.push(W)}if("string"==typeof n.lineCharts[b].values[0].x){var M=_.findIndex(g,function(t){return t==n.lineCharts[b].values[0].x});if(M==-1)var j="string";else var j="dayOfWeek"}else if("number"==typeof n.lineCharts[b].values[0].x)var j="number";else var j="date";"reachVsImpressions"==O||"engagedUsersReach"==O?N.push({name:n.lineCharts[b].key,yAxis:"string"==typeof b?parseInt(b):b,tooltip:{valueSuffix:"Impressions/Reach (%)"===n.lineCharts[b].key||"Engaged users/Reach (%)"===n.lineCharts[b].key?"%":n.lineCharts[b].unit},xAxisData:R,xAxisType:j,data:A,type:"area",color:n.lineCharts[b].color}):N.push({name:"(none)"===n.lineCharts[b].key?"Direct":"fbTopReferringDomain"===n.lineCharts[b].chartSubType?"Top Referring Domain":n.lineCharts[b].key,tooltip:{valueSuffix:n.lineCharts[b].unit},xAxisData:R,xAxisType:j,data:A,type:n.lineCharts[b].type,color:n.lineCharts[b].color}),T.push(n.lineCharts[b].color)}if("object"!=typeof n.lineCharts[b].values[0].x){var L=d(n.lineCharts[b].values[0].x);x=L?{chart:{reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{type:"datetime",categories:R,labels:{formatter:function(){if("object"==typeof this.value||"number"==typeof this.value){var t=new Date(this.value);return u[t.getMonth()]+" "+t.getDate()}var t=this.value.split("-");return t[1]+" "+t[0]}},tickInterval:7,min:0},title:{text:"",style:{display:"none"}},series:N}:{chart:{reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{categories:R},title:{text:"",style:{display:"none"}},series:N}}else x="reachVsImpressions"==O||"engagedUsersReach"==O?{chart:{reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{type:"datetime",categories:R,labels:{formatter:function(){if("object"==typeof this.value||"number"==typeof this.value){var t=new Date(this.value);return u[t.getMonth()]+" "+t.getDate()}var t=this.value.split("-");return t[1]+" "+t[0]}},tickInterval:7,min:0},yAxis:[{title:{text:"reachVsImpressions"==O?"Impressions/Reach (%)":"Engaged users/Reach (%)"}},{title:{text:"Total Reach"},opposite:!0}],title:{text:"",style:{display:"none"}},series:N}:{chart:{reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{type:"datetime",categories:R,labels:{formatter:function(){if("object"==typeof this.value||"number"==typeof this.value){var t=new Date(this.value);return u[t.getMonth()]+" "+t.getDate()}var t=this.value.split("-");return t[1]+" "+t[0]}},tickInterval:"fbTopReferringDomain"===n.lineCharts[0].chartSubType?0:7,min:0},title:{text:"",style:{display:"none"}},series:N};T=[];var H=[];for(var b in n.lineCharts){var B=0;for(var Y in n.lineCharts[b].values)B+=parseFloat(n.lineCharts[b].values[Y].y);H[b]={summaryTotal:B}}var $=0,V=0;for(E in H)$=parseInt(H[E].summaryTotal),0==$&&(V=1);var q=$/H.length;for(var b in n.lineCharts){var B=0;for(Y in n.lineCharts[b].values)B+=parseFloat(n.lineCharts[b].values[Y].y);B>q?n.lineCharts[b].yAxis=2:n.lineCharts[b].yAxis=1}var U=_.groupBy(N,"xAxisType");for(var G in U){y++;var X=[];if(U[G].length>1){for(var J=U[G][0].xAxisData,K=[],w=0;w<U[G].length;w++){var M=_.findIndex(n.lineCharts,function(t){return t.key==U[G][w].name&&void 0!=t.key});M!=-1&&K.push(n.lineCharts[M]),X.push({name:U[G][w].name,tooltip:U[G][w].tooltip,data:U[G][w].data,type:U[G][w].type,color:U[G][w].color})}if("object"!=typeof U[G][0].data[0]){var L=d(U[G][0].xAxisData[0]);x=L?{chart:{reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{type:"datetime",categories:J,labels:{formatter:function(){if("object"==typeof this.value||"number"==typeof this.value){var t=new Date(this.value);return u[t.getMonth()]+" "+t.getDate()}var t=this.value.split("-");return t[1]+" "+t[0]}},tickInterval:7,min:0},title:{text:"",style:{display:"none"}},series:X}:{chart:{reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{categories:J},title:{text:"",style:{display:"none"}},series:X}}else x="reachVsImpressions"==O||"engagedUsersReach"==O?{chart:{reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{type:"datetime",categories:J,labels:{formatter:function(){if("object"==typeof this.value||"number"==typeof this.value){var t=new Date(this.value);return u[t.getMonth()]+" "+t.getDate()}var t=this.value.split("-");return t[1]+" "+t[0]}},tickInterval:7,min:0},yAxis:[{title:{text:"reachVsImpressions"==O?"Impressions/Reach (%)":"Engaged users/Reach (%)"}},{title:{text:"Total Reach"},opposite:!0}],title:{text:"",style:{display:"none"}},series:X}:{chart:{reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{type:"datetime",categories:J,labels:{formatter:function(){if("object"==typeof this.value||"number"==typeof this.value){var t=new Date(this.value);return u[t.getMonth()]+" "+t.getDate()}var t=this.value.split("-");return t[1]+" "+t[0]}},tickInterval:7,min:0},title:{text:"",style:{display:"none"}},series:X};v.push({options:f.multiDataOptions,data:K,api:{},chartOptions:x})}else{var J=U[G][0].xAxisData,K=[],M=_.findIndex(n.lineCharts,function(t){return t.key==U[G][0].name&&void 0!=t.key});if(M!=-1&&K.push(n.lineCharts[M]),X.push({name:U[G][0].name,tooltip:U[G][0].tooltip,data:U[G][0].data,type:U[G][0].type,color:U[G][0].color}),"object"!=typeof U[G][0].data[0]){var L=d(U[G][0].xAxisData[0]);x=L?{chart:{reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{type:"datetime",categories:J,labels:{formatter:function(){if("object"==typeof this.value||"number"==typeof this.value){var t=new Date(this.value);return u[t.getMonth()]+" "+t.getDate()}var t=this.value.split("-");return t[1]+" "+t[0]}},tickInterval:7,min:0},title:{text:"",style:{display:"none"}},series:X}:{chart:{reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{categories:J},title:{text:"",style:{display:"none"}},series:X}}else x={chart:{reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{type:"datetime",categories:J,labels:{formatter:function(){if("object"==typeof this.value||"number"==typeof this.value){var t=new Date(this.value);return u[t.getMonth()]+" "+t.getDate()}var t=this.value.split("-");return t[1]+" "+t[0]}},tickInterval:7,min:0},title:{text:"",style:{display:"none"}},series:X};v.push({options:f.multiDataOptions,data:K,api:{},chartOptions:x})}}1==V&&(v[v.length-1].options.chart.yDomain1=[0,10])}if(n.barCharts.length>0){var P=[],N=[];y++;for(var b in n.barCharts){var R=[],A=[];for(var E in T)if(n.barCharts[b].color==T[E]){var z=s(n.barCharts[b].color,T);n.barCharts[b].color=z}for(var I=0;I<n.barCharts[b].values.length;I++){var Z;"string"==typeof n.barCharts[b].values[I].x?(Z="string",R.push(n.barCharts[b].values[I].x)):(Z="date",R.push(n.barCharts[b].values[I].x.format("DD-MMM-YYYY")));var W=String(n.barCharts[b].values[I].y).indexOf(".")?parseFloat(n.barCharts[b].values[I].y):parseInt(n.barCharts[b].values[I].y);A.push(W)}N.push({name:"(none)"===n.barCharts[b].key?"Direct":n.barCharts[b].key,data:A,tooltip:{valueSuffix:n.barCharts[b].unit},color:n.barCharts[b].color}),T.push(n.barCharts[b].color)}"string"===Z?x={chart:{type:n.barCharts[b].type,reflow:!0,zoomType:"x"},credits:{enabled:!1},legend:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{categories:R},tooltip:{formatter:function(){return this.x+":</br>"+this.y}},title:{text:"",style:{display:"none"}},yAxis:[{title:{text:null}}],series:N}:"stackcolumn"===n.barCharts[b].type?(n.barCharts[b].type="column",x={chart:{type:"column",reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{type:"datetime",categories:R,labels:{formatter:function(){if("object"==typeof this.value||"number"==typeof this.value){var t=new Date(this.value);return u[t.getMonth()]+" "+t.getDate()}var t=this.value.split("-");return t[1]+" "+t[0]}},tickInterval:7,min:0},plotOptions:{column:{stacking:"normal"}},title:{text:"",style:{display:"none"}},yAxis:[{title:{text:null}}],series:N}):x={chart:{type:n.barCharts[b].type,reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0,valueSuffix:"Session Duration"==n.barCharts[b].key?"sec":""},xAxis:{type:"datetime",categories:R,labels:{formatter:function(){if("object"==typeof this.value||"number"==typeof this.value){var t=new Date(this.value);return u[t.getMonth()]+" "+t.getDate()}var t=this.value.split("-");return t[1]+" "+t[0]}},tickInterval:7,min:0},title:{text:"",style:{display:"none"}},yAxis:[{title:{text:null}}],series:N},T=[];var H=[];for(var b in n.barCharts){var B=0;for(var Y in n.barCharts[b].values)B+=parseFloat(n.barCharts[b].values[Y].y);H[b]={summaryTotal:B}}var $=0;for(E in H)$+=parseInt(H[E].summaryTotal);v.push({options:f.pieDataOptions,data:n.barCharts,api:{},chartOptions:x}),0==$&&(v[v.length-1].options.chart.yDomain=[0,10])}if(n.stackbar.length>0){var P=[],N=[];y++;for(keys in n.stackbar[b].values[0].total[0]){var A=[],R=[];for(var b in n.stackbar)if(R.push(n.stackbar[b].values[0].date),"organic"==keys){var Q=-Math.abs(n.stackbar[b].values[0].total[0][keys]);A.push(Q)}else A.push(n.stackbar[b].values[0].total[0][keys]);N.push({name:"(none)"===keys?"Direct":keys,data:A})}x={chart:{type:"bar",reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:[{categories:R,reversed:!1,labels:{step:1}},{opposite:!0,reversed:!1,categories:R,linkedTo:0,labels:{step:1}}],title:{text:"",style:{display:"none"}},yAxis:[{title:{text:null},labels:{formatter:function(){return""}}}],plotOptions:{series:{stacking:"normal",pointPadding:0,groupPadding:0}},tooltip:{formatter:function(){return"<b>"+this.series.name+this.point.category+"</b><br/>visit: "+Highcharts.numberFormat(Math.abs(this.point.y),0)}},series:N},v.push({options:f.barDataOptions,data:n.stackbar,api:{},chartOptions:x})}if(n.multicharts.length>0){var P=[],R=[],N=[],tt=[];for(var b in n.multicharts){var et=b;if("socialContributionToSiteTraffic"===n.multicharts[et].type){for(var I=0;I<n.multicharts[et].values.length;I++)R.push(n.multicharts[et].values[I].x);for(var at=[],rt=0;rt<n.multicharts[et].values.length;rt++)at.push(String(n.multicharts[et].values[rt].y).indexOf(".")?parseFloat(n.multicharts[et].values[rt].y):parseInt(multicharts[et].values[rt].y));N.push({type:"sessions"==n.multicharts[et].metricCode?"column":"line",name:n.multicharts[et].metricName,data:at,yAxis:("sessions"==n.multicharts[et].metricCode,0),color:n.multicharts[et].color[et]});var st=at.reduce(i),it={summaryDisplay:Math.round(100*st)/100,key:void 0,showComparision:!1,variance:0,color:n.multicharts[et].color[et]};tt.push(it);var ot=[{title:{text:"Total sessions"}},{title:{text:"Sessions from social sources"},opposite:!0}],nt={type:"datetime",categories:R,labels:{formatter:function(){if("object"==typeof this.value||"number"==typeof this.value){var t=new Date(this.value);return u[t.getMonth()]+" "+t.getDate()}var t=this.value.split("-");return t[1]+" "+t[0]}},tickInterval:7,min:0}}else{for(var ot=[{title:{text:null}},{title:{text:null},opposite:!0}],nt={type:"datetime",categories:R},I=0;I<n.multicharts[b].values.length;I++)R.push(n.multicharts[b].values[I].date);var w=0;for(var G in n.multicharts[b].values[0].total){for(var ct=[],I=0;I<n.multicharts[b].values.length;I++){var Q=Math.round(100*n.multicharts[b].values[I].total[G])/100;ct.push(Q)}if("pageviews"==G){N.push({type:"column",name:"Page views",data:ct,yAxis:0,tooltip:{valueSuffix:""},color:n.multicharts[b].color[w]});var st=ct.reduce(i),it={summaryDisplay:Math.round(100*st)/100,key:void 0,showComparision:!1,variance:0,color:n.multicharts[b].color[w]};tt.push(it)}else if("total"!=G&&"sessions"!=G&&"hour"!=G&&"bounces"!=G){var lt,ht;"pageviewsPerSession"==G?(lt="Pages / Session",ht="pages"):"bounceRate"==G?(lt="Bounce rate",ht="%"):"percentNewSessions"==G&&(lt="% New sessions",ht="%"),N.push({type:"line",data:ct,name:lt,tooltip:{valueSuffix:ht},yAxis:1,color:n.multicharts[b].color[w]});var st=ct.reduce(i),it={summaryDisplay:Math.round(100*st)/100,key:void 0,showComparision:!1,variance:0,color:n.multicharts[b].color[w]};tt.push(it)}w++}}}x={chart:{zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:nt,title:{text:"",style:{display:"none"}},yAxis:ot,series:N},y++,v.push({options:f.multiDataOptions,data:tt,api:{},chartOptions:x}),0==$&&(v[v.length-1].options.chart.yDomain=[0,10])}if(n.percentageArea.length>0){y++;for(var P=[],R=[],N=[],tt=[],I=0;I<n.percentageArea[0].totalChartLength.length;I++)R.push(moment(n.percentageArea[0].totalChartLength[I].x).format("DD-MMM-YYYY"));var pt=0;for(var et in n.percentageArea){var dt=_.groupBy(n.percentageArea[et].values,"y.socialNetwork");for(var G in dt){for(var ut=[],I=0;I<n.percentageArea[et].totalChartLength.length;I++)ut.push({
y:0});for(var gt=0;gt<dt[G].length;gt++)for(var w=0;w<n.percentageArea[et].totalChartLength.length;w++){var mt=moment(dt[G][gt].x).format("YYYY-DD-MM")==moment(n.percentageArea[et].totalChartLength[w].x).format("YYYY-DD-MM");mt===!0&&"undefined"!=typeof dt[G][gt].y&&(ut[w].y=parseInt(dt[G][gt].y.total))}N.push({type:"area",color:n.percentageArea[et].color,name:G,data:ut}),pt++}var it={summaryDisplay:Math.round(100*st)/100,key:n.percentageArea[et].metricName,showComparision:!1,variance:0,color:n.percentageArea[et].color[et]};tt.push(it)}var nt={type:"datetime",categories:R,labels:{formatter:function(){if("object"==typeof this.value||"number"==typeof this.value){var t=new Date(this.value);return u[t.getMonth()]+" "+t.getDate()}var t=this.value.split("-");return t[1]+" "+t[0]}},tickInterval:7,min:0};x={chart:{zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:nt,title:{text:"",style:{display:"none"}},yAxis:{title:{text:"value"}},plotOptions:{area:{stacking:"normal",lineColor:"#ffffff",lineWidth:1,marker:{lineWidth:1,lineColor:"#ffffff"}}},series:N},v.push({options:f.percentageAreaOptions,data:n.percentageArea,api:{},chartOptions:x}),0==$&&(v[v.length-1].options.chart.yDomain=[0,10])}if(n.pieCharts.length>0){var P=[],N=[];y++;var R=[],A=[];for(var b in n.pieCharts){for(var E in T)if(n.pieCharts[b].color==T[E]){var z=s(n.pieCharts[b].color,T);n.pieCharts[b].color=z}T.push(n.pieCharts[b].color);var ft=String(n.pieCharts[b].y).indexOf(".")?parseFloat(n.pieCharts[b].y):parseInt(n.pieCharts[b].y),lt=n.pieCharts[b].key;A.push({y:ft,name:"(none)"===lt?"Direct":lt,color:n.pieCharts[b].color})}N.push({data:A,name:n.pieCharts[b].name}),x={chart:{type:n.pieCharts[0].type,reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},title:{text:"",style:{display:"none"}},yAxis:[{title:{text:null}}],tooltip:{formatter:function(){return this.key+":"+this.y+"</b>"}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer"}},series:N},T=[],v.push({options:f.pieDataOptions,data:n.pieCharts,api:{},chartOptions:x})}if(n.fbReachByCity.length>0){var P=[],N=[];y++;var R=[],A=[];for(var b in n.fbReachByCity){for(var E in T)if(n.fbReachByCity[b].color==T[E]){var z=s(n.fbReachByCity[b].color,T);n.fbReachByCity[b].color=z}T.push(n.fbReachByCity[b].color);var ft=String(n.fbReachByCity[b].y).indexOf(".")?parseFloat(n.fbReachByCity[b].y):parseInt(n.fbReachByCity[b].y),lt=n.fbReachByCity[b].key;A.push({y:ft,name:lt,color:n.fbReachByCity[b].color})}var lt=n.fbReachByCity[b].name;N.push({data:A,name:lt}),x={chart:{type:"pie",reflow:!0,zoomType:"x"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:35,dataLabels:{enabled:!0}}},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{formatter:function(){return this.key+":"+this.y+"</b>"}},title:{text:"",style:{display:"none"}},series:N},T=[],v.push({options:f.pieDataOptions,data:n.fbReachByCity,api:{},chartOptions:x})}if(n.fbReachByAge.length>0){var P=[],N=[];y++,x={chart:{type:"column",reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{categories:n.fbReachByAge[0].values[1]},yAxis:[{title:{text:null},min:0}],title:{text:"",style:{display:"none"}},plotOptions:{column:{stacking:"normal"}},series:n.fbReachByAge[0].values[2]},colorarray=["#b2aee8","#aee8b2","#e8b2ae","#98DF8A","#756BB1","#FFBB78","#0F9D58","#20bfaf","#bb24d1","#dcdf41"];for(var yt=[],st=0,w=0;w<n.fbReachByAge[0].values[1].length;w++){for(var et=0;et<n.fbReachByAge[0].values[2].length;et++)st+=n.fbReachByAge[0].values[2][et].data[w];var it={channelName:n.fbReachByAge[0].channelName,summaryDisplay:st,type:"pie",key:n.fbReachByAge[0].values[1][w],showComparision:"false",variance:0,color:colorarray[w]};yt.push(it)}T=[];var H=[];for(var b in yt){var B=0;B+=parseFloat(yt.summaryDisplay),H[b]={summaryTotal:B}}var $=0;for(E in H)$+=parseInt(H[E].summaryTotal);v.push({options:f.pieDataOptions,data:yt,api:{},chartOptions:x})}if(n.instagramPosts.length>0&&n.instagramPosts[0].values.length>0&&(y++,v.push({options:f.instagramPosts,data:n.instagramPosts[0].values})),n.vimeoTopVideos.length>0&&n.vimeoTopVideos[0].values.length>0&&(y++,v.push({options:f.vimeoTopVideos,data:n.vimeoTopVideos[0].values})),n.highEngagementTweets.length>0&&n.highEngagementTweets[0].values.length>0&&(y++,v.push({options:f.highEngagementTweets,data:n.highEngagementTweets[0].values})),n.highestEngagementLinkedIn.length>0&&n.highestEngagementLinkedIn[0].values.length>0&&(y++,v.push({options:f.highestEngagementLinkedIn,data:n.highestEngagementLinkedIn[0].values})),n.gaTopPagesByVisit.length>0&&n.gaTopPagesByVisit[0].values.length>0&&(y++,v.push({options:f.gaTopPagesByVisit,data:n.gaTopPagesByVisit[0].values})),n.campaignOverViewbyAge.length>0&&n.campaignOverViewbyAge[0].values.length>0&&(y++,v.push({options:f.campaignOverViewbyAge,data:n.campaignOverViewbyAge[0].values})),n.campaignOverview.length>0&&n.campaignOverview[0].values.length>0&&(y++,v.push({options:f.campaignOverview,data:n.campaignOverview[0].values})),n.adgroupOverview.length>0&&n.adgroupOverview[0].values.length>0&&(y++,v.push({options:f.adgroupOverview,data:n.adgroupOverview[0].values})),n.fbAdsAdgroupOverview.length>0&&n.fbAdsAdgroupOverview[0].values.length>0&&(y++,v.push({options:f.fbAdsAdgroupOverview,data:n.fbAdsAdgroupOverview[0].values})),n.adOverview.length>0&&n.adOverview[0].values.length>0&&(y++,v.push({options:f.adOverview,data:n.adOverview[0].values})),n.gaPageContentEfficiencyTable.length>0&&n.gaPageContentEfficiencyTable[0].values.length>0&&(y++,v.push({options:f.gaPageContentEfficiencyTable,data:n.gaPageContentEfficiencyTable[0].values})),n.topReferringSitesTable.length>0&&n.topReferringSitesTable[0].values.length>0&&(y++,v.push({options:f.topReferringSitesTable,data:n.topReferringSitesTable[0].values})),n.gaPageTechnicalEfficiencyTable.length>0&&n.gaPageTechnicalEfficiencyTable[0].values.length>0&&(y++,v.push({options:f.gaPageTechnicalEfficiencyTable,data:n.gaPageTechnicalEfficiencyTable[0].values})),n.gaVisitorAcquisitionEfficiencyAnalysisTable.length>0&&n.gaVisitorAcquisitionEfficiencyAnalysisTable[0].values.length>0&&(y++,v.push({options:f.gaVisitorAcquisitionEfficiencyAnalysisTable,data:n.gaVisitorAcquisitionEfficiencyAnalysisTable[0].values})),n.pageTechnicalEfficiency.length>0){var P=[],N=[];y++;for(var b in n.pageTechnicalEfficiency){var vt=[],A=[];A[0]=[],A[1]=[];for(var I=0;I<n.pageTechnicalEfficiency[b].values.length;I++)vt.push(String(n.pageTechnicalEfficiency[b].values[I].pageTitle)),A[0].push(Number(n.pageTechnicalEfficiency[b].values[I].PageLoadTime)),A[1].push(Number(n.pageTechnicalEfficiency[b].values[I].bounceRate));for(var w=0;w<n.pageTechnicalEfficiency[b].summary.length;w++)N.push({name:n.pageTechnicalEfficiency[b].summary[w].key,yAxis:w,tooltip:{valueSuffix:n.pageTechnicalEfficiency[b].summary[w].unit},data:A[w],type:0==w?"column":"line",color:n.pageTechnicalEfficiency[b].color[w]})}x={chart:{reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{categories:vt,labels:{formatter:function(){return this.value}},tickInterval:1,min:0,max:vt.length-1},yAxis:[{title:{text:"Page LoadTime"}},{title:{text:"Bounce Rate"},opposite:!0}],title:{text:"",style:{display:"none"}},series:N},v.push({options:f.visitorAcquisitionEfficiency,data:n.pageTechnicalEfficiency,api:{},chartOptions:x})}if(n.visitorAcquisitionEfficiency.length>0){var P=[],N=[];y++;for(var b in n.visitorAcquisitionEfficiency){var vt=[],A=[];A[0]=[],A[1]=[],A[2]=[];for(var I=0;I<n.visitorAcquisitionEfficiency[b].values.length;I++)vt.push(String(n.visitorAcquisitionEfficiency[b].values[I].sourceMedium)),A[0].push(Number(n.visitorAcquisitionEfficiency[b].values[I].newUsers)),A[1].push(Number(n.visitorAcquisitionEfficiency[b].values[I].goalValuePerSession)),A[2].push(Number(n.visitorAcquisitionEfficiency[b].values[I].goalConversionRateAll));for(var w=0;w<n.visitorAcquisitionEfficiency[b].summary.length;w++)N.push({name:n.visitorAcquisitionEfficiency[b].summary[w].key,yAxis:w<1?0:1,tooltip:{valueSuffix:n.visitorAcquisitionEfficiency[b].summary[w].unit},data:A[w],type:w<1?"column":"line",color:n.visitorAcquisitionEfficiency[b].color[w]})}x={chart:{reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{categories:vt,labels:{formatter:function(){return this.value}},tickInterval:1,min:0,max:vt.length-1},yAxis:[{title:{text:"New users"}},{title:{text:"Goal value & Goal conversion rate"},opposite:!0}],title:{text:"",style:{display:"none"}},series:N},v.push({options:f.visitorAcquisitionEfficiency,data:n.visitorAcquisitionEfficiency,api:{},chartOptions:x})}if(n.gaSocialMediaOverview.length>0){var P=[],N=[];y++;for(var b in n.gaSocialMediaOverview)for(var I=0;I<n.gaSocialMediaOverview[b].values.length;I++)N.push({x:Number(n.gaSocialMediaOverview[b].values[I].pageviewsPersession),y:Number(n.gaSocialMediaOverview[b].values[I].sessions),z:Number(n.gaSocialMediaOverview[b].values[I].avgtimeOnPage),name:"(none)"===String(n.gaSocialMediaOverview[b].values[I].socialNetwork)?"Direct":String(n.gaSocialMediaOverview[b].values[I].socialNetwork)});x={chart:{reflow:!0,type:"bubble",zoomType:"xy"},legend:{enabled:!1},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{useHTML:!0,headerFormat:"<table>",pointFormat:'<tr><th colspan="2"><h3>{point.name}</h3></th></tr><tr><th>Page Views Per Session:</th><td>{point.x}pages</td></tr><tr><th>Sessions:</th><td>{point.y}</td></tr><tr><th>Time on Page:</th><td>{point.z}s</td></tr>',footerFormat:"</table>",enabled:!0,shared:!0},xAxis:{labels:{formatter:function(){return this.value}},title:{text:"Page Views Per Session"}},yAxis:{title:{text:"Sessions"}},title:{text:"",style:{display:"none"}},plotOptions:{series:{dataLabels:{enabled:!0,format:"{point.name}"}}},series:[{data:N}]},v.push({options:f.visitorAcquisitionEfficiency,data:n.gaSocialMediaOverview,api:{},chartOptions:x})}if(n.topReferringSites.length>0){var P=[],N=[];y++;for(var b in n.topReferringSites){var vt=[],A=[];A[0]=[],A[1]=[],A[2]=[];for(var I=0;I<n.topReferringSites[b].values.length;I++)vt.push(String(n.topReferringSites[b].values[I].source)),A[0].push(Number(n.topReferringSites[b].values[I].sessions)),A[1].push(Number(n.topReferringSites[b].values[I].goalCompletions)),A[2].push(Number(n.topReferringSites[b].values[I].goalConversionRate));for(var w=0;w<n.topReferringSites[b].summary.length;w++)N.push({name:n.topReferringSites[b].summary[w].key,yAxis:w<=1?0:1,tooltip:{valueSuffix:n.topReferringSites[b].summary[w].unit},data:A[w],type:w<1?"column":"line",color:n.topReferringSites[b].color[w]})}x={chart:{reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{categories:vt,labels:{formatter:function(){return this.value}},tickInterval:1,min:0,max:vt.length-1},yAxis:[{title:{text:"Sessions & Goal completions"}},{title:{text:"Goal conversion rate"},opposite:!0}],title:{text:"",style:{display:"none"}},series:N},v.push({options:f.visitorAcquisitionEfficiency,data:n.topReferringSites,api:{},chartOptions:x})}if(n.pageContentEfficiency.length>0){var N=[];y++;for(var b in n.pageContentEfficiency){var vt=[],A=[];A[0]=[],A[1]=[],A[2]=[],A[3]=[];for(var I=0;I<n.pageContentEfficiency[b].values.length;I++)vt.push(String(n.pageContentEfficiency[b].values[I].pageTitle)),A[0].push(Number(n.pageContentEfficiency[b].values[I].uniquePageviews)),A[1].push(Number(n.pageContentEfficiency[b].values[I].pageviews)),A[2].push(Number(n.pageContentEfficiency[b].values[I].bounceRate)),A[3].push(Number(n.pageContentEfficiency[b].values[I].entranceRate));for(var w=0;w<n.pageContentEfficiency[b].summary.length;w++)N.push({name:n.pageContentEfficiency[b].summary[w].key,yAxis:w<2?0:1,tooltip:{valueSuffix:n.pageContentEfficiency[b].summary[w].unit},data:A[w],type:w<2?"column":"line",color:n.pageContentEfficiency[b].color[w]})}x={chart:{reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{categories:vt,labels:{formatter:function(){return this.value}},tickInterval:1,min:0,max:vt.length-1},yAxis:[{title:{text:"Unique Page views & Page views"}},{title:{text:"Entrance Rate & Bounce Rate"},opposite:!0}],title:{text:"",style:{display:"none"}},series:N},v.push({options:f.visitorAcquisitionEfficiency,data:n.pageContentEfficiency,api:{},chartOptions:x})}if(n.pinterestEngagementRate.length>0&&n.pinterestEngagementRate[0].values.length>0&&(y++,v.push({options:f.pinterestEngagementRate,data:n.pinterestEngagementRate[0].values})),n.pinterestLeaderboard.length>0&&n.pinterestLeaderboard[0].values.length>0&&(y++,v.push({options:f.pinterestLeaderboard,data:n.pinterestLeaderboard[0].values})),n.costPerActionType.length>0&&v.push({options:f.costPerActionType,data:n.costPerActionType}),n.mozoverview.length>0){for(var at=[],w=0;w<n.mozoverview.length;w++){var Dt=n.mozoverview[w].values.length-1;switch(n.mozoverview[w].key){case"Links":var bt=parseInt(n.mozoverview[w].values[Dt].y);break;case"External equity links":var wt=parseInt(n.mozoverview[w].values[Dt].y);break;case"Domain Authority (/100)":var Tt=n.mozoverview[w].values[Dt].y;break;case"Page Authority (/100)":var xt=n.mozoverview[w].values[Dt].y;break;case"Moz Rank (/10)":var Ct=n.mozoverview[w].values[Dt].y}}var kt={mozRankURL:Ct,externalEquityLinks:wt,domainageAuthority:Tt,links:bt,pageAuthority:xt};v.push({options:f.mozoverview,data:n.mozoverview,displayData:kt})}if(n.angularGauge.length>0&&(0!=n.angularGauge[0].y&&(y++,x={chart:{type:"gauge",plotBackgroundColor:null,plotBackgroundImage:null,plotBorderWidth:0,plotShadow:!1},credits:{enabled:!1},exporting:{enabled:!1},yAxis:{min:0,max:100,minorTickInterval:"auto",minorTickWidth:1,minorTickLength:10,minorTickPosition:"inside",minorTickColor:"#666",tickPixelInterval:30,tickWidth:2,tickPosition:"inside",tickLength:10,tickColor:"#666",title:{text:"Post/day"},plotBands:[{from:0,to:20,color:"#55BF3B"},{from:20,to:60,color:"#DDDF0D"},{from:60,to:100,color:"#DF5353"}]},title:{text:"",style:{display:"none"}},series:[{name:"Post Per Day",data:[n.angularGauge[0].y],tooltip:{valueSuffix:" post/day"}}]}),v.push({options:f.pieDataOptions,data:n.angularGauge,chartOptions:x})),n.instagramHashtagLeaderBoard.length>0&&n.instagramHashtagLeaderBoard[0].values.length>0&&(y++,v.push({options:f.instagramHashtagLeaderBoard,data:n.instagramHashtagLeaderBoard[0].values})),n.twitterEngagements.length>0){var Ft=[],Pt=[],Nt=0,Rt=0,At=[];for(var b in n.twitterEngagements)if("activityByDayOfTheWeek"==n.twitterEngagements[b].chartSubType||"instagramActivityByDayOfTheWeek"==n.twitterEngagements[b].chartSubType)Nt=1,Ft.push(n.twitterEngagements[b]);else if("activityByTimeOfTheDay"==n.twitterEngagements[b].chartSubType||"instagramActivityByTimeOfTheDay"==n.twitterEngagements[b].chartSubType){Rt=1;var N=[];Pt.push(n.twitterEngagements[b])}else if(n.twitterEngagements[b].values.length>0&&"commentsAndLikes"==n.twitterEngagements[b].chartSubType){y++;for(var N=[],It=[],Wt=[],I=0;I<n.twitterEngagements[b].values.length;I++)Wt.push(n.twitterEngagements[b].values[I].x);It=_.uniqBy(Wt);for(var I=0;I<n.twitterEngagements[b].values.length;I++){var St=_.indexOf(It,n.twitterEngagements[b].values[I].x);N.push({x:St,y:Number(n.twitterEngagements[b].values[I].y),z:Number(n.twitterEngagements[b].values[I].y),color:n.twitterEngagements[b].color[St],link:n.twitterEngagements[b].values[I].link,date:It[St]})}x={chart:{reflow:!0,type:"bubble",zoomType:"xy"},legend:{enabled:!1},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{useHTML:!0,headerFormat:"<table>",pointFormat:"<tr><th>Date:</th><td>{point.date}</td></tr><tr><th>Engagement:</th><td>{point.y}</td></tr><tr><th>Link:</th><td>{point.link}</td></tr>",footerFormat:"</table>",enabled:!0,shared:!0},xAxis:{labels:{},categories:It,title:{text:null},labels:{formatter:function(){if("object"==typeof this.value||"number"==typeof this.value){var t=new Date(this.value);return u[t.getMonth()]+" "+t.getDate()}if("string"!=typeof this.value||d(this.value)){var t=this.value.split("-");return t[1]+" "+t[0]}return this.value}},tickInterval:7,max:It.length-1},yAxis:{title:{text:"Engagements"}},title:{text:"",style:{display:"none"}},plotOptions:{series:{dataLabels:{enabled:!1}}},series:[{data:N}]},v.push({options:f.visitorAcquisitionEfficiency,data:n.twitterEngagements[b],api:{},chartOptions:x})}else if(n.twitterEngagements[b].values.length>0&&("topLinks"===n.twitterEngagements[b].chartSubType||"hashTag"===n.twitterEngagements[b].chartSubType)){y++;var Ot={chart:{type:n.twitterEngagements[b].chartSubType}};v.push({options:Ot,data:n.twitterEngagements[0].values})}else if(n.twitterEngagements[b].values.length>0&&("engagementByUsersTalkedAbout"===n.twitterEngagements[b].chartSubType||"hashTag"===n.twitterEngagements[b].chartSubType)){y++;var Ot={chart:{type:n.twitterEngagements[b].chartSubType}};v.push({options:Ot,data:n.twitterEngagements[b].values})}if(Rt>0){var N=[];y++;for(var b in Pt)for(var I=0;I<Pt[b].values.length;I++){if("Sunday"==String(Pt[b].values[I].day))var St=0;else if("Monday"==String(Pt[b].values[I].day))var St=1;else if("Tuesday"==String(Pt[b].values[I].day))var St=2;else if("Wednesday"==String(Pt[b].values[I].day))var St=3;else if("Thursday"==String(Pt[b].values[I].day))var St=4;else if("Friday"==String(Pt[b].values[I].day))var St=5;else if("Saturday"==String(Pt[b].values[I].day))var St=6;N.push({x:St,y:Number(Pt[b].values[I].time),z:Number(Pt[b].values[I].engagement),color:Pt[b].color[St]})}C={chart:{reflow:!0,type:"bubble",zoomType:"xy"},legend:{enabled:!1},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{useHTML:!0,headerFormat:"<table>",pointFormat:"<tr><th>Time:</th><td>{point.y}</td></tr><tr><th>Engagement:</th><td>{point.z}</td></tr>",footerFormat:"</table>",enabled:!0,shared:!0},xAxis:{labels:{},categories:g,title:{text:null},max:g.length-1},yAxis:{title:{text:"Time"},min:0,max:28,tickInterval:7},title:{text:"",style:{display:"none"}},plotOptions:{series:{dataLabels:{enabled:!1}}},series:[{data:N}]},v.push({options:f.visitorAcquisitionEfficiency,data:Pt,api:{},chartOptions:C})}if(Nt>0){var N=[],vt=[];At[0]=[],At[1]=[];var Et=[];y++;for(var Ot=0;Ot<Ft.length;Ot++){vt.length<Ft[Ot].values.length&&(vt.length=0);for(var I=0;I<Ft[Ot].values.length;I++)if(vt.length<Ft[Ot].values.length&&vt.push(String(Ft[Ot].values[I].day)),"activityByDayOfTheWeek"==Ft[Ot].chartSubType){var zt="Tweets count";At[0].push({tweet:Number(Ft[Ot].values[I].tweets)}),At[1].push({tweetEngage:Number(Ft[Ot].values[I].engagement)})}else{var zt="Posts count";At[0].push({instaTweet:Number(Ft[Ot].values[I].tweets)}),At[1].push({instaEngage:Number(Ft[Ot].values[I].engagement)})}}for(var w=0;w<At.length;w++)for(var G=0;G<At[w].length;G++)for(var Lt in At[w][G])Et.push(At[w][G]);for(var Mt=[],gt=0;gt<Et.length;gt++)Mt.push(Et[gt]);var jt=[],Ht=[],Bt=[],Yt=[];for(var gt in Mt)for(var Lt in Mt[gt])switch(Lt){case"tweet":jt.push(Mt[gt][Lt]);break;case"tweetEngage":Yt.push(Mt[gt][Lt]);break;case"instaTweet":Ht.push(Mt[gt][Lt]);break;case"instaEngage":Bt.push(Mt[gt][Lt]);break;default:console.log("err")}jt.length&&N.push({name:"Tweet",yAxis:0,tooltip:{valueSuffix:""},data:jt,type:"column",color:n.twitterEngagements[b].color[0]}),Ht.length&&N.push({name:"Post",yAxis:0,tooltip:{valueSuffix:""},data:Ht,type:"column",color:n.twitterEngagements[b].color[1]}),Bt.length&&N.push({name:"Engagement",yAxis:1,tooltip:{valueSuffix:""},data:Bt,type:"line",color:n.twitterEngagements[b].color[2]}),Yt.length&&N.push({name:"Engagement",yAxis:1,tooltip:{valueSuffix:""},data:Yt,type:"line",color:n.twitterEngagements[b].color[3]}),k={chart:{reflow:!0,zoomType:"x"},credits:{enabled:!1},exporting:{enabled:!1},tooltip:{enabled:!0,shared:!0},xAxis:{categories:vt,labels:{formatter:function(){return this.value}},tickInterval:1,min:0,max:vt.length-1},yAxis:[{title:{text:zt}},{title:{text:"Engagement count"},opposite:!0}],title:{text:"",style:{display:"none"}},series:N},v.push({options:f.visitorAcquisitionEfficiency,data:Ft,api:{},chartOptions:k})}}if(n.youtubeVideosOverview.length>0){y++;for(var b in n.youtubeVideosOverview){var Ot={chart:{type:n.youtubeVideosOverview[b].type}};n.youtubeVideosOverview[0].values.length>0&&v.push({options:Ot,data:n.youtubeVideosOverview[0].values})}}if(n.fbAdsCampaignOverview.length>0&&n.fbAdsCampaignOverview[0].values.length>0&&(y++,v.push({options:f.fbAdsCampaignOverview,data:n.fbAdsCampaignOverview[0].values})),n.fbAdsAdOverview.length>0&&n.fbAdsAdOverview[0].values.length>0&&(y++,v.push({options:f.fbAdsAdOverview,data:n.fbAdsAdOverview[0].values})),0==v.length)if("custom"==t.widgetType){var $t="";$t="localhost"==window.location.hostname?"http://localhost:8080/api/v1/create/customdata/"+t._id:window.location.hostname+"/api/v1/create/customdata/"+t._id,v.push({options:f.emptyCharts,data:[{message:"No data for chosen date range. Please send your data to: "+$t}]})}else v.push({options:f.emptyCharts,data:[{message:"No data for chosen date range"}]});var _t=function(){c="undefined"!=typeof t.size?t.size.h:3,l="undefined"!=typeof t.size?t.size.w:3;for(var e=0;e<D.length;e++)D[e].W==l&&D[e].H==c&&D[e].N==y&&(h=D[e].c,p=D[e].r)};if(_t(),m="custom"==t.widgetType?"Custom Data":"undefined"!=typeof t.name?t.name:"","undefined"!=typeof v[0].data[0]&&"undefined"!=v[0].data[0].displaySummary&&v[0].data[0].displaySummary===!1)var Vt={showSummary:!1,name:m,visibility:!0,id:t._id,color:t.color,chart:v,layoutOptionsX:h,layoutOptionsY:p};else if("undefined"!=typeof v[0].data[0]&&"undefined"!=typeof v[0].data[0].key)var Vt={name:m,visibility:!0,id:t._id,color:t.color,chart:v,layoutOptionsX:h,layoutOptionsY:p};else var Vt={showSummary:!1,name:m,visibility:!0,id:t._id,color:t.color,chart:v,layoutOptionsX:h,layoutOptionsY:p};return o.resolve(Vt),o.promise}function d(t){var e=new Date(t);return!isNaN(e.getDate())}var u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],g=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],m=e.defer(),f=e.defer(),y=JSON.parse(JSON.stringify(a));switch(a.widgetType){case"customFusion":var v=[],D=[],b=[];v.push(i(a,s)),e.all(v).then(function(t){var a=t[0];for(var i in a)"basic"==a[i].widgetType||"adv"==a[i].widgetType||"fusion"==a[i].widgetType?D.push(c(a[i],r,s)):"custom"==a[i].widgetType&&D.push(o(a[i],r));e.all(D).then(function(t){for(var a in t)"basic"==t[a].widgetType||"adv"==t[a].widgetType||"fusion"==t[a].widgetType?b.push(h(t[a])):"custom"==t[a].widgetType&&b.push(n(t[a]));e.all(b).then(function(t){var e=[];for(var a in t)for(var r in t[a])e.push(t[a][r]);var s=p(y,e);s.then(function(t){m.resolve(t)},function(t){m.reject(t)})},function(t){m.reject(t)})},function(t){m.reject(t)})},function(t){m.reject(t)});break;case"basic":case"adv":case"fusion":var w=c(y,r,s);w.then(function(t){var e=h(t,r);e.then(function(t){var e=p(a,t);e.then(function(t){m.resolve(t)},function(t){m.reject(t)})},function(t){m.reject(t)})},function(t){m.reject(t)});break;case"custom":var w=o(y,r);w.then(function(t){var e=n(t);e.then(function(t){var e=p(a,t,r);e.then(function(t){m.resolve(t)},function(t){m.reject(t)})},function(t){m.reject(t)})},function(t){m.reject(t)})}return m.promise}}]),showMetricApp.service("generateChartColours",function(){this.fetchRandomColors=function(t){for(var e,a=["#EF5350","#EC407A","#9C27B0","#42A5F5","#26A69A","#FFCA28","#FF7043","#8D6E63"],r=[];r.length<t;)e=a[Math.floor(Math.random()*(a.length-1))+1],r.indexOf(e)==-1?r.push(e):r.length>a.length&&r.indexOf(e,a.length-1)==-1&&r.push(e);return r},this.fetchWidgetColor=function(t){var e;switch(t){case"Facebook":e="#3B5998";break;case"Google Analytics":e="#F26630";break;case"Twitter":e="#5EA9DD";break;case"FacebookAds":e="#4E5664";break;case"GoogleAdwords":e="#1A925A";break;case"Instagram":e="#895A4D";break;case"YouTube":e="#CC181E";break;default:e="#04509B"}return e}}),showMetricApp.controller("MainCtrl",MainCtrl),showMetricApp.controller("CustomWidgetController",CustomWidgetController),showMetricApp.controller("customReportController",customReportController),showMetricApp.controller("NavigationController",NavigationController);